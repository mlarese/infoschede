<!--#INCLUDE FILE="Update__FileHeader.asp" -->
<% '........................................................................................... %>
<!--#INCLUDE FILE="../Tools.asp" -->
<!--#INCLUDE FILE="../Tools4Admin.asp" -->
<!--#INCLUDE FILE="../ToolsDescrittori.asp" -->
<!--#INCLUDE FILE="../Categorie/ClassCategorie.asp" -->
<!--#INCLUDE FILE="../IndexContent/Tools_IndexContent.asp" -->
<%
'...........................................................................................
set index.conn = conn
'...........................................................................................



'*******************************************************************************************
'AGGIORNAMENTO PER ALLINEARE insidevenice ( Nicola - 13/02/2014)
'...........................................................................................
if lCase(GetDatabaseName(conn)) = "insidevenice" then
	'installa memo2 su insidevenice
	sql = Install__MEMO2(conn)
	CALL DB.Execute(sql, 162)
	
	sql = AggiornamentoSpeciale__MEMO2__1(DB, rs, 163)
	CALL DB.Execute(sql, 163)
	
	sql = "SELECT * FROM  AA_versione"
	CALL DB.Execute(sql, 164)
	
	sql = Aggiornamento__MEMO2__1(conn)
	CALL DB.Execute(sql, 165)
	
	sql = Aggiornamento__MEMO2__2(conn)
	CALL DB.Execute(sql, 166)
	if DB.last_update_executed then
		CALL AggiornamentoSpeciale__MEMO2__2(conn)
	end if
	
	sql = Aggiornamento__MEMO2__3(conn)
	CALL DB.Execute(sql, 167)
	
	sql = Aggiornamento__MEMO2__4(conn)
	CALL DB.Execute(sql, 168)
	if DB.last_update_executed then
		CALL AggiornamentoSpeciale__MEMO2__4(conn)
	end if
	
	sql = Aggiornamento__MEMO2__5(conn)
	CALL DB.Execute(sql, 169)
	if DB.last_update_executed then
		CALL AggiornamentoSpeciale__MEMO2__5(conn)
	end if
	
	sql = Aggiornamento__MEMO2__6(conn)
	CALL DB.Execute(sql, 170)
	
	sql = Aggiornamento__MEMO2__7(conn)
	CALL DB.Execute(sql, 171)
	if DB.last_update_executed then
		CALL AggiornamentoSpeciale__MEMO2__7(conn)
	end if

	sql = Aggiornamento__MEMO2__8(conn)
	CALL DB.Execute(sql, 172)
	if DB.last_update_executed then
		CALL AggiornamentoSpeciale__MEMO2__8(conn)
	end if
	
	sql = Aggiornamento__MEMO2__9(conn)
	CALL DB.Execute(sql, 173)
	
	sql = Aggiornamento__MEMO2__10(conn)
	CALL DB.Execute(sql, 174)
	
	sql = Aggiornamento__MEMO2__11(conn)
	CALL DB.Execute(sql, 175)
	
	sql = Aggiornamento__MEMO2__12(conn)
	CALL DB.Execute(sql, 176)
	
	sql = "UPDATE AA_versione SET versione=456"
	CALL DB.Execute(sql, 177)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 1
'...........................................................................................
sql = Aggiornamento__B2B__1(conn)
CALL DB.Execute(sql, 1)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 2
'...........................................................................................
sql = Aggiornamento__B2B__2(conn)
CALL DB.Execute(sql, 2)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 3
'...........................................................................................
sql = Aggiornamento__B2B__3(conn)
CALL DB.Execute(sql, 3)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 4
'...........................................................................................
sql = Aggiornamento__B2B__4(conn)
CALL DB.Execute(sql, 4)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 5
'...........................................................................................
sql = Aggiornamento__B2B__5(conn)
CALL DB.Execute(sql, 5)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 6
'...........................................................................................
sql = Aggiornamento__B2B__6(conn)
CALL DB.Execute(sql, 6)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 7
'...........................................................................................
sql = Aggiornamento__B2B__7(conn)
CALL DB.Execute(sql, 7)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 8
'...........................................................................................
sql = Aggiornamento__B2B__8(conn)
CALL DB.Execute(sql, 8)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 9
'...........................................................................................
sql = Aggiornamento__B2B__9(conn)
CALL DB.Execute(sql, 9)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 10
'...........................................................................................
sql = Aggiornamento__B2B__10(conn)
CALL DB.Execute(sql, 10)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 11
'...........................................................................................
sql = Aggiornamento__B2B__11(conn)
CALL DB.Execute(sql, 11)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 12
'...........................................................................................
sql = Aggiornamento__B2B__12(conn)
CALL DB.Execute(sql, 12)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 13
'...........................................................................................
sql = Aggiornamento__B2B__13(conn)
CALL DB.Execute(sql, 13)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 14
'...........................................................................................
sql = Aggiornamento__B2B__14(conn)
CALL DB.Execute(sql, 14)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 15
'...........................................................................................
sql = Aggiornamento__B2B__15(conn)
CALL DB.Execute(sql, 15)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 16
'...........................................................................................
sql = Aggiornamento__B2B__16(conn)
CALL DB.Execute(sql, 16)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 17
'...........................................................................................
sql = Aggiornamento__B2B__17(conn)
CALL DB.Execute(sql, 17)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 18
'...........................................................................................
sql = Aggiornamento__B2B__18(conn)
CALL DB.Execute(sql, 18)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 19
'...........................................................................................
sql = Aggiornamento__B2B__19(conn)
CALL DB.Execute(sql, 19)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 20
'...........................................................................................
sql = Aggiornamento__B2B__20(conn)
CALL DB.Execute(sql, 20)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 21
'...........................................................................................
sql = Aggiornamento__B2B__21(conn)
CALL DB.Execute(sql, 21)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 22
'...........................................................................................
sql = Aggiornamento__B2B__22(conn)
CALL DB.Execute(sql, 22)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 23
'...........................................................................................
sql = Aggiornamento__B2B__23(conn)
CALL DB.Execute(sql, 23)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 24
'...........................................................................................
sql = Aggiornamento__B2B__24(conn)
CALL DB.Execute(sql, 24)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 25
'...........................................................................................
'aggiunggiornamento per variazione struttura directory frameworks
'...........................................................................................
sql = "UPDATE tb_siti SET sito_dir='NEXTpassport' WHERE id_sito=1 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTweb' WHERE id_sito=2 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTcom' WHERE id_sito=3 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTnews' WHERE id_sito=4 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTlink' WHERE id_sito=5 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTmenu' WHERE id_sito=6 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTflat' WHERE id_sito=7 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTmemo' WHERE id_sito=8 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTbanner' WHERE id_sito=9 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTclub' WHERE id_sito=10 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTbooking' WHERE id_sito=11 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTguestbook' WHERE id_sito=12 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTcontract' WHERE id_sito=13 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTfaq' WHERE id_sito=14 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTteam' WHERE id_sito=15 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTbookingportal' WHERE id_sito=16 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTflatportal' WHERE id_sito=17 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTrealestate' WHERE id_sito=18 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTb2b' WHERE id_sito=19 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTschool' WHERE id_sito=20 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTcongress' WHERE id_sito=21 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTb2b_import' WHERE id_sito=22 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTb2b_mailing' WHERE id_sito=23 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTtravel' WHERE id_sito=24 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='NEXTweb' WHERE id_sito=25 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../prodotti_PANIZZI' WHERE id_sito=100 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='APTadmin' WHERE id_sito=101 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../foto/admin' WHERE id_sito=102 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='APTaontrolloq' WHERE id_sito=103 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../APTbussola' WHERE id_sito=104 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../leo/admin' WHERE id_sito=105 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../prenotazioni' WHERE id_sito=106 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../venicecard/admin' WHERE id_sito=107 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../prenotazioniVENEZIASI' WHERE id_sito=108 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../widmann' WHERE id_sito=109 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../prenotazioni_TURIVE' WHERE id_sito=110 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../prenotazioni_UNI' WHERE id_sito=111 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../mag_centrale' WHERE id_sito=112 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../mag_omaggistica' WHERE id_sito=113 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../mag_spedizioni' WHERE id_sito=114 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../presenze' WHERE id_sito=115 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../APTdistribuzione' WHERE id_sito=116 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../bookings' WHERE id_sito=117 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../datiturismo' WHERE id_sito=118 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../agenzie' WHERE id_sito=119 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='timetable' WHERE id_sito=120 ;" + vbCrLf + _
	  "UPDATE tb_siti SET sito_dir='../EuropeAssistance' WHERE id_sito=121 ;"
CALL DB.Execute(sql, 25)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 26
'...........................................................................................
'corregge nome applicatiivi nextCom e nextDoc+
'...........................................................................................
sql = "UPDATE tb_siti SET sito_nome='" + IIF(Application("NextCrm"), "NEXT-doc+ [comunicazioni &amp; documenti]", "NEXT-com [gestione comunicazioni]") + "' WHERE id_sito=3; "
CALL DB.Execute(sql, 26)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 27
'...........................................................................................
'corregge nome applicativo next-web 4
'...........................................................................................
sql = "UPDATE tb_siti SET sito_nome='NEXT-web 4.0 [gestione grafica e contenuti]' WHERE id_sito=25"
CALL DB.Execute(sql, 27)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 28
'...........................................................................................
'aggiunge campi per descrittori: ordine, flag principale
'...........................................................................................
sql = " ALTER TABLE tb_descrittori ADD " + _
	  "		descr_ordine INT NULL, " + _
	  " 	descr_principale BIT NULL; " + _
	  " UPDATE tb_descrittori SET descr_ordine = 0 "
CALL DB.Execute(sql, 28)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 29
'...........................................................................................
sql = Aggiornamento__B2B__25(conn)
CALL DB.Execute(sql, 29)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 30
'...........................................................................................
sql = Aggiornamento__B2B__26(conn)
CALL DB.Execute(sql, 30)
'*******************************************************************************************


'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 31
'...........................................................................................
if lCase(GetDatabaseName(conn)) = "insidevenice" then
	sql = "SELECT * FROM AA_versione"
else
	sql = Aggiornamento__B2B__27(DB.objConn, rs)
end if
CALL DB.Execute(sql, 31)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 32
'...........................................................................................
sql = Aggiornamento__B2B__28(conn)
CALL DB.Execute(sql, 32)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 33
'...........................................................................................
sql = Aggiornamento__B2B__29(conn)
CALL DB.Execute(sql, 33)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 34
'...........................................................................................
sql = Aggiornamento__B2B__30(conn)
CALL DB.Execute(sql, 34)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 35
'...........................................................................................
sql = Aggiornamento__B2B__31(conn)
CALL DB.Execute(sql, 35)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 36
'...........................................................................................
sql = Aggiornamento__B2B__32(conn)
CALL DB.Execute(sql, 36)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 37
'...........................................................................................
sql = Aggiornamento__B2B__33(conn)
CALL DB.Execute(sql, 37)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 38
'...........................................................................................
sql = Aggiornamento__B2B__34(conn)
CALL DB.Execute(sql, 38)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 39
'...........................................................................................
sql = Aggiornamento__B2B__35(conn)
CALL DB.Execute(sql, 39)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 40
'...........................................................................................
sql = Aggiornamento__B2B__36(conn)
CALL DB.Execute(sql, 40)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 41
'...........................................................................................
'news: aggiunge campo url esterno.
'...........................................................................................
sql = " ALTER TABLE tb_news ADD " + _
	  " 	news_url  nvarchar (250) NULL "
CALL DB.Execute(sql, 41)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 42
'...........................................................................................
sql = Aggiornamento__B2B__37(conn)
CALL DB.Execute(sql, 42)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 43
'...........................................................................................
sql = Aggiornamento__B2B__38(conn)
CALL DB.Execute(sql, 43)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 44
'...........................................................................................
sql = Aggiornamento__B2B__39(conn)
CALL DB.Execute(sql, 44)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 45
'...........................................................................................
'aggiorna percorso integrazione dati, aggiunge permesso per gestione ordini
'...........................................................................................
sql = " UPDATE tb_siti SET sito_dir='../nextB2B_Integration', " + _
	  " sito_nome='NEXT-b2b integration [Import, export ed integrazione dati]', " + _
	  " sito_p1='B2B_ADMIN_ARTICOLI', sito_p2='B2B_ADMIN_ORDINI' " + _
	  " WHERE id_sito=22 ; " + _
	  " INSERT INTO rel_Admin_sito (admin_id, sito_id, rel_as_permesso) " + _
	  " SELECT admin_id, sito_id, 2 FROM rel_Admin_sito WHERE sito_id=22 AND rel_as_permesso=1 "
CALL DB.Execute(sql, 45)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 46
'...........................................................................................
'corregge tipo parametri applicazione
'...........................................................................................
sql = " DELETE FROM tb_siti_parametri WHERE par_sito_id=22 AND " + _
	  " (par_key LIKE 'Script_Import_Articoli' OR par_key LIKE 'Script_test_connessione_import'); "
CALL DB.Execute(sql, 46)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 47
'...........................................................................................
'aggiunge campo per indicazione dettaglio processato
'...........................................................................................
sql = " ALTER TABLE gtb_dettagli_ord ADD " + _
	  "	det_export_processed nvarchar (250) NULL "
CALL DB.Execute(sql, 47)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 48
'...........................................................................................
'corregge tipo parametri applicazione
'...........................................................................................
sql = "  CREATE VIEW dbo.gv_articoli_fornitori_F000078 AS " + vbCrLF + _
	  " 	SELECT * FROM gv_articoli INNER JOIN gItb_Articoli " + vbCrLF + _
	  "			ON (gv_articoli.rel_external_id=gItb_articoli.Iart_id OR gv_articoli.art_external_id = gItb_articoli.Iart_id) " + vbCrLF + _
	  "			WHERE ((gv_articoli.rel_external_id=gItb_articoli.Iart_id AND gv_articoli.rel_id=gItb_articoli.Iart_b2b_id)  " + vbCrLF + _
	  "			       OR (gv_articoli.art_external_id = gItb_articoli.Iart_id AND  gv_articoli.art_id=gItb_articoli.Iart_b2b_id)) " + vbCrLF + _
	  "				  AND gItb_articoli.Iart_x_fornitore LIKE 'F000078' " + _
	  "				  AND IsNULL(gItb_articoli.Iart_x_cod_fornitore, '')<>'' "
CALL DB.Execute(sql, 48)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 49
'...........................................................................................
sql = Aggiornamento__B2B__40(conn)
CALL DB.Execute(sql, 49)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 50
'...........................................................................................
sql = Aggiornamento__B2B__41(conn)
CALL DB.Execute(sql, 50)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 51
'...........................................................................................
sql = Aggiornamento__B2B__42(conn)
CALL DB.Execute(sql, 51)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 52
'...........................................................................................
sql = Aggiornamento__B2B__43(conn)
CALL DB.Execute(sql, 52)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 53
'...........................................................................................
sql = Aggiornamento__B2B__44(conn)
CALL DB.Execute(sql, 53)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 54
'...........................................................................................
sql = Aggiornamento__B2B__45(conn)
CALL DB.Execute(sql, 54)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 55
'...........................................................................................
sql = Aggiornamento__B2B__46(conn)
CALL DB.Execute(sql, 55)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 56
'...........................................................................................
sql = Aggiornamento__B2B__47(conn)
CALL DB.Execute(sql, 56)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 57
'...........................................................................................
sql = Aggiornamento__B2B__48(conn)
CALL DB.Execute(sql, 57)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 58
'...........................................................................................
sql = Aggiornamento__B2B__49(conn)
CALL DB.Execute(sql, 58)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 59
'...........................................................................................
'aggiorna campi parametri applicativi
'...........................................................................................
sql = " ALTER TABLE tb_siti_parametri ALTER COLUMN " + _
	  "		par_key nvarchar(250) NULL; " + _
	  " ALTER TABLE tb_siti_parametri ALTER COLUMN " + _
	  "		par_value nvarchar(250) NULL "
CALL DB.Execute(sql, 59)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 60
'...........................................................................................
sql = Aggiornamento__B2B__50(conn)
CALL DB.Execute(sql, 60)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 61
'...........................................................................................
sql = Aggiornamento__B2B__51(conn)
CALL DB.Execute(sql, 61)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 62
'...........................................................................................
sql = Aggiornamento__B2B__52(conn)
CALL DB.Execute(sql, 62)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 63
'...........................................................................................
'imposta i dati di lotto minimo e lotto di riordino a 1
'...........................................................................................
sql = " UPDATE gItb_articoli SET Iart_scorta_minima=1, Iart_lotto_minimo=1, Iart_lotto_riordino=1; " + _
	  " UPDATE grel_art_valori SET rel_giacenza_min=1, rel_lotto_riordino=1, rel_qta_min_ord=1; " + _
	  " UPDATE gtb_articoli SET art_giacenza_min=1, art_lotto_riordino=1, art_qta_min_ord=1; "
CALL DB.Execute(sql, 63)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 64
'...........................................................................................
'modifica struttura directory prodotti
'...........................................................................................
sql = " UPDATE tb_news SET news_img = REPLACE(news_img, 'spicers_', 's_') WHERE news_img LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_Art_foto SET fo_thumb = REPLACE(fo_thumb, 'spicers_', 's_') WHERE fo_thumb LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_Art_foto SET fo_zoom = REPLACE(fo_zoom, 'spicers_', 's_') WHERE fo_zoom LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_tipologie SET tip_logo = REPLACE(tip_logo, 'spicers_', 's_') WHERE tip_logo LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_tipologie SET tip_foto = REPLACE(tip_foto, 'spicers_', 's_') WHERE tip_foto LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_tipologie_raggruppamenti SET rag_foto = REPLACE(rag_foto, 'spicers_', 's_') WHERE rag_foto LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_marche SET mar_logo = REPLACE(mar_logo, 'spicers_', 's_') WHERE mar_logo LIKE '%spicers_%' ; " + _
	  " UPDATE gtb_valori SET val_icona = REPLACE(val_icona, 'spicers_', 's_') WHERE val_icona LIKE '%spicers_%' ; "
CALL DB.Execute(sql, 64)
if DB.last_update_executed then
	'modifica i nomi delle directory
	set fso = Server.CreateObject("Scripting.FileSystemObject")
	path = Application("IMAGE_PATH") & "1\images\prodotti\thumbnails"
	set folder = fso.GetFolder(path)
	for each SubFolder in folder.SubFolders
		if instr(1, SubFolder.name, "spicers_", vbTextCompare)>0 then
			SubFolder.name = replace(SubFolder.name, "spicers_", "s_")
		end if
	next
	
	path = Application("IMAGE_PATH") & "1\images\prodotti\zoom"
		set folder = fso.GetFolder(path)
	for each SubFolder in folder.SubFolders
		if instr(1, SubFolder.name, "spicers_", vbTextCompare)>0 then
			SubFolder.name = replace(SubFolder.name, "spicers_", "s_")
		end if
	next
	set fso = nothing

end if
'*******************************************************************************************


'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 65
'...........................................................................................
sql = Aggiornamento__B2B__53(conn)
CALL DB.Execute(sql, 65)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 66
'...........................................................................................
sql = Aggiornamento__B2B__54(conn)
CALL DB.Execute(sql, 66)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 67
'...........................................................................................
sql = Aggiornamento__B2B__55(conn)
CALL DB.Execute(sql, 67)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 68
'...........................................................................................
sql = Aggiornamento__B2B__56(conn)
CALL DB.Execute(sql, 68)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 69
'...........................................................................................
sql = Aggiornamento__B2B__57(conn)
CALL DB.Execute(sql, 69)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 70
'...........................................................................................
sql = Aggiornamento__B2B__58(conn)
CALL DB.Execute(sql, 70)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 71
'...........................................................................................
sql = Aggiornamento__B2B__59(conn)
CALL DB.Execute(sql, 71)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 72
'...........................................................................................
sql = Aggiornamento__B2B__60(conn)
CALL DB.Execute(sql, 72)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 73
'...........................................................................................
sql = Aggiornamento__B2B__61(conn)
CALL DB.Execute(sql, 73)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 74
'...........................................................................................
'aggiunge tabelle aggiuntive per la gestione dei form
'...........................................................................................
sql = " CREATE TABLE dbo.andycott_tb_attivita ( " + _
	  " 	attivita_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	attivita_nome_it nvarchar (250) NULL, " + _
	  " 	attivita_nome_en nvarchar (250) NULL, " + _
	  " 	attivita_nome_de nvarchar (250) NULL, " + _
	  " 	attivita_nome_es nvarchar (250) NULL, " + _
	  " 	attivita_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_attivita_attivita_id " + _
	  "			PRIMARY KEY  CLUSTERED  (attivita_id) " + _
	  " ); " + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Agricoltura/ Allevamento');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Albergo/ Ristorante');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Architetto');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Assicurazione');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Avvocato');" + _
  	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Autosalone');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Autofficina');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Banca');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Commercialista/ Studio contabilit&agrave;;');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Commerciante');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Edilizia');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Educazione');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Formazione');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Immobiliare');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Industria');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Ingegnere');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Informatica');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Internet');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Professionista');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Medico');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Pubblica Amministrazione');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Studente');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Telecomunicazioni');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Trasporti');" + _
	  " INSERT INTO andycott_tb_attivita (attivita_nome_it) VALUES ('Altro');" + _
	  " CREATE TABLE dbo.andycott_tb_province ( " + _
	  " 	provincia_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	provincia_nome_it nvarchar (250) NULL, " + _
	  " 	provincia_nome_en nvarchar (250) NULL, " + _
	  " 	provincia_nome_de nvarchar (250) NULL, " + _
	  " 	provincia_nome_ed nvarchar (250) NULL, " + _
	  " 	provincia_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_province_provincia_id " + _
	  "			PRIMARY KEY  CLUSTERED  (provincia_id) " + _
	  " ); " + _
	  " CREATE TABLE dbo.andycott_tb_piani ( " + _
	  " 	piano_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	piano_nome_it nvarchar (250) NULL, " + _
	  " 	piano_nome_en nvarchar (250) NULL, " + _
	  " 	piano_nome_de nvarchar (250) NULL, " + _
	  " 	piano_nome_ed nvarchar (250) NULL, " + _
	  " 	piano_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_piani_piano_id " + _
	  "			PRIMARY KEY  CLUSTERED  (piano_id) " + _
	  " ); " + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('Seminterrato');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('Piano terra');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('1&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('2&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('3&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('4&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('5&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('6&ordm;; Piano');" + _
	  " INSERT INTO andycott_tb_piani (piano_nome_it) VALUES ('Oltre 6&ordm;; Piano');" + _
	  " CREATE TABLE dbo.andycott_tb_societa ( " + _
	  " 	societa_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	societa_nome_it nvarchar (250) NULL, " + _
	  " 	societa_nome_en nvarchar (250) NULL, " + _
	  " 	societa_nome_de nvarchar (250) NULL, " + _
	  " 	societa_nome_ed nvarchar (250) NULL, " + _
	  " 	societa_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_societa_societa_id " + _
	  "			PRIMARY KEY  CLUSTERED  (societa_id) " + _
	  " ); " + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Ditta individuale');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Societ&agrave;; in nome collettivo (snc)');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Societ&agrave;; in accomandita semplice (sas)');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Societ&agrave;; a responsabilit&agrave;; limitata');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Societ&agrave;; per Azioni (Spa)');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Societ&agrave;; consortile a responsabilit&agrave;; limitata (scrl)');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Ente pubblico o assimilati');" + _
	  " INSERT INTO andycott_tb_societa (societa_nome_it) VALUES ('Altro');" + _
	  " CREATE TABLE dbo.andycott_tb_dipendenti ( " + _
	  " 	dipendenti_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	dipendenti_nome_it nvarchar (250) NULL, " + _
	  " 	dipendenti_nome_en nvarchar (250) NULL, " + _
	  " 	dipendenti_nome_de nvarchar (250) NULL, " + _
	  " 	dipendenti_nome_ed nvarchar (250) NULL, " + _
	  " 	dipendenti_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_dipendenti_dipendenti_id " + _
	  "			PRIMARY KEY  CLUSTERED  (dipendenti_id) " + _
	  " ); " + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('da 1 fino a 10 dipendenti');" + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('da 11 fino a 25 dipendenti');" + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('da 26 fino a 50 dipendenti');" + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('da 51 fino a 100 dipendenti');" + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('da 101 fino a 250 dipendenti');" + _
	  " INSERT INTO andycott_tb_dipendenti (dipendenti_nome_it) VALUES ('Oltre 250 dipendenti');"
CALL DB.Execute(sql, 74)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 75
'...........................................................................................
'aggiunge dati a tabella provincie
'...........................................................................................
sql = " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Agrigento');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Alessandria');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Ancona');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Aosta');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Arezzo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Ascoli Piceno');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Asti');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Avellino');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Bari');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Belluno');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Benevento');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Bergamo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Biella');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Bologna');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Bolzano');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Brescia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Brindisi');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Cagliari');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Caltanisetta');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Campobasso');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Caserta');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Catania');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Catanzaro');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Chieti');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Como');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Cosenza');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Cremona');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Crotone');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Cuneo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Enna');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Ferrara');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Firenze');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Foggia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Forli');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Forlì');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Frosinone');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Genova');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Gorizia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Grosseto');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Imperia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Isernia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('La Spezia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('L''Aquila');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Latina');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Lecce');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Lecco');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Livorno');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Lodi');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Lucca');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Macerata');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Mantova');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Massa Carrara');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Matera');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Messina');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Milano');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Modena');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Napoli');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Novara');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Nuoro');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Oristano');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Padova');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Palermo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Parma');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pavia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Perugia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pesaro');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pesaro');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pescara');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Piacenza');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pisa');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pistoia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Pordenone');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Potenza');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Prato');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Ragusa');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Ravenna');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Reggio Calabria');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Reggio Emilia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Rieti');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Rimini');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Roma');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Rovigo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Salerno');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('San Marino');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Sassari');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Savona');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Siena');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Siracusa');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Sondrio');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Taranto');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Teramo');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Terni');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Torino');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Trapani');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Trento');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Treviso');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Trieste');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Udine');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Varese');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Venezia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Verbania');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Vercelli');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Verona');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Vibo Valentia');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Vicenza');" + _
	  " INSERT INTO andycott_tb_province (provincia_nome_it) VALUES('Viterbo');"
CALL DB.Execute(sql, 75)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 76
'...........................................................................................
'aggiunge dati a tabella provincie
'...........................................................................................
sql = " INSERT INTO tb_tipNumeri (id_tipoNumero, nome_tipoNumero) VALUES(8, 'Email ufficio commerciale');" + _
	  " INSERT INTO tb_tipNumeri (id_tipoNumero, nome_tipoNumero) VALUES(9, 'Email amministrazione');"
CALL DB.Execute(sql, 76)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 77
'...........................................................................................
'rigenera viste per aggiornamento delle strutture
'...........................................................................................
sql = "DROP VIEW dbo.gv_articoli_fornitori_F000078 ;" + vbCrLf + _
	  "CREATE VIEW dbo.gv_articoli_fornitori_F000078 AS " + vbCrLf + _
	  "	SELECT * FROM gv_articoli INNER JOIN gItb_Articoli " + vbCrLf + _
	  "		ON (gv_articoli.rel_external_id=gItb_articoli.Iart_id OR gv_articoli.art_external_id = gItb_articoli.Iart_id) " + vbCrLf + _
	  "		WHERE ((gv_articoli.rel_external_id=gItb_articoli.Iart_id AND gv_articoli.rel_id=gItb_articoli.Iart_b2b_id)  " + vbCrLf + _
	  "				OR (gv_articoli.art_external_id = gItb_articoli.Iart_id AND  gv_articoli.art_id=gItb_articoli.Iart_b2b_id)) " + vbCrLf + _
	  "			AND gItb_articoli.Iart_x_fornitore LIKE 'F000078'" + vbCrLf + _
	  "			AND IsNULL(gItb_articoli.Iart_x_cod_fornitore, '')<>'' " + vbCrLf + _
	  ";" + vbCrLf + _
	  Aggiornamento__B2B__62(conn)
CALL DB.Execute(sql, 77)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 78
'...........................................................................................
sql = Aggiornamento__B2B__63(conn)
CALL DB.Execute(sql, 78)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 79
'...........................................................................................
sql = Aggiornamento__B2B__64(conn)
CALL DB.Execute(sql, 79)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 80
'...........................................................................................
sql = Aggiornamento__B2B__65(conn)
CALL DB.Execute(sql, 80)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 81
'...........................................................................................
sql = Aggiornamento__B2B__66(conn)
CALL DB.Execute(sql, 81)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 82
'...........................................................................................
sql = Aggiornamento__B2B__67(conn)
CALL DB.Execute(sql, 82)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 83
'...........................................................................................
sql = Aggiornamento__B2B__68(conn)
CALL DB.Execute(sql, 83)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 84
'...........................................................................................
'controlla e ripulisce directory vecchie e residue
'...........................................................................................
sql = " SELECT * FROM AA_versione"
CALL DB.Execute(sql, 84)
if DB.last_update_executed then
	CALL Aggiornamento__FRAMEWORK_CORE__pulizia_directory(conn, rs)
end if
'...........................................................................................
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 85
'...........................................................................................
'aggiunge struttura link utili per uniformare core framework
'...........................................................................................
sql = " CREATE TABLE dbo.tb_links_categorie ( " + _
	  "		cat_id int IDENTITY (1, 1) NOT NULL , " + _
	  "		cat_nome_IT nvarchar (50) NULL , " + _
	  "		cat_nome_EN nvarchar (50) NULL , " + _
	  "		cat_nome_FR nvarchar (50) NULL , " + _
	  "		cat_nome_DE nvarchar (50) NULL , " + _
	  "		cat_nome_ES nvarchar (50) NULL , " + _
	  "		CONSTRAINT PK_tb_links_categorie PRIMARY KEY CLUSTERED (cat_id) " + _
	  "		); " + _
	  " CREATE TABLE dbo.tb_links ( " + _
	  "		link_id int IDENTITY (1, 1) NOT NULL , " + _
	  "		link_cat_id int NULL , " + _
	  "		link_nome_IT nvarchar (255) NULL , " + _
	  "		link_nome_EN nvarchar (255) NULL , " + _
	  "		link_nome_FR nvarchar (255) NULL , " + _
	  "		link_nome_DE nvarchar (255) NULL , " + _
	  "		link_nome_ES nvarchar (255) NULL , " + _
	  "		link_url nvarchar (250) NULL , " + _
	  "		link_logo nvarchar (50) NULL , " + _
	  "		link_data_reset smalldatetime NULL , " + _
	  "		link_count int NULL , " + _
	  "		link_descr_IT ntext NULL , " + _
	  "		link_descr_EN ntext NULL , " + _
	  "		link_descr_FR ntext NULL , " + _
	  "		link_descr_DE ntext NULL , " + _
	  "		link_descr_ES ntext NULL , " + _
	  "		link_ordine int NULL , " + _
	  "		CONSTRAINT PK_tb_links PRIMARY KEY CLUSTERED (link_id) , " + _
	  "		CONSTRAINT FK_tb_links_tb_links_categorie FOREIGN KEY (link_cat_id)  " + _
	  "		REFERENCES tb_links_categorie (cat_id) ON DELETE CASCADE  ON UPDATE CASCADE  " + _
	  "		); "
CALL DB.Execute(sql, 85)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 86
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__1(conn)
CALL DB.Execute(sql, 86)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 87
'...........................................................................................
'aggiunte tabella per tecnologie consumabili
'...........................................................................................
sql = " CREATE TABLE dbo.andycott_tb_tecnologie ( " + _
	  " 	tecno_id int IDENTITY (1, 1) NOT NULL , " + _
	  " 	tecno_nome_it nvarchar (250) NULL, " + _
	  " 	tecno_nome_en nvarchar (250) NULL, " + _
	  " 	tecno_nome_de nvarchar (250) NULL, " + _
	  " 	tecno_nome_ed nvarchar (250) NULL, " + _
	  " 	tecno_nome_fr nvarchar (250) NULL, " + _
	  "		CONSTRAINT PK_andycott_tb_tecnologie_tecno_id " + _
	  "			PRIMARY KEY  CLUSTERED  (tecno_id) " + _
	  " ); " + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('macchina scrivere');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('calcolatrice');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('fotocopiatore');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('laser');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('inkjet');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('TTR fax (film)');" + _
	  " INSERT INTO andycott_tb_tecnologie (tecno_nome_it) VALUES ('altro')"
CALL DB.Execute(sql, 87)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 88
'...........................................................................................
sql = Aggiornamento__B2B__69(conn) + _
	  " INSERT INTO glog_ordini_operazioni (op_descrizione) VALUES('Conferma ed export ordine')"
CALL DB.Execute(sql, 88)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 89
'...........................................................................................
sql = Aggiornamento__B2B__70(conn)
CALL DB.Execute(sql, 89)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 90
'...........................................................................................
'correzione tipo di dati delle destinazioni
'...........................................................................................
sql = "UPDATE tb_indirizzario SET SyncroTable='CfDest' WHERE SyncroTable LIKE 'ARCA'"
CALL DB.Execute(sql, 90)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 91
'...........................................................................................
sql = Aggiornamento__B2B__71(conn)
CALL DB.Execute(sql, 91)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 92
'...........................................................................................
sql = Aggiornamento__B2B__72(conn)
CALL DB.Execute(sql, 92)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 93
'...........................................................................................
'rimozione vista non piu' utilizzata
'...........................................................................................
sql = "DROP VIEW gv_articoli_fornitori_F000078"
CALL DB.Execute(sql, 93)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 94
'...........................................................................................
sql = Aggiornamento__B2B__73(conn)
CALL DB.Execute(sql, 94)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 95
'...........................................................................................
'aggiunge stored procedure per elenco offerte in home page
'...........................................................................................
sql = "CREATE PROCEDURE dbo.sp_andycott_elenco_offerte_home " + vbCrLF + _
	  " AS " + vbCrLF + _
	  " 	SELECT TOP 10 art_id, MAX(art_nome_it) AS art_nome, MIN(prz_prezzo) AS prezzo_offerta " + vbCrLF + _
	  " 	FROM gtb_articoli  " + vbCrLF + _
	  " 		INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLF + _
	  " 		INNER JOIN gtb_prezzi ON grel_art_valori.rel_id = gtb_prezzi.prz_variante_id " + vbCrLF + _
	  " 		INNER JOIN gtb_listini ON gtb_prezzi.prz_listino_id = gtb_listini.listino_id " + vbCrLF + _
	  " 		INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id " + vbCrLF + _
	  " 	WHERE ISNULL(gtb_articoli.art_disabilitato, 0) = 0  " + vbCrLF + _
	  " 			AND ISNULL(grel_art_valori.rel_disabilitato, 0)=0 " + vbCrLF + _
	  " 			AND tip_visibile=1 " + vbCrLF + _
	  " 			AND tip_albero_visibile=1 " + vbCrLF + _
	  " 			AND ISNULL(listino_offerte, 0)=1 " + vbCrLF + _
	  " 			AND ISNULL(prz_visibile, 0)=1 " + vbCrLF + _
	  " 			AND (GETDATE() BETWEEN listino_dataCreazione AND ISNULL(listino_dataScadenza, GETDATE())+1) " + vbCrLF + _
	  " 			AND art_id IN (SELECT fo_articolo_id FROM gtb_art_foto WHERE ISNULL(fo_thumb, '') <> '')  " + vbCrLF + _
	  " 	GROUP BY art_id  " + vbCrLF + _
	  " 	ORDER BY NEWID() "
CALL DB.Execute(sql, 95)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 96
'...........................................................................................
'aggiunge stored procedure per elenco completo offerte 
'...........................................................................................
sql = "CREATE PROCEDURE dbo.sp_andycott_elenco_offerte " + vbCrLF + _
	  " AS " + vbCrLF + _
	  " 	SELECT *, " + vbCrLF + _
	  " 		(SELECT TOP 1 fo_thumb FROM gtb_art_foto WHERE ISNULL(fo_thumb, '')<>'' AND fo_articolo_id=art_id ORDER BY fo_ordine) AS foto, " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_offerte WHERE art_id = gtb_articoli.art_id) AS prezzo_offerta " + vbCrLF + _
	  " 	FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id=gtb_tipologie.tip_id " + vbCrLF + _
	  " 	WHERE art_id IN (SELECT art_id FROM gv_listino_offerte) " + vbCrLF + _
	  " 		AND tip_visibile=1 " + vbCrLF + _
	  " 		AND tip_albero_visibile=1 " + vbCrLF + _
	  " 	ORDER BY tip_ordine_assoluto, tip_nome_it, foto DESC, art_nome_it "
CALL DB.Execute(sql, 96)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 97
'...........................................................................................
'aggiunge stored procedure per elenco completo promozioni
'...........................................................................................
sql = "CREATE PROCEDURE dbo.sp_andycott_elenco_promozioni(@listino int) " + vbCrLF + _
	  " AS " + vbCrLF + _
	  " 	SELECT art_id, MAX(art_nome_it) AS art_nome, MIN(prz_prezzo) AS PREZZO, MAX(CAST(Art_Varianti AS int)) AS Art_Varianti " + vbCrLF + _
	  " 	FROM gv_listino_vendita " + vbCrLF + _
	  " 	WHERE prz_promozione=1 AND " + vbCrLF + _
	  " 		(ISNULL(listino_offerte, 0)=1 OR " + vbCrLF + _
	  " 			(prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte) AND  " + vbCrLF + _
	  " 				(prz_listino_id = @listino OR " + vbCrLF + _
	  " 					(ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 					prz_variante_id NOT IN (SELECT prz_variante_id FROM gtb_prezzi WHERE prz_listino_id=@listino)))))" + vbCrLF + _
	  " 	GROUP BY art_id " + vbCrLF + _
	  " 	ORDER BY PREZZO DESC"
CALL DB.Execute(sql, 97)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 98
'...........................................................................................
'aggiunge stored procedure per elenco articoli e relative versioni con ordinamento
'...........................................................................................
sql = "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_art_nome_ASC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY art_nome_it;  " + _
	  "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_art_nome_DESC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY art_nome_it DESC;  " + _
	  "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_art_cod_int_ASC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY art_cod_int;  " + _
	  "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_art_cod_int_DESC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY art_cod_int DESC;  " + _
	  "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_prezzo_ASC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY prezzo;  " + _
	  "CREATE PROCEDURE dbo.sp_andycott_elenco_articoli_cliente_prezzo_DESC(@tipologia int, @listino int) " + vbCrLF + _
	  " 	AS " + vbCrLF + _
	  " 		SELECT * , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE rel_art_id=gtb_articoli.art_id) AND  " + vbCrLF + _
	  " 			( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND prz_variante_id NOT IN  " + vbCrLF + _
	  " 			(SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND rel_art_id=gtb_articoli.art_id) ) ) ) )  " + vbCrLF + _
	  " 			AND rel_art_id=gtb_articoli.art_id) AS PREZZO  " + vbCrLF + _
	  " 		FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id  " + vbCrLF + _
	  " 		WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND  " + vbCrLF + _
	  " 			art_id IN ( SELECT rel_art_id FROM gv_listino_Vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLF + _
	  " 			( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0)  " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLF + _
	  " 			prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf +_
	  "			ORDER BY prezzo DESC;  "
CALL DB.Execute(sql, 98)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 99
'...........................................................................................
'aggiunge stored procedure per elenco raggruppamenti della tipologia
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_elenco_raggruppamenti_cliente(@tipologia int, @listino int)" + vbCrLF + _
	  " AS " + vbCrLF + _
	  " 	SELECT *, " + vbCrLF + _
	  " 		(SELECT COUNT(*) FROM gtb_articoli WHERE art_tipologia_id=@tipologia AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS N_ART, " + vbCrLF + _
	  " 		(SELECT COUNT(*) FROM gv_listino_offerte WHERE gv_listino_offerte.art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND gv_listino_offerte.art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS OFFERTA , " + vbCrLF + _
	  " 		(SELECT COUNT(*) FROM gv_listino_vendita WHERE prz_promozione=1 AND ( ISNULL(listino_offerte, 0)=1 OR ( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte " + vbCrLF + _
	  " 			WHERE art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 " + vbCrLF + _
	  " 			AND prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) ) ) ) ) " + vbCrLF + _
	  " 			AND art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS PROMOZIONE , " + vbCrLF + _
	  " 		(SELECT MIN(prz_prezzo) FROM gv_listino_vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR ( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte " + vbCrLF + _
	  " 			WHERE art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) " + vbCrLF + _
	  " 			AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 " + vbCrLF + _
	  " 			AND prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino " + vbCrLF + _
	  " 			AND art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) ) ) ) ) " + vbCrLF + _
	  " 			AND art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS PREZZO " + vbCrLF + _
	  " 	FROM gtb_tipologie_raggruppamenti " + vbCrLF + _
	  " 	WHERE rag_tipologia_id=@tipologia AND rag_id IN (SELECT art_raggruppamento_id FROM gtb_articoli WHERE art_tipologia_id=@tipologia) AND rag_visibile=1 " + vbCrLF + _
	  " 	ORDER BY rag_nome_it  "
CALL DB.Execute(sql, 99)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 100
'...........................................................................................
'aggiunge stored procedure che ritorna lo stato di promozione/offerta riferito all'articolo
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_articolo_stato_promozione(@listino int, @articolo int)" + vbCrLF + _
	  "		AS " + vbCrLF + _
	  "			SELECT MAX(CAST(listino_offerte AS INT)) AS OFFERTA," + vbCrLF + _
	  "				MAX(listino_dataScadenza) AS SCADENZA, " + vbCrLF + _
	  "				MAX(CAST(prz_promozione AS int)) AS PROMOZIONE " + vbCrLF + _
	  "			FROM gv_listino_vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR " + vbCrLF + _
	  "				( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_id=@articolo) AND " + vbCrLF + _
	  "				( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLF + _
	  "				prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND art_id=@articolo) ) ) ) ) " + vbCrLF + _
	  "				AND gv_listino_vendita.art_id = @articolo "
CALL DB.Execute(sql, 100)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 101
'...........................................................................................
'aggiunge stored procedure che ritorna la giacenza di un articolo
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_articolo_gianceza(	@articolo_id int, @variante_id int, @giacenza int OUTPUT) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "		IF (@variante_id=0) " + vbCrLf + _
	  "		BEGIN " + vbCrLf + _
	  "			SELECT TOP 1 @variante_id = rel_id FROM grel_art_valori WHERE rel_art_id = @articolo_id" + vbCrLf + _
	  "		END " + vbCrLf + _
	  "		SELECT @giacenza = SUM(gia_qta - gia_impegnato) " + vbCrLf + _
	  " 	FROM grel_giacenze INNER JOIN gtb_magazzini ON grel_giacenze.gia_magazzino_id = gtb_magazzini.mag_id " + vbCrLf + _
	  " 	WHERE gtb_magazzini.mag_disponibilita=1 AND gia_art_var_id=@variante_id"
CALL DB.Execute(sql, 101)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 102
'...........................................................................................
'funzione che ritorna il lisitno di una variante
'...........................................................................................
sql = "CREATE FUNCTION fn_andycott_variante_listino(@articolo_id int, @listino int) " + vbCrLf + _
	  " 	RETURNS TABLE " + vbCrLf + _
	  " 	AS" + vbCrLf + _
	  " 		RETURN SELECT * FROM gv_listino_vendita " + vbCrLf + _
	  " 			WHERE rel_art_id=@articolo_id AND " + _
	  "					( ISNULL(listino_offerte, 0)=1 OR " + vbCrLf + _
	  " 					( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE art_id=@articolo_id) " + vbCrLf + _
	  " 					AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  " 					prz_variante_id NOT IN (SELECT prz_variante_id FROM gtb_prezzi WHERE prz_listino_id=@listino AND art_id=@articolo_id) ) ) ) ) " + vbCrLf + _
	  " 			AND rel_art_id=@articolo_id "
CALL DB.Execute(sql, 102)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 103
'...........................................................................................
'aggiunge stored procedure che ritorna le tipologie con articoli nei preferiti
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_preferiti_categorie(@listino int, @utente int) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "		SELECT (tip_tipologia_padre_base) AS tip_id, COUNT(rel_id) AS N_PROD, MAX(tip_ordine) AS ordine " + vbCrLf + _
	  " 		FROM gv_listino_vendita " + vbCrLf + _
	  " 		WHERE rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  " 			AND gv_listino_vendita.tip_visibile=1 " + vbCrLf + _
	  " 			AND gv_listino_vendita.tip_albero_visibile=1 " + vbCrLf + _
	  " 			AND ( ISNULL(listino_offerte, 0)=1 OR " + vbCrLf + _
	  " 				( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE " + vbCrLf + _
	  " 					rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  " 					AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) " + vbCrLf + _
	  " 				AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  " 					prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND " + vbCrLf + _
	  " 						rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  " 						AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) ) ) ) ) " + vbCrLf + _
	  " 	GROUP BY tip_tipologia_padre_base " + vbCrLf + _
	  " 	ORDER BY ordine"
CALL DB.Execute(sql, 103)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 104
'...........................................................................................
'aggiunge stored procedure che ritorna le tipologie con articoli nei prodotti ordinati
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_ordinati_categorie(@listino int, @utente int) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "		SELECT (tip_tipologia_padre_base) AS tip_id, COUNT(rel_id) AS N_PROD, MAX(tip_ordine) AS ordine " + vbCrLf + _
	  " 		FROM gv_listino_vendita " + vbCrLf + _
	  " 		WHERE rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  " 			AND gv_listino_vendita.tip_visibile=1 " + vbCrLf + _
	  " 			AND gv_listino_vendita.tip_albero_visibile=1 " + vbCrLf + _
	  " 			AND ( ISNULL(listino_offerte, 0)=1 OR " + vbCrLf + _
	  " 				( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte WHERE " + vbCrLf + _
	  " 					rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  " 					AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) " + vbCrLf + _
	  " 				AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  " 					prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino AND " + vbCrLf + _
	  " 						rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  " 						AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) ) ) ) ) " + vbCrLf + _
	  " 	GROUP BY tip_tipologia_padre_base " + vbCrLf + _
	  " 	ORDER BY ordine"
CALL DB.Execute(sql, 104)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 105
'...........................................................................................
'aggiunge stored procedure che ritorna l'elenco degli articoli piu' ordinati per le categorie indicate
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_ordinati_articoli(@listino int, @utente int, @tipologie nvarchar(1000)) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "		SELECT * FROM gv_listino_vendita " + vbCrLf + _
	  "			WHERE gv_listino_vendita.rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  "		AND ( ISNULL(listino_offerte, 0)=1 OR ( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte " + vbCrLf + _
	  "			WHERE rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) " + vbCrLf + _
	  "				AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 " + vbCrLf + _
	  "				AND prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino " + vbCrLf + _
	  "				AND rel_id IN (SELECT ao_variante_id FROM gtb_articoli_ordinati WHERE ao_ut_id=@utente) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) ) ) ) ) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1 " + vbCrLf + _
	  "		ORDER BY gv_listino_vendita.tip_ordine_assoluto, gv_listino_vendita.rel_ordine "
CALL DB.Execute(sql, 105)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 106
'...........................................................................................
'aggiunge stored procedure che ritorna l'elenco degli articoli preferiti per le categorie indicate
'...........................................................................................
sql = " CREATE PROCEDURE dbo.sp_andycott_preferiti_articoli(@listino int, @utente int, @tipologie nvarchar(1000)) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "		SELECT * FROM gv_listino_vendita " + vbCrLf + _
	  "			WHERE gv_listino_vendita.rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  "		AND ( ISNULL(listino_offerte, 0)=1 OR ( prz_variante_id NOT IN (SELECT prz_variante_id FROM gv_listino_offerte " + vbCrLf + _
	  "			WHERE rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) " + vbCrLf + _
	  "				AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 " + vbCrLf + _
	  "				AND prz_variante_id NOT IN (SELECT rel_id FROM gv_listini WHERE prz_listino_id=@listino " + vbCrLf + _
	  "				AND rel_id IN (SELECT wish_variante_id FROM gtb_wish_list WHERE wish_ut_id=@utente) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1) ) ) ) ) " + vbCrLf + _
	  "				AND (@tipologie LIKE '% ' + CAST(gv_listino_vendita.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  "				AND gv_listino_vendita.tip_visibile=1 AND gv_listino_vendita.tip_albero_visibile=1 " + vbCrLf + _
	  "		ORDER BY gv_listino_vendita.tip_ordine_assoluto, gv_listino_vendita.rel_ordine "
CALL DB.Execute(sql, 106)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 107
'...........................................................................................
sql = Aggiornamento__B2B__74(conn)
CALL DB.Execute(sql, 107)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 108: inserisce struttura dati per next-gallery
'...........................................................................................
sql = Install__FRAMEWORK_CORE__NEXTGALLERY(conn)
CALL DB.Execute(sql, 108)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 109: inserisce struttura dati per next-faq
'...........................................................................................
sql = Install__FRAMEWORK_CORE__NEXTFAQ(conn)
CALL DB.Execute(sql, 109)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 110
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__2(conn)
CALL DB.Execute(sql, 110)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 111
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__3(conn)
CALL DB.Execute(sql, 111)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 112
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__4(conn)
CALL DB.Execute(sql, 112)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 113: inserisce struttura dati per next-team
'...........................................................................................
sql = Install__FRAMEWORK_CORE__NEXTTEAM(conn)
CALL DB.Execute(sql, 113)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 114
'...........................................................................................
sql = rebuild__FRAMEWORK_CORE__Nomi_Applicazioni(conn)
CALL DB.Execute(sql, 114)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 115
'...........................................................................................
CALL rebuild__FRAMEWORK_CORE__cartelle(conn, rs, DB, 115)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 116
'...........................................................................................
'variazione stored procedure per recuperare stato prezzi dell'articolo
'...........................................................................................
sql = " ALTER PROCEDURE sp_andycott_articolo_stato_promozione(@listino int, @articolo int) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "			SELECT MAX(CAST(listino_offerte AS INT)) AS OFFERTA, " + vbCrLf + _
	  " 		MAX(listino_dataScadenza) AS SCADENZA, " + vbCrLf + _
	  " 		MAX(CAST(prz_promozione AS int)) AS PROMOZIONE, " + vbCrLf + _
	  " 		MIN(prz_prezzo) AS PREZZO " + vbCrLf + _
	  " 		FROM gv_listino_vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  " 			( NOT EXISTS (SELECT *  FROM gv_listino_offerte WHERE art_id=@articolo AND gv_listino_offerte.rel_id = gv_listino_vendita.prz_variante_id) AND  " + vbCrLf + _
	  " 			  ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLf + _
	  " 				NOT EXISTS (SELECT * FROM gv_listini WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id AND prz_listino_id=@listino AND art_id=@articolo) ) ) ) )  " + vbCrLf + _
	  " 			AND gv_listino_vendita.art_id = @articolo "
CALL DB.Execute(sql, 116)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 117
'...........................................................................................
'variazione stored procedure per recuperare elenco articoli
'...........................................................................................
sql = " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_ASC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_nome_it ; " + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_ASC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_nome_it DESC; "
CALL DB.Execute(sql, 117)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 118
'...........................................................................................
'variazione stored procedure per recuperare stato prezzi dell'articolo
'...........................................................................................
sql = " ALTER PROCEDURE sp_andycott_articolo_stato_promozione(@listino int, @articolo int) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  "			SELECT MAX(CAST(listino_offerte AS INT)) AS OFFERTA, " + vbCrLf + _
	  " 		MAX(listino_dataScadenza) AS SCADENZA, " + vbCrLf + _
	  " 		MAX(CAST(prz_promozione AS int)) AS PROMOZIONE, " + vbCrLf + _
	  " 		MIN(prz_prezzo) AS PREZZO " + vbCrLf + _
	  " 		FROM gv_listino_vendita WHERE ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  " 			( NOT EXISTS (SELECT *  FROM gv_listino_offerte WHERE art_id=@articolo AND gv_listino_offerte.rel_id = gv_listino_vendita.prz_variante_id) AND  " + vbCrLf + _
	  " 			  ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND  " + vbCrLf + _
	  " 				NOT EXISTS (SELECT * FROM gv_listini WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id AND prz_listino_id=@listino AND art_id=@articolo) ) ) ) )  " + vbCrLf + _
	  " 			AND gv_listino_vendita.art_id = @articolo "
CALL DB.Execute(sql, 118)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 119
'...........................................................................................
'variazione stored procedure per recuperare elenco articoli
'...........................................................................................
sql = " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_ASC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_nome_it ; " + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_DESC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_nome_it DESC; " + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_cod_int_ASC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_cod_int ; " + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_cod_int_DESC(@tipologia int, @listino int) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "				EXISTS (SELECT * FROM gv_listino_Vendita  " + vbCrLf + _
	  "						WHERE gv_listino_vendita.art_id=gtb_articoli.art_id AND " + vbCrLf + _
	  "							  ( ISNULL(listino_offerte, 0)=1 OR  " + vbCrLf + _
	  "							  (NOT EXISTS(SELECT * FROM gv_listino_offerte  " + vbCrLf + _
	  "										  WHERE gv_listino_offerte.prz_variante_id = gv_listino_vendita.rel_id  " + vbCrLf + _
	  "												AND art_tipologia_id=@tipologia AND ISNULL(art_raggruppamento_id, 0)=0) " + vbCrLf + _
	  "							  AND ( prz_listino_id = @listino OR ( ISNULL(listino_base_attuale, 0)=1 AND " + vbCrLf + _
	  "			    NOT EXISTS (SELECT * FROM gv_listini  " + vbCrLf + _
	  "							WHERE gv_listini.rel_id = gv_listino_vendita.prz_variante_id  " + vbCrLf + _
	  "							AND prz_listino_id=@listino AND art_tipologia_id=@tipologia  " + vbCrLf + _
	  "							AND ISNULL(art_raggruppamento_id, 0)=0) ) ) ) ) ) " + vbCrLf + _
	  "			ORDER BY art_cod_int DESC; "
CALL DB.Execute(sql, 119)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 120
'...........................................................................................
'elimina stored procedure non pi&ugrave; utilizzata
'...........................................................................................
sql = "DROP PROCEDURE sp_andycott_articolo_stato_promozione; "
CALL DB.Execute(sql, 120)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 121
'...........................................................................................
'aggiorna stored procedure con nuova logica
'...........................................................................................
sql = " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_cod_int_ASC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY art_cod_int " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_cod_int_DESC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY art_cod_int DESC" + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_ASC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY art_nome_it " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_art_nome_DESC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY art_nome_it DESC" + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_prezzo_ASC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY prezzo " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_articoli_cliente_prezzo_DESC(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  "		AS " + vbCrLf + _
	  "			SELECT * " + vbCrLf + _
	  "				,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ))" + vbCrLf + _
	  "						 FROM grel_art_valori " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						 WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "						LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE( tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS IN_PROMOZIONE " + vbCrLf + _
	  "				, (SELECT MAX(COALESCE(tb_offerte.prz_visibile, 0)) " + vbCrLf + _
	  "						FROM grel_art_valori " + vbCrLf + _
	  "						INNER JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "						WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(tb_offerte.prz_visibile,0)=1) AS IN_OFFERTA " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_marche ON gtb_articoli.art_marca_id = gtb_marche.mar_id " + vbCrLf + _
	  "			WHERE gtb_articoli.art_tipologia_id = @TIPOLOGIA AND " + vbCrLf + _
	  "				ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  "				art_id IN (SELECT rel_art_id " + vbCrLf + _
	  "								  FROM grel_art_valori " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  "								  LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  "								  WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  "										ISNULL(art_raggruppamento_id, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  "										ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  "			ORDER BY prezzo DESC" + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_elenco_offerte (@listino_offerte int) " + vbCrLf + _
	  "		AS  " + vbCrLf + _
	  "			SELECT * ,  " + vbCrLf + _
	  "				(SELECT TOP 1 fo_thumb FROM gtb_art_foto WHERE ISNULL(fo_thumb, '')<>'' AND fo_articolo_id=art_id ORDER BY fo_ordine) AS foto,  " + vbCrLf + _
	  "				(SELECT MIN(prz_prezzo) FROM grel_art_valori INNER JOIN gtb_prezzi ON grel_art_valori.rel_id = gtb_prezzi.prz_variante_id AND  " + vbCrLf + _
	  "					gtb_prezzi.prz_listino_id=@listino_offerte WHERE gtb_prezzi.prz_visibile=1 AND grel_art_valori.rel_art_id = gtb_articoli.art_id) AS PREZZO  " + vbCrLf + _
	  "			FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id=gtb_tipologie.tip_id  " + vbCrLf + _
	  "			WHERE art_id IN (SELECT rel_art_id FROM grel_art_valori INNER JOIN gtb_prezzi ON grel_art_valori.rel_id = gtb_prezzi.prz_variante_id AND gtb_prezzi.prz_listino_id=@listino_offerte  " + vbCrLf + _
	  "							 WHERE gtb_prezzi.prz_visibile=1 AND ISNULL(grel_art_valori.rel_disabilitato, 0)=0 ) " + vbCrLf + _
	  "				AND ISNULL(gtb_articoli.art_disabilitato, 0) = 0  " + vbCrLf + _
	  "				AND tip_visibile=1 " + vbCrLf + _
	  "				AND tip_albero_visibile=1 " + vbCrLf + _
	  "			ORDER BY tip_ordine_assoluto, art_nome_it" + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_elenco_offerte_home " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		DECLARE @listino_offerte int " + vbCrLf + _
	  " 		SELECT @listino_offerte=listino_id FROM gtb_listini " + vbCrLf + _
	  " 			WHERE ISNULL(listino_offerte, 0)=1 AND (GETDATE() BETWEEN listino_dataCreazione AND ISNULL(listino_dataScadenza, GETDATE())+1) " + vbCrLf + _
	  vbCrLf + _
	  " 		SELECT TOP 7 art_id, art_nome_it AS art_nome, " + vbCrLf + _
	  " 			(SELECT MIN(prz_prezzo) FROM grel_art_valori " + vbCrLf + _
	  " 									INNER JOIN gtb_prezzi ON grel_art_valori.rel_id = gtb_prezzi.prz_variante_id AND gtb_prezzi.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 									WHERE gtb_prezzi.prz_visibile=1 AND grel_art_valori.rel_art_id = gtb_articoli.art_id) AS prezzo_offerta " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id=gtb_tipologie.tip_id " + vbCrLf + _
	  " 			WHERE art_id IN (SELECT rel_art_id FROM grel_art_valori INNER JOIN gtb_prezzi ON grel_art_valori.rel_id = gtb_prezzi.prz_variante_id AND gtb_prezzi.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 											   WHERE gtb_prezzi.prz_visibile=1 AND ISNULL(grel_art_valori.rel_disabilitato, 0)=0 )" + vbCrLf + _
	  " 			AND ISNULL(gtb_articoli.art_disabilitato, 0) = 0 " + vbCrLf + _
	  " 			AND tip_visibile=1 " + vbCrLf + _
	  " 			AND tip_albero_visibile=1 " + vbCrLf + _
	  " 			AND art_id IN (SELECT fo_articolo_id FROM gtb_art_foto WHERE ISNULL(fo_thumb, '') <> '') " + vbCrLf + _
	  " 		ORDER BY NEWID() " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_elenco_promozioni(@listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		SELECT art_id,  (art_nome_it) AS art_nome, art_Varianti " + vbCrLf + _
	  " 			,(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo )) " + vbCrLf + _
	  " 					FROM grel_art_valori " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 					WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id " + vbCrLf + _
	  " 		WHERE gtb_tipologie.tip_visibile=1 AND " + vbCrLf + _
	  " 			gtb_tipologie.tip_albero_visibile=1 AND " + vbCrLf + _
	  " 			ISNULL(gtb_articoli.art_disabilitato,0)=0 AND " + vbCrLf + _
	  " 			art_id IN (SELECT rel_art_id FROM grel_art_valori " + vbCrLf + _
	  " 										 LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 										 LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 										 LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 					   WHERE grel_art_valori.rel_art_id = gtb_articoli.art_id AND " + vbCrLf + _
	  " 							 ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  " 							 ISNULL(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione),0)=1 AND " + vbCrLf + _
	  " 							 ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1 AND " + vbCrLf + _
	  " 							 ISNULL(tb_offerte.prz_visibile,0)=0) " + vbCrLf + _
	  " 		ORDER BY PREZZO DESC " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE sp_andycott_elenco_raggruppamenti_cliente(@tipologia int, @listino_cliente int, @listino_offerte int, @listino_base int ) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		SELECT *, " + vbCrLf + _
	  " 			(SELECT COUNT(*) FROM gtb_articoli WHERE art_tipologia_id=@tipologia AND art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS N_ART, " + vbCrLf + _
	  " 			(SELECT COUNT(*) FROM gv_listino_offerte WHERE gv_listino_offerte.art_tipologia_id=gtb_tipologie_raggruppamenti.rag_tipologia_id AND gv_listino_offerte.art_raggruppamento_id=gtb_tipologie_raggruppamenti.rag_id) AS OFFERTA , " + vbCrLf + _
	  " 			(SELECT MIN(COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo )) " + vbCrLf + _
	  " 				FROM gtb_articoli INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 				WHERE art_tipologia_id=@tipologia AND art_raggruppamento_id = gtb_tipologie_raggruppamenti.rag_id  AND ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PREZZO, " + vbCrLf + _
	  " 			(SELECT MAX(COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione,0 )) " + vbCrLf + _
	  " 				FROM gtb_articoli INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 					LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 				WHERE art_tipologia_id=@tipologia AND art_raggruppamento_id = gtb_tipologie_raggruppamenti.rag_id  AND ISNULL(COALESCE(tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) AS PROMOZIONE " + vbCrLf + _
	  " 		FROM gtb_tipologie_raggruppamenti " + vbCrLf + _
	  " 		WHERE rag_tipologia_id=@tipologia AND rag_id IN (SELECT art_raggruppamento_id FROM gtb_articoli WHERE art_tipologia_id=@tipologia) " + vbCrLf + _
	  " 			AND rag_visibile=1 " + vbCrLf + _
	  " 		ORDER BY rag_nome_it " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_ordinati_articoli(@listino_cliente int, @listino_offerte int, @listino_base int, @utente int, @tipologie nvarchar(1000)) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		SELECT COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ) AS prz_prezzo, " + vbCrLf + _
	  " 			COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile) AS prz_visibile, " + vbCrLf + _
	  " 			COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione) AS prz_promozione, " + vbCrLf + _
	  " 			COALESCE(tb_offerte.prz_scontoQ_id, tb_cliente.prz_scontoQ_id, tb_base.prz_scontoQ_id) AS prz_scontoQ_id, " + vbCrLf + _
	  " 			COALESCE(tb_iva_offerte.iva_valore, tb_iva_cliente.iva_valore, tb_iva_base.iva_valore) AS iva_valore, " + vbCrLf + _
	  " 			ISNULL(tb_offerte.prz_visibile,0) AS listino_offerte, " + vbCrLf + _
	  " 			gtb_articoli.*, grel_art_valori.*, gtb_tipologie.* " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 			INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id AND gtb_tipologie.tip_visibile=1 " + vbCrLf + _
	  " 									 AND gtb_tipologie.tip_albero_visibile=1 AND (@tipologie LIKE '% ' + CAST(gtb_tipologie.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  " 			INNER JOIN gtb_articoli_ordinati ON grel_art_valori.rel_id = gtb_articoli_ordinati.ao_variante_id AND gtb_articoli_ordinati.ao_ut_id=@utente " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_cliente ON tb_cliente.prz_iva_id = tb_iva_cliente.iva_id " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_offerte ON tb_offerte.prz_iva_id = tb_iva_offerte.iva_id " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_base ON tb_base.prz_iva_id = tb_iva_base.iva_id " + vbCrLf + _
	  " 		WHERE COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile)=1 " + vbCrLf + _
	  " 		ORDER BY gtb_tipologie.tip_ordine_assoluto, grel_art_valori.rel_ordine " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_ordinati_categorie(@listino_cliente int, @listino_offerte int, @listino_base int, @utente int) " + vbCrLf + _
	  " 	 AS " + vbCrLf + _
	  " 		SELECT (tip_tipologia_padre_base) AS tip_id, COUNT(rel_id) AS N_PROD, MAX(tip_ordine_assoluto) AS ordine " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id " + vbCrLf + _
	  " 			INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 		WHERE gtb_tipologie.tip_visibile=1 AND " + vbCrLf + _
	  " 			gtb_tipologie.tip_albero_visibile=1 AND " + vbCrLf + _
	  " 			rel_id IN (SELECT ao_variante_id " + vbCrLf + _
	  " 							FROM gtb_articoli_ordinati " + vbCrLf + _
	  " 								LEFT JOIN gtb_prezzi tb_cliente ON gtb_articoli_ordinati.ao_variante_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 								LEFT JOIN gtb_prezzi tb_offerte ON gtb_articoli_ordinati.ao_variante_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 								LEFT JOIN gtb_prezzi tb_base ON gtb_articoli_ordinati.ao_variante_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 							WHERE ao_ut_id=@utente AND " + vbCrLf + _
	  " 								ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  " 								ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  " 						GROUP BY tip_tipologia_padre_base " + vbCrLf + _
	  " 		ORDER BY ordine " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_preferiti_articoli(@listino_cliente int, @listino_offerte int, @listino_base int, @utente int, @tipologie nvarchar(1000)) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		SELECT COALESCE(tb_offerte.prz_prezzo, tb_cliente.prz_prezzo, tb_base.prz_prezzo ) AS prz_prezzo, " + vbCrLf + _
	  " 			COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile) AS prz_visibile, " + vbCrLf + _
	  " 			COALESCE(tb_cliente.prz_promozione, tb_base.prz_promozione) AS prz_promozione, " + vbCrLf + _
	  " 			COALESCE(tb_offerte.prz_scontoQ_id, tb_cliente.prz_scontoQ_id, tb_base.prz_scontoQ_id) AS prz_scontoQ_id, " + vbCrLf + _
	  " 			COALESCE(tb_iva_offerte.iva_valore, tb_iva_cliente.iva_valore, tb_iva_base.iva_valore) AS iva_valore, " + vbCrLf + _
	  " 			ISNULL(tb_offerte.prz_visibile,0) AS listino_offerte, " + vbCrLf + _
	  " 			gtb_articoli.*, grel_art_valori.*, gtb_tipologie.* " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 			INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id AND gtb_tipologie.tip_visibile=1 " + vbCrLf + _
	  " 									 AND gtb_tipologie.tip_albero_visibile=1 AND (@tipologie LIKE '% ' + CAST(gtb_tipologie.tip_tipologia_padre_base AS nvarchar(10)) + ' %') " + vbCrLf + _
	  " 			INNER JOIN gtb_wish_list ON grel_art_valori.rel_id = gtb_wish_list.wish_variante_id AND gtb_wish_list.wish_ut_id=@utente " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_cliente ON grel_art_valori.rel_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_offerte ON grel_art_valori.rel_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 			LEFT JOIN gtb_prezzi tb_base ON grel_art_valori.rel_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_cliente ON tb_cliente.prz_iva_id = tb_iva_cliente.iva_id " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_offerte ON tb_offerte.prz_iva_id = tb_iva_offerte.iva_id " + vbCrLf + _
	  " 			LEFT JOIN gtb_iva tb_iva_base ON tb_base.prz_iva_id = tb_iva_base.iva_id " + vbCrLf + _
	  " 		WHERE COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile)=1 " + vbCrLf + _
	  " 		ORDER BY gtb_tipologie.tip_ordine_assoluto, grel_art_valori.rel_ordine " + vbCrLf + _
	  " ; " + vbCrLf + _
	  " ALTER PROCEDURE dbo.sp_andycott_preferiti_categorie(@listino_cliente int, @listino_offerte int, @listino_base int, @utente int) " + vbCrLf + _
	  " 	AS " + vbCrLf + _
	  " 		SELECT (tip_tipologia_padre_base) AS tip_id, COUNT(rel_id) AS N_PROD, MAX(tip_ordine_assoluto) AS ordine " + vbCrLf + _
	  " 		FROM gtb_articoli INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id " + vbCrLf + _
	  " 			INNER JOIN grel_art_valori ON gtb_articoli.art_id = grel_art_valori.rel_art_id " + vbCrLf + _
	  " 		WHERE gtb_tipologie.tip_visibile=1 AND " + vbCrLf + _
	  " 			gtb_tipologie.tip_albero_visibile=1 AND " + vbCrLf + _
	  " 			rel_id IN (SELECT wish_variante_id FROM gtb_wish_list " + vbCrLf + _
	  " 							LEFT JOIN gtb_prezzi tb_cliente ON gtb_wish_list.wish_variante_id = tb_cliente.prz_variante_id AND tb_cliente.prz_listino_id=@listino_cliente " + vbCrLf + _
	  " 							LEFT JOIN gtb_prezzi tb_offerte ON gtb_wish_list.wish_variante_id = tb_offerte.prz_variante_id AND tb_offerte.prz_listino_id=@listino_offerte " + vbCrLf + _
	  " 							LEFT JOIN gtb_prezzi tb_base ON gtb_wish_list.wish_variante_id = tb_base.prz_variante_id AND tb_base.prz_listino_id=@listino_base " + vbCrLf + _
	  " 					   WHERE wish_ut_id=@utente AND " + vbCrLf + _
	  " 							ISNULL(rel_disabilitato, 0)=0 AND " + vbCrLf + _
	  " 							ISNULL(COALESCE(tb_offerte.prz_visibile, tb_cliente.prz_visibile, tb_base.prz_visibile),0)=1) " + vbCrLf + _
	  " 		GROUP BY tip_tipologia_padre_base " + vbCrLf + _
	  " 		ORDER BY ordine "
CALL DB.Execute(sql, 121)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 122
'...........................................................................................
'aggiorna vista per exprot ordini fornitori
'...........................................................................................
sql = "if EXISTS (select * from dbo.sysobjects where id = object_id(N'dbo.gv_articoli_fornitori_F000078') and OBJECTPROPERTY(id, N'IsView') = 1) " + _
	  "		DROP VIEW dbo.gv_articoli_fornitori_F000078 " + _
	  "	; " + _
	  " CREATE VIEW dbo.gv_articoli_fornitori_F000078 AS " + vbCrLf + _
	  "	SELECT * FROM gv_articoli INNER JOIN gItb_Articoli " + vbCrLf + _
	  "		ON (gv_articoli.rel_external_id=gItb_articoli.Iart_id OR gv_articoli.art_external_id = gItb_articoli.Iart_id) " + vbCrLf + _
	  "		WHERE ((gv_articoli.rel_external_id=gItb_articoli.Iart_id AND gv_articoli.rel_id=gItb_articoli.Iart_b2b_id)  " + vbCrLf + _
	  "				OR (gv_articoli.art_external_id = gItb_articoli.Iart_id AND  gv_articoli.art_id=gItb_articoli.Iart_b2b_id)) " + vbCrLf + _
	  "			AND gItb_articoli.Iart_x_fornitore LIKE 'F000078'" + vbCrLf + _
	  "			AND IsNULL(gItb_articoli.Iart_x_cod_fornitore, '')<>'' "
CALL DB.Execute(sql, 122)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 123
'...........................................................................................
'rimuove stored procedure non pi&ugrave; utilizzata
'...........................................................................................
sql = "DROP PROCEDURE sp_andycott_elenco_offerte_home"
CALL DB.Execute(sql, 123)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 124
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__5(conn)
CALL DB.Execute(sql, 124)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 125
'...........................................................................................
'rimuove stored procedure non pi&ugrave; utilizzata
'...........................................................................................
sql = " DROP VIEW gv_CartDetail; " + _
	  " CREATE VIEW dbo.gv_CartDetail AS " + vbCrLf + _
	  "		SELECT *, (SELECT COUNT(dd_ind_id) FROM gtb_dett_Cart_dest WHERE dd_dett_id = gtb_dett_cart.dett_id) AS N_DEST, " + vbCrLf + _
	  "				  (SELECT COUNT(dp_ut_id) FROM gtb_dett_Cart_proposte WHERE dp_Dett_id=gtb_dett_Cart.dett_id) AS N_UT " + vbCrLf + _
	  "		FROM grel_art_valori INNER JOIN gtb_dett_cart ON grel_art_valori.rel_id = gtb_dett_cart.dett_art_var_id " + vbCrLf + _
	  "			 INNER JOIN gtb_articoli ON grel_art_valori.rel_art_id = gtb_articoli.art_id " + vbCrLf + _
	  "			 INNER JOIN gtb_iva ON gtb_dett_cart.dett_iva_id = gtb_iva.iva_id " + vbCrLf + _
	  "			 INNER JOIN gtb_tipologie ON gtb_articoli.art_tipologia_id = gtb_tipologie.tip_id " + vbCrLf + _
	  "		WHERE ISNULL(gtb_articoli.art_disabilitato, 0)=0 AND " + vbCrLf + _
	  "			  ISNULL(grel_art_valori.rel_disabilitato,0)=0 AND " + vbCrLf + _
	  "			  ISNULL(gtb_tipologie.tip_albero_visibile, 0) = 1 AND " + vbCrLf + _
	  "			  ISNULL(gtb_tipologie.tip_visibile, 0)= 1 "
CALL DB.Execute(sql, 125)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 126
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__6(conn)
CALL DB.Execute(sql, 126)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 127
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__7(conn)
CALL DB.Execute(sql, 127)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 128
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__8(conn)
CALL DB.Execute(sql, 128)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 129
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__9(conn)
CALL DB.Execute(sql, 129)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 130
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__10(conn)
CALL DB.Execute(sql, 130)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 131
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__11(conn)
CALL DB.Execute(sql, 131)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 132
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__12(DB, rs, 132)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 133
'...........................................................................................
sql = Aggiornamento__B2B__75(conn)
CALL DB.Execute(sql, 133)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 134
'...........................................................................................
sql = Aggiornamento__B2B__76(conn)
CALL DB.Execute(sql, 134)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 135
'...........................................................................................
sql = Aggiornamento__B2B__77(conn)
CALL DB.Execute(sql, 135)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 136
'...........................................................................................
sql = Aggiornamento__B2B__78(conn)
CALL DB.Execute(sql, 136)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 137
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__13(conn)
CALL DB.Execute(sql, 137)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 138
'...........................................................................................
sql = rebuild__FRAMEWORK_CORE__Nomi_Applicazioni(conn)
CALL DB.Execute(sql, 138)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 139
'...........................................................................................
sql = Install__FRAMEWORK_CORE__NEXTWEB5(conn)
CALL DB.Execute(sql, 139)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 140
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__14(conn)
CALL DB.Execute(sql, 140)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 141
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__15(conn)
CALL DB.Execute(sql, 141)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 142
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__16(conn)
CALL DB.Execute(sql, 142)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 143
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__17(conn)
CALL DB.Execute(sql, 143)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 144
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__18(conn)
CALL DB.Execute(sql, 144)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 145
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__19(conn)
CALL DB.Execute(sql, 145)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 146
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__20(conn)
CALL DB.Execute(sql, 146)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 147
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__21(conn)
CALL DB.Execute(sql, 147)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 148
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__22(conn)
CALL DB.Execute(sql, 148)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 149
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__23(conn)
CALL DB.Execute(sql, 149)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 150
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__24(conn)
CALL DB.Execute(sql, 150)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 151
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__25(conn)
CALL DB.Execute(sql, 151)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 152
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__26(conn) + _
	  Aggiornamento__FRAMEWORK_CORE__27(conn)
CALL DB.Execute(sql, 152)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 153
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__28(conn)
CALL DB.Execute(sql, 153)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 154
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__29(conn)
CALL DB.Execute(sql, 154)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 155
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__30(conn)
CALL DB.Execute(sql, 155)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 156
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__31(conn)
CALL DB.Execute(sql, 156)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 157
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__32(conn)
CALL DB.Execute(sql, 157)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 158
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__33(conn)
CALL DB.Execute(sql, 158)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 159
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__34(conn)
CALL DB.Execute(sql, 159)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 160
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__35(conn)
CALL DB.Execute(sql, 160)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 161
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__36(conn)
CALL DB.Execute(sql, 161)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 162
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__37(conn)
CALL DB.Execute(sql, 162)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 163
'...........................................................................................
sql = AggiornamentoSpeciale__FRAMEWORK_CORE__38(DB, rs, 163)
CALL DB.Execute(sql, 163)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 164
'...........................................................................................
sql = AggiornamentoSpeciale__B2B__79(DB, rs, 164)
CALL DB.Execute(sql, 164)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 165
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__39(conn)
CALL DB.Execute(sql, 165)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(165)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 166
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__40(conn)
CALL DB.Execute(sql, 166)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 167
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__41(conn)
CALL DB.Execute(sql, 167)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 168
'...........................................................................................
sql = Aggiornamento__B2B__80(conn)
CALL DB.Execute(sql, 168)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 169
'...........................................................................................
sql = Aggiornamento__B2B__81(conn)
CALL DB.Execute(sql, 169)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 170
'...........................................................................................
sql = Aggiornamento__B2B__82(conn)
CALL DB.Execute(sql, 170)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 171
'...........................................................................................
sql = Aggiornamento__B2B__83(conn)
CALL DB.Execute(sql, 171)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(171)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 172
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__42(conn)
CALL DB.Execute(sql, 172)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 173
'...........................................................................................
sql = Aggiornamento__B2B__84(conn)
CALL DB.Execute(sql, 173)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 174
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__43(conn)
CALL DB.Execute(sql, 174)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 175
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__44(conn)
CALL DB.Execute(sql, 175)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 176
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__45(conn)
CALL DB.Execute(sql, 176)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 177
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__46(conn)
CALL DB.Execute(sql, 177)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 178
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__47(conn)
CALL DB.Execute(sql, 178)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 179
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__48(conn)
CALL DB.Execute(sql, 179)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 180
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__49(conn)
CALL DB.Execute(sql, 180)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 181
'...........................................................................................
sql = "SELECT * FROM aa_versione"
CALL DB.Execute(sql, 181)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 182
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__50(conn)
CALL DB.Execute(sql, 182)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 183
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__51(conn)
CALL DB.Execute(sql, 183)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 184
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__52(conn)
CALL DB.Execute(sql, 184)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 185
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__53(conn)
CALL DB.Execute(sql, 185)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 186
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__54(conn)
CALL DB.Execute(sql, 186)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 187
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__55(conn)
CALL DB.Execute(sql, 187)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 188
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__56(conn)
CALL DB.Execute(sql, 188)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 189
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__57(conn)
CALL DB.Execute(sql, 189)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 190
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__58(conn)
CALL DB.Execute(sql, 190)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 191
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__59(conn)
CALL DB.Execute(sql, 191)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 192
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__60(conn)
CALL DB.Execute(sql, 192)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 193
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__61(conn)
CALL DB.Execute(sql, 193)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(193)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 194
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__62(conn)
CALL DB.Execute(sql, 194)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 195
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__63(conn)
CALL DB.Execute(sql, 195)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 196
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__64(conn)
CALL DB.Execute(sql, 196)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 197
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__65(conn)
CALL DB.Execute(sql, 197)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 198
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__66(conn)
CALL DB.Execute(sql, 198)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 199
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__67(conn)
CALL DB.Execute(sql, 199)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 200
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__68(conn)
CALL DB.Execute(sql, 200)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 201
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__69(conn)
CALL DB.Execute(sql, 201)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 202
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__70(conn)
CALL DB.Execute(sql, 202)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 203
'...........................................................................................
sql = Aggiornamento__B2B__85(conn)
CALL DB.Execute(sql, 203)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 204
'...........................................................................................
sql = Aggiornamento__B2B__86(conn)
CALL DB.Execute(sql, 204)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(204)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 205
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__71(conn)
CALL DB.Execute(sql, 205)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 206
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__72(DB, 206)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 207
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__73(conn)
CALL DB.Execute(sql, 207)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 208
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__74(conn)
CALL DB.Execute(sql, 208)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 209
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__75(conn)
CALL DB.Execute(sql, 209)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(209)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 210
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__76(conn)
CALL DB.Execute(sql, 210)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 211
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__77(conn)
CALL DB.Execute(sql, 211)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 212
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__78(conn)
CALL DB.Execute(sql, 212)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 213
'...........................................................................................
sql = Aggiornamento__B2B__87(conn)
CALL DB.Execute(sql, 213)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 214
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__79(conn)
CALL DB.Execute(sql, 214)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 215
'...........................................................................................
sql = Aggiornamento__B2B__88(conn)
CALL DB.Execute(sql, 215)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 216
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__80(conn)
CALL DB.Execute(sql, 216)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 217
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__81(conn)
CALL DB.Execute(sql, 217)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(217)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 218
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__82(conn)
CALL DB.Execute(sql, 218)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 219
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__83(conn)
CALL DB.Execute(sql, 219)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 220
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__84(conn)
CALL DB.Execute(sql, 220)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 221
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__85(conn)
CALL DB.Execute(sql, 221)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 222
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__86(conn)
CALL DB.Execute(sql, 222)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 223
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__87(DB, 223)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 224
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__88(conn)
CALL DB.Execute(sql, 224)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 225
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__89(conn)
CALL DB.Execute(sql, 225)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(225)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 226
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__90(DB, rs, 226)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 227
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__91(conn)
CALL DB.Execute(sql, 227)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(227)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 228
'...........................................................................................
sql = Aggiornamento__B2B__89(conn)
CALL DB.Execute(sql, 228)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 229
'...........................................................................................
sql = Aggiornamento__B2B__90(conn)
CALL DB.Execute(sql, 229)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 230
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__92(conn)
CALL DB.Execute(sql, 230)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 231
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__93(conn)
CALL DB.Execute(sql, 231)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 232
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__94(conn)
CALL DB.Execute(sql, 232)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 233
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__95(conn)
CALL DB.Execute(sql, 233)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.RebuildIndex_RefreshContents("tb_webs", "id_webs")
'*******************************************************************************************

'*******************************************************************************************
CALL DB.RebuildIndex_RefreshContents("tb_paginesito", "id_pagineSito")
'*******************************************************************************************

'*******************************************************************************************
CALL DB.RebuildIndex_RefreshContents("tb_contents_index", "idx_livello")
'*******************************************************************************************

'*******************************************************************************************
CALL DB.RebuildIndex_OperazioniRicorsive()
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 234
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__96(conn)
CALL DB.Execute(sql, 234)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 235
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__97(conn)
CALL DB.Execute(sql, 235)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 236
'...........................................................................................
sql = Aggiornamento__B2B__91(conn)
CALL DB.Execute(sql, 236)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 237
'...........................................................................................
sql = Aggiornamento__B2B__92(conn)
CALL DB.Execute(sql, 237)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 238
'...........................................................................................
sql = Aggiornamento__B2B__93(conn)
CALL DB.Execute(sql, 238)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(238)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 239
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__98(conn)
CALL DB.Execute(sql, 239)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 240
'...........................................................................................
sql = Aggiornamento__B2B__94(conn)
CALL DB.Execute(sql, 240)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 241
'...........................................................................................
sql = Aggiornamento__B2B__95(conn)
CALL DB.Execute(sql, 241)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(241)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 242
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__99(conn)
CALL DB.Execute(sql, 242)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 243
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__100(conn)
CALL DB.Execute(sql, 243)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(243)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 244
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__101(conn)
CALL DB.Execute(sql, 244)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 245
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__102(conn)
CALL DB.Execute(sql, 245)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 246
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__103(conn)
CALL DB.Execute(sql, 246)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(246)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 247
'...........................................................................................
sql = Aggiornamento__B2B__96(conn)
CALL DB.Execute(sql, 247)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(247)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 248
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__104(conn)
CALL DB.Execute(sql, 248)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 249
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__105(conn)
CALL DB.Execute(sql, 249)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.RebuildIndex_RefreshContents("tb_webs", "id_webs")
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 250
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__106(conn)
CALL DB.Execute(sql, 250)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 251
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__107(conn)
CALL DB.Execute(sql, 251)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 252
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__108(conn)
CALL DB.Execute(sql, 252)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 253
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__109(conn)
CALL DB.Execute(sql, 253)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 254
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__110(conn)
CALL DB.Execute(sql, 254)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 255
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__111(conn)
CALL DB.Execute(sql, 255)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 256
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__112(conn)
CALL DB.Execute(sql, 256)
'*******************************************************************************************

'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 257
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__113(conn)
CALL DB.Execute(sql, 257)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 258
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__114(DB, rs, 258)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 259
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__115(conn)
CALL DB.Execute(sql, 259)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 260
'...........................................................................................
CALL AggiornamentoSpeciale__B2B__97(DB, rs, 260)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 261
'riaggiorna la vista per dell'aggiornamento 115
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__115(conn)
CALL DB.Execute(sql, 261)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(261)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 262
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__116(conn) + _
	  Aggiornamento__FRAMEWORK_CORE__116_bis(conn)
CALL DB.Execute(sql, 262)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 263
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__117(conn)
CALL DB.Execute(sql, 263)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 264

'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__118(conn)
CALL DB.Execute(sql, 264)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 265
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__119(conn)
CALL DB.Execute(sql, 265)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 266
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__120(conn)
CALL DB.Execute(sql, 266)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 267
'...........................................................................................
CALL AggiornamentoSpeciale__FRAMEWORK_CORE__121(DB, rs, 267)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 268
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__122(conn)
CALL DB.Execute(sql, 268)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 269
'...........................................................................................
sql = Install__MEMO(conn)
CALL DB.Execute(sql, 269)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(269)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 270
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__123(conn)
CALL DB.Execute(sql, 270)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 271
'...........................................................................................
sql = Aggiornamento__B2B__98(conn)
CALL DB.Execute(sql, 271)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 272
'...........................................................................................
sql = Aggiornamento__B2B__99(conn)
CALL DB.Execute(sql, 272)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(272)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 273
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__124(conn)
CALL DB.Execute(sql, 273)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 274
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__125(conn)
CALL DB.Execute(sql, 274)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 275
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__126(conn)
CALL DB.Execute(sql, 275)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 276
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__127(conn)
CALL DB.Execute(sql, 276)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 277
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__128(conn)
CALL DB.Execute(sql, 277)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 278
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__129(conn)
CALL DB.Execute(sql, 278)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 279
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__130(conn)
CALL DB.Execute(sql, 279)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(279)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 280
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__131(conn)
CALL DB.Execute(sql, 280)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 281
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__132(conn)
CALL DB.Execute(sql, 281)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 282
'...........................................................................................
sql = Aggiornamento__B2B__108(conn)
CALL DB.Execute(sql, 282)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(282)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 283
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__133(conn)
CALL DB.Execute(sql, 283)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(283)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 284
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__134(conn)
CALL DB.Execute(sql, 284)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 285
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__135(conn)
CALL DB.Execute(sql, 285)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 286
'...........................................................................................
sql = Install__MEMO_2(conn)
CALL DB.Execute(sql, 286)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 287
'...........................................................................................
sql = Install__MEMO_3(conn)
CALL DB.Execute(sql, 287)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(287)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 288
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__136(conn)
CALL DB.Execute(sql, 288)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 289
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__137(conn)
CALL DB.Execute(sql, 289)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(289)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 290
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__138(conn)
CALL DB.Execute(sql, 290)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 291
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__139(conn)
CALL DB.Execute(sql, 291)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 292
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__140(conn)
CALL DB.Execute(sql, 292)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 293
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__141(conn)
CALL DB.Execute(sql, 293)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(293)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 294
'...........................................................................................
sql = Install__NEXTGUESTBOOK(conn)
CALL DB.Execute(sql, 294)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 295
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__142(conn)
CALL DB.Execute(sql, 295)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(295)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 296
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__143(conn)
CALL DB.Execute(sql, 296)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(296)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 297
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__144(conn)
CALL DB.Execute(sql, 297)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(297)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 298
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__145(conn)
CALL DB.Execute(sql, 298)
'*******************************************************************************************




'*******************************************************************************************
'AGGIORNAMENTO 299
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "ru")
CALL DB.Execute(sql, 299)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "ru", "russo", "Русский")
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 300
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "cn")
CALL DB.Execute(sql, 300)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "cn", "Cinese", "中文")
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(300,"v_indice")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(300,"v_indice_visibile")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(300)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 301
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "pt")
CALL DB.Execute(sql, 301)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "pt", "Portoghese", "Português")
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(301,"v_indice")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(301,"v_indice_visibile")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(301)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 302
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__148(conn)
CALL DB.Execute(sql, 302)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 303
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__149(conn)
CALL DB.Execute(sql, 303)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(303)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 304
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__150(conn)
CALL DB.Execute(sql, 304)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(304)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 305
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__151(conn)
CALL DB.Execute(sql, 305)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 306
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__152(conn)
CALL DB.Execute(sql, 306)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 307
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__153(conn)
CALL DB.Execute(sql, 307)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(307)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 308
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__154(conn)
CALL DB.Execute(sql, 308)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 309
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__155(conn)
CALL DB.Execute(sql, 309)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 310
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__156(conn)
CALL DB.Execute(sql, 310)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(310)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 311
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__157(conn)
CALL DB.Execute(sql, 311)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(311)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 312
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__158(conn)
CALL DB.Execute(sql, 312)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 313
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__159(conn)
CALL DB.Execute(sql, 313)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(313)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 314
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__160(conn)
CALL DB.Execute(sql, 314)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(314)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 315
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__161(conn)
CALL DB.Execute(sql, 315)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 316
'...........................................................................................
sql = Aggiornamento__B2B__134(conn)
CALL DB.Execute(sql, 316)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(316)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 317
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__162(conn)
CALL DB.Execute(sql, 317)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__162(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 318
'...........................................................................................
sql = Install__MEMO2(conn)
CALL DB.Execute(sql, 318)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 319
'...........................................................................................
sql = AggiornamentoSpeciale__MEMO2__1(DB, rs, 319)
CALL DB.Execute(sql, 319)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 320
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__163(conn)
CALL DB.Execute(sql, 320)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 321
' Sergio 29/09/2010 - aggiunge colonne mancanti a 
' tb_contents_index 
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__164(conn)
CALL DB.Execute(sql, 321)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(321,"v_indice")
CALL DB.SqlServer_VIEWS_REBUILD_EX(321,"v_indice_visibile")
CALL DB.SqlServer_VIEWS_REBUILD(321)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 322
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__165(conn)
CALL DB.Execute(sql, 322)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 323
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__166(conn)
CALL DB.Execute(sql, 323)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 324
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__167(conn)
CALL DB.Execute(sql, 324)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 325
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__168(conn)
CALL DB.Execute(sql, 325)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 326
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__169(conn)
CALL DB.Execute(sql, 326)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(326)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 327
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__170(conn)
CALL DB.Execute(sql, 327)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(327)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 328
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__171(conn)
CALL DB.Execute(sql, 328)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(328)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 329
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__172(conn)
CALL DB.Execute(sql, 329)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(329)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 330
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__173(conn)
CALL DB.Execute(sql, 330)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(330)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 331
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__174(conn)
CALL DB.Execute(sql, 331)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(331)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 332
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__175(conn)
CALL DB.Execute(sql, 332)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__175(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 333
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__176(conn)
CALL DB.Execute(sql, 333)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(333)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 334
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__177(conn)
CALL DB.Execute(sql, 334)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(334)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 335
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__178(conn)
CALL DB.Execute(sql, 335)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(335)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 336
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__179(conn)
CALL DB.Execute(sql, 336)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 337
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__180(conn)
CALL DB.Execute(sql, 337)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 338
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__181(conn)
CALL DB.Execute(sql, 338)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 339
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__182(conn)
CALL DB.Execute(sql, 339)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 340
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__183(conn)
CALL DB.Execute(sql, 340)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 341
'...........................................................................................
sql = Aggiornamento__MEMO2__1(conn)
CALL DB.Execute(sql, 341)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 342
'...........................................................................................
sql = Aggiornamento__MEMO2__2(conn)
CALL DB.Execute(sql, 342)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__2(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 343
'...........................................................................................
sql = Aggiornamento__MEMO2__3(conn)
CALL DB.Execute(sql, 343)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 344
'...........................................................................................
sql = Aggiornamento__MEMO2__4(conn)
CALL DB.Execute(sql, 344)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__4(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 345
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__184(conn)
CALL DB.Execute(sql, 345)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 346
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__185(conn)
CALL DB.Execute(sql, 346)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 347
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__186(conn)
CALL DB.Execute(sql, 347)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 348
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__187(conn)
CALL DB.Execute(sql, 348)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 349
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__188(conn)
CALL DB.Execute(sql, 349)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 350
'...........................................................................................
sql = Aggiornamento__MEMO2__5(conn)
CALL DB.Execute(sql, 350)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__5(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 351
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__189(conn)
CALL DB.Execute(sql, 351)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 352
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__190(conn)
CALL DB.Execute(sql, 352)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 353
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__191(conn)
CALL DB.Execute(sql, 353)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(353)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 354
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__192(conn)
CALL DB.Execute(sql, 354)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(354)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 355
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__193(conn)
CALL DB.Execute(sql, 355)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(355)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 356
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__194(conn)
CALL DB.Execute(sql, 356)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__194(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 357
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__195(conn)
CALL DB.Execute(sql, 357)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(357)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 358
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__196(conn)
CALL DB.Execute(sql, 358)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(358)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 359
'...........................................................................................
sql = Aggiornamento__MEMO2__6(conn)
CALL DB.Execute(sql, 359)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 360
'...........................................................................................
sql = Aggiornamento__MEMO2__7(conn)
CALL DB.Execute(sql, 360)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__7(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 361
'...........................................................................................
sql = Aggiornamento__MEMO2__8(conn)
CALL DB.Execute(sql, 361)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__8(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 362
'...........................................................................................
sql = Install__TRAVEL2(conn)
CALL DB.Execute(sql, 362)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 363
'...........................................................................................
sql = Aggiornamento__TRAVEL2__1(conn)
CALL DB.Execute(sql, 363)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 364
'...........................................................................................
sql = Aggiornamento__TRAVEL2__2(conn)
CALL DB.Execute(sql, 364)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 365
'...........................................................................................
sql = Aggiornamento__TRAVEL2__3(conn)
CALL DB.Execute(sql, 365)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 366
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__197(conn)
CALL DB.Execute(sql, 366)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 367
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__198(conn)
CALL DB.Execute(sql, 367)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 368
'...........................................................................................
sql = Aggiornamento__TRAVEL2__4(conn)
CALL DB.Execute(sql, 368)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 369
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__199(conn)
CALL DB.Execute(sql, 369)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 370
'...........................................................................................
sql = Aggiornamento__MEMO2__9(conn)
CALL DB.Execute(sql, 370)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 371
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__200(conn)
CALL DB.Execute(sql, 371)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 372
'...........................................................................................
sql = Aggiornamento__MEMO2__10(conn)
CALL DB.Execute(sql, 372)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 373
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__201(conn)
CALL DB.Execute(sql, 373)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 374
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "ru")
CALL DB.Execute(sql, 374)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 375
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "pt")
CALL DB.Execute(sql, 375)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 376
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "cn")
CALL DB.Execute(sql, 376)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 377
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__203(conn)
CALL DB.Execute(sql, 377)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__203(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 378
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__204(conn)
CALL DB.Execute(sql, 378)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__204(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 379
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__205(conn)
CALL DB.Execute(sql, 379)
'*******************************************************************************************

'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 380
'...........................................................................................
sql = Install__BOOKING3(conn)
CALL DB.Execute(sql, 380)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 381 (aggiorna il booking3 alla versione 37 in un colpo solo)
'...........................................................................................
dim i
for i = 1 to 37
	if i <> 33 then
		sql = Eval("Aggiornamento__BOOKING3__"&i&"(conn)")
		CALL DB.Execute(sql, 380+i)
		CALL DB.ReSyncTransaction()
	end if
next

'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(417)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 418
'...........................................................................................
sql = Aggiornamento__BOOKING3__38(conn)
CALL DB.Execute(sql, 418)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__BOOKING3__38(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 419
'...........................................................................................
sql = Aggiornamento_speciale__BOOKING3__33(conn)
CALL DB.Execute(sql, 419)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 420
'...........................................................................................
sql = Aggiornamento__BOOKING3__39(conn, "ru")
CALL DB.Execute(sql, 420)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(420)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 421
'...........................................................................................
sql = Aggiornamento__BOOKING3__39(conn, "cn")
CALL DB.Execute(sql, 421)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(421)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 422
'...........................................................................................
sql = Aggiornamento__BOOKING3__39(conn, "pt")
CALL DB.Execute(sql, 422)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(422)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 423
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__206(conn)
CALL DB.Execute(sql, 423)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(423)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 424
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__207(conn)
CALL DB.Execute(sql, 424)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(424)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 425
'...........................................................................................
sql = Aggiornamento__GUESTBOOK__2(conn)
CALL DB.Execute(sql, 425)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 426
'...........................................................................................
sql = Aggiornamento__GUESTBOOK__3(conn)
CALL DB.Execute(sql, 426)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__GUESTBOOK__3(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 427
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__208(conn)
CALL DB.Execute(sql, 427)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 428
'...........................................................................................
sql = Aggiornamento__MEMO2__11(conn)
CALL DB.Execute(sql, 428)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 429
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__209(conn)
CALL DB.Execute(sql, 429)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__209(conn)
end if
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(429)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 430
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__210(conn)
CALL DB.Execute(sql, 430)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 431
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__211(conn)
CALL DB.Execute(sql, 431)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(431)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 432
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__212(conn)
CALL DB.Execute(sql, 432)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 433
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__213(conn)
CALL DB.Execute(sql, 433)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 434
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__214(conn)
CALL DB.ProtectedExecuteRebuild(sql, 434, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 435
'...........................................................................................
sql = Aggiornamento__BOOKING3__40(conn)
CALL DB.ProtectedExecuteRebuild(sql, 435, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 436
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__215(conn)
CALL DB.ProtectedExecuteRebuild(sql, 436, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 437
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__216(conn)
CALL DB.ProtectedExecuteRebuild(sql, 437, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 438
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__217(conn)
CALL DB.Execute(sql, 438)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__217(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 439
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__218(conn)
CALL DB.ProtectedExecuteRebuild(sql, 439, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 440
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__219(conn)
CALL DB.ProtectedExecuteRebuild(sql, 440, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 441
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__220(conn)
CALL DB.ProtectedExecuteRebuild(sql, 441, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 442
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__221(conn)
CALL DB.ProtectedExecuteRebuild(sql, 442, false, true)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__221(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 443
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__222(conn)
CALL DB.Execute(sql, 443)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__222(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 444
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 444, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 445
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__224(conn)
CALL DB.Execute(sql, 445)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__224(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 446
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 446, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 447
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 447, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 448
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 448, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 449
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__228(conn)
CALL DB.ProtectedExecuteRebuild(sql, 449, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 450
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__229(conn)
CALL DB.ProtectedExecuteRebuild(sql, 450, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 451
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__230(conn)
CALL DB.Execute(sql, 451)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__230(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 452
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__231(conn)
CALL DB.ProtectedExecuteRebuild(sql, 452, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 453
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__232(conn)
CALL DB.ProtectedExecuteRebuild(sql, 453, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 454
'...........................................................................................
sql = Aggiornamento__MEMO2__12(conn)
CALL DB.Execute(sql, 454)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 455
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__233(conn)
CALL DB.ProtectedExecuteRebuild(sql, 455, false, false)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 456
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__234(conn)
CALL DB.ProtectedExecuteRebuild(sql, 456, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 457
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__235(conn)
CALL DB.ProtectedExecuteRebuild(sql, 457, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 458
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__236(conn)
CALL DB.ProtectedExecuteRebuild(sql, 458, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 459
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__237(conn)
CALL DB.ProtectedExecuteRebuild(sql, 459, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 460
'...........................................................................................
sql = Aggiornamento__MEMO2__13(conn)
CALL DB.Execute(sql, 460)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 461
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__238(conn)
CALL DB.ProtectedExecuteRebuild(sql, 461, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 462
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__239(conn)
CALL DB.ProtectedExecuteRebuild(sql, 462, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 463
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__240(conn)
CALL DB.ProtectedExecuteRebuild(sql, 463, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 464
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__241(conn)
CALL DB.ProtectedExecuteRebuild(sql, 464, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 465
'...........................................................................................
sql = Aggiornamento__MEMO2__14(conn)
CALL DB.Execute(sql, 465)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 466
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__242(conn)
CALL DB.ProtectedExecuteRebuild(sql, 466, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 467
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__243(conn)
CALL DB.ProtectedExecuteRebuild(sql, 467, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 468
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__244(conn)
CALL DB.ProtectedExecuteRebuild(sql, 468, false, true)
'*******************************************************************************************


%>
<% '........................................................................................... %>
<!--#INCLUDE FILE="Update__FileFooter.asp" -->
<% '........................................................................................... %>