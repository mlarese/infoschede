<!--#INCLUDE FILE="Update__FileHeader.asp" -->
<% '........................................................................................... 
%>
<!--#INCLUDE FILE="../Tools.asp" -->
<!--#INCLUDE FILE="../Tools4Admin.asp" -->
<!--#INCLUDE FILE="../ToolsDescrittori.asp" -->
<!--#INCLUDE FILE="../Categorie/ClassCategorie.asp" -->
<!--#INCLUDE FILE="../IndexContent/Tools_IndexContent.asp" -->
<% Server.ScriptTimeout=2000000 %>
<%
'...........................................................................................
set index.conn = conn
'...........................................................................................

'*******************************************************************************************
'AGGIORNAMENTO 1
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__127(conn)
CALL DB.Execute(sql, 1)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 2
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__128(conn)
CALL DB.Execute(sql, 2)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 3
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__129(conn)
CALL DB.Execute(sql, 3)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 4
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__130(conn)
CALL DB.Execute(sql, 4)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(4)
'****************************************/***************************************************

'*******************************************************************************************
'AGGIORNAMENTO 5
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__131(conn)
CALL DB.Execute(sql, 5)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 6
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__132(conn)
CALL DB.Execute(sql, 6)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 7
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__133(conn)
CALL DB.Execute(sql, 7)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(7)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 8
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__134(conn)
CALL DB.Execute(sql, 8)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 9
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__135(conn)
CALL DB.Execute(sql, 9)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 10
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__136(conn)
CALL DB.Execute(sql, 10)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 11
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__137(conn)
CALL DB.Execute(sql, 11)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(11)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 12
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__138(conn)
CALL DB.Execute(sql, 12)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 13
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__139(conn)
CALL DB.Execute(sql, 13)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 14
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__140(conn)
CALL DB.Execute(sql, 14)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 15
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__141(conn)
CALL DB.Execute(sql, 15)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(15)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 16
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__142(conn)
CALL DB.Execute(sql, 16)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(16)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 17
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__143(conn)
CALL DB.Execute(sql, 17)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(17)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 18
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__144(conn)
CALL DB.Execute(sql, 18)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(18)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 19
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__145(conn)
CALL DB.Execute(sql, 19)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 20
'...........................................................................................
sql = " CREATE TABLE dbo.tb_storico_pages ( " + _
				"	sp_ID int IDENTITY (1, 1) NOT NULL , " + _
				"	sp_sw_id int NOT NULL, " + _
				"	sp_page_id int NOT NULL , " + _
				"	sp_pagineSito_id int NOT NULL , " + _
				"	sp_nomepage nvarchar (250) NOT NULL , " + _
				"	sp_lingua nvarchar (2) NOT NULL , " + _
				"	sp_contatore int NOT NULL , " + _
				"	sp_contUtenti int NOT NULL , " + _
				"	sp_contCrawler int NOT NULL , " + _
				"	sp_contAltro int NOT NULL " + _
				" ); " + _
				" CREATE TABLE dbo.tb_storico_webs ( " + _
				"	sw_ID int IDENTITY (1, 1) NOT NULL , " + _
				"	sw_webs_id int NOT NULL , " + _
				"	sw_data smalldatetime NOT NULL , " + _
				"	sw_contatore int NOT NULL , " + _
				"	sw_contUtenti int NOT NULL , " + _
				"	sw_contCrawler int NOT NULL , " + _
				"	sw_contAltro int NOT NULL , " + _
				"	sw_ins_data smalldatetime NOT NULL , " + _
				"	sw_ins_admin_id smalldatetime NOT NULL " + _
				" ); " +_
				" ALTER TABLE tb_storico_pages ADD CONSTRAINT PK_tb_storico_pages PRIMARY KEY CLUSTERED (sp_ID); " + _
				" ALTER TABLE tb_storico_webs ADD CONSTRAINT PK_tb_storico_webs PRIMARY KEY CLUSTERED (sw_ID); " + _
				" ALTER TABLE tb_storico_pages ADD CONSTRAINT FK_tb_storico_pages_tb_storico_webs " + _
				"	FOREIGN KEY (sp_sw_id) REFERENCES tb_storico_webs (sw_ID) " + _
				"	ON DELETE CASCADE  ON UPDATE CASCADE ; " + _
				" ALTER TABLE tb_storico_webs ADD CONSTRAINT FK_tb_storico_webs_tb_webs " + _
				"	FOREIGN KEY (sw_webs_id) REFERENCES tb_webs (id_webs) " + _
				"	ON DELETE CASCADE  ON UPDATE CASCADE ; "
		
CALL DB.Execute(sql, 20)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 21
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__62(conn)
CALL DB.Execute(sql, 21)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 22
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__64(conn)
CALL DB.Execute(sql, 22)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 23
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "ru")
CALL DB.Execute(sql, 23)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "ru", "russo", "Русский")
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 24
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "cn")
CALL DB.Execute(sql, 24)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "cn", "Cinese", "中文")
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(24)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 25
'...........................................................................................
sql = Install__Questionario(conn)
CALL DB.Execute(sql, 25)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 26
'...........................................................................................
sql = Aggiornamento__Questionario__1(conn)
CALL DB.Execute(sql, 26)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 27
'...........................................................................................
sql = Aggiornamento__Questionario__2(conn)
CALL DB.Execute(sql, 27)
'*******************************************************************************************



'*******************************************************************************************
'*******************************************************************************************
'AGGIORNAMENTO 28
'...........................................................................................
sql = " CREATE TABLE dbo.tb_iat ( " + _
	  "		iat_id " & SQL_PrimaryKeyInt(conn, "tb_iat") + ", " + _
	  "		iat_nome " + SQL_CharField(Conn, 25) + ", " + _
	  "		iat_saldo_cassa money NULL, " + _
	  "		iat_fondo_cassa money NULL); " + _
	  " CREATE TABLE dbo.rel_iat_admin ( " + _
	  "		rel_id " & SQL_PrimaryKeyInt(conn, "rel_iat_admin") + ", " + _
	  "		rel_iat_id INT NULL, " + _
	  "		rel_admin_id INT NULL); " + _
	  SQL_AddForeignKey(conn, "rel_iat_admin", "rel_iat_id", "tb_iat", "iat_id", true, "") + _
	  SQL_AddForeignKey(conn, "rel_iat_admin", "rel_admin_id", "tb_admin", "id_admin", true, "")

CALL DB.Execute(sql, 28)
'*******************************************************************************************


'*******************************************************************************************
'*******************************************************************************************
'AGGIORNAMENTO 29
'...........................................................................................
sql = " ALTER TABLE qtb_compilazioni " + _
	  "	ADD	comp_iat_id INT NULL; " + _
	  SQL_AddForeignKey(conn, "qtb_compilazioni", "comp_iat_id", "tb_iat", "iat_id", false, "") + _
	  " CREATE TABLE dbo.rel_iat_questionari ( " + _
	  "		riq_id " & SQL_PrimaryKey(conn, "rel_iat_questionari") + ", " + _
	  "		riq_iat_id INT NULL, " + _
	  "		riq_questionario_id INT NULL); " + _
	  SQL_AddForeignKey(conn, "rel_iat_questionari", "riq_iat_id", "tb_iat", "iat_id", true, "") + _
	  SQL_AddForeignKey(conn, "rel_iat_questionari", "riq_questionario_id", "qtb_questionari", "quest_id", true, "")

CALL DB.Execute(sql, 29)
'*******************************************************************************************
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 30
'...........................................................................................
sql = Aggiornamento__Questionario__3(conn)
CALL DB.Execute(sql, 30)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 31
'...........................................................................................
sql = Aggiornamento__Questionario__4(conn)
CALL DB.Execute(sql, 31)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 32
'...........................................................................................
sql = Aggiornamento__Questionario__5(conn)
CALL DB.Execute(sql, 32)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 33
'...........................................................................................
sql = Aggiornamento__Questionario__6(conn)
CALL DB.Execute(sql, 33)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 34
'...........................................................................................
sql = Aggiornamento__Questionario__7(conn)
CALL DB.Execute(sql, 34)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(33)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 35
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "pt")
CALL DB.Execute(sql, 35)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "pt", "Portoghese", "Português")
end if
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(35)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 36
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__148(conn)
CALL DB.Execute(sql, 36)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 37
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__149(conn)
CALL DB.Execute(sql, 37)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(37)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 38
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__150(conn)
CALL DB.Execute(sql, 38)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(38)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 39
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__151(conn)
CALL DB.Execute(sql, 39)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 40
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__152(conn)
CALL DB.Execute(sql, 40)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 41
'...........................................................................................
'aggiungi colonna per la gestione degli ambiti la tabella ambiti
'...........................................................................................
sql = " CREATE TABLE dbo.tb_ambiti_territoriali ( " + _
	  "		ambito_id " & SQL_PrimaryKey(conn, "tb_ambiti_territoriali") + ", " + _
	  "		ambito_nome " + SQL_CharField(Conn, 250) + ", " + _
	  "     ambito_note " + SQL_CharField(Conn, 0) +" NULL); " + _ 
	  " ALTER TABLE dbo.tb_iat " + _
	  "		ADD	iat_ambito_id INT NOT NULL DEFAULT 0; " + _
	  SQL_AddForeignKey(conn, "tb_iat", "iat_ambito_id", "tb_ambiti_territoriali", "ambito_id", false, "") + _
	  " INSERT INTO dbo.tb_ambiti_territoriali (ambito_nome,ambito_note) VALUES ('Treviso','');"
	  '	response.write sql
CALL DB.Execute(sql, 41)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 42 standard e rimozione di tutte le stored procedure ed oggetti non più usati
'...........................................................................................
sql = " DROP FUNCTION dbo.fn_records_strutture ; " + _
      " DROP FUNCTION dbo.fn_valid_strutture ; " + _
      " DROP FUNCTION dbo.fn_calcola_totale_camere ; " + _
      " DROP FUNCTION dbo.fn_calcola_totale_bagni ; " + _
      " DROP FUNCTION dbo.fn_calcola_totale_esercizi ; " + _
      " DROP FUNCTION dbo.fn_calcola_totale_posti_letto ; " + _
      " DROP FUNCTION dbo.fn_indice_nome_completo ; " + _
      " DROP FUNCTION dbo.fn_NEW_REGCODE ; " + _
      " DROP PROCEDURE dbo.CancellaDotazione ; " + _
      " DROP PROCEDURE dbo.CancellaGruppo ; " + _
      " DROP PROCEDURE dbo.CancellaServizio ; " + _
      " DROP PROCEDURE dbo.Delete_Modulo ; " + _
      " DROP PROCEDURE dbo.Delete_Promozioni ; " + _
      " DROP PROCEDURE dbo.DELETE_Record_Struttura ; " + _
      " DROP PROCEDURE dbo.DELETE_rel_grp_dotaz ; " + _
      " DROP PROCEDURE dbo.DELETE_rel_grp_serv ; " + _
      " DROP PROCEDURE dbo.DELETE_Struttura ; " + _
      " DROP PROCEDURE dbo.DELETE_Tipologia ; " + _
      " DROP PROCEDURE dbo.spDELETE_ZoneUrbane_STR ; " + _
      " DROP PROCEDURE dbo.spDuplicaStruttura ; " + _
      " DROP PROCEDURE dbo.spInsertDotazioneVAL ; " + _
      " DROP PROCEDURE dbo.spInsertServizio ; " + _
      " DROP PROCEDURE dbo.spInsertZonaUrbana ; " + _
      " DROP PROCEDURE dbo.spNuovaStruttura ; " + _
      " DROP PROCEDURE dbo.spstr_ATTIVITA_PROPRIETARIO ; " + _
      " DROP PROCEDURE dbo.spstr_AUTOCALC_ENDOWMENT ; " + _
      " DROP PROCEDURE dbo.spstr_CHECK_AND_DUPLICATE ; " + _
      " DROP PROCEDURE dbo.spstr_CHECK_AND_DUPLICATE_4_ONLINE ; " + _
      " DROP PROCEDURE dbo.spstr_CHECK_AND_DUPLICATE_IF_CHANGED ; " + _
      " DROP PROCEDURE dbo.spstr_CHECK_MOD_CHANGES ; " + _
      " DROP PROCEDURE dbo.spstr_DELETE_STRUTTURE ; " + _
      " DROP PROCEDURE dbo.spstr_DELETE_STRUTTURE_MODELLO ; " + _
      " DROP PROCEDURE dbo.spstr_DICHIARAZIONE_ANNULLA ; " + _
      " DROP PROCEDURE dbo.spstr_DICHIARAZIONE_AVVISA ; " + _
      " DROP PROCEDURE dbo.spstr_DICHIARAZIONE_COMPLETA ; " + _
      " DROP PROCEDURE dbo.spstr_DICHIARAZIONE_PRESENTA ; " + _
      " DROP PROCEDURE dbo.spstr_DICHIARAZIONE_RITIRA ; " + _
      " DROP PROCEDURE dbo.spstr_DUPLICATE ; " + _
      " DROP PROCEDURE dbo.spstr_DUPLICATE_AND_CLEAR ; " + _
      " DROP PROCEDURE dbo.spstr_INSERT_NEW ; " + _
      " DROP PROCEDURE dbo.spstr_REPLACE_REGCODE ; " + _
      " DROP PROCEDURE dbo.spstr_SET_APT_LIST ; " + _
      " DROP PROCEDURE dbo.spstr_UPDATE_tb_loginstru ; " + _
      " DROP PROCEDURE dbo.spstr_VALIDA_RECORD ; " + _
      " DROP PROCEDURE dbo.spstr_WRITE_LOG ; " + _
      " DROP PROCEDURE dbo.spws_AreeIncluse ; " + _
      " DROP PROCEDURE dbo.spws_CategorieEventiInclusi ; " + _
      " DROP PROCEDURE dbo.spws_CategorieIncluse ; " + _
	  Aggiornamento__FRAMEWORK_CORE__153(conn)
CALL DB.Execute(sql, 42)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(42)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 43
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__154(conn)
CALL DB.Execute(sql, 43)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 44
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__155(conn)
CALL DB.Execute(sql, 44)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 45
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__156(conn)
CALL DB.Execute(sql, 45)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(45)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 46
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__157(conn)
CALL DB.Execute(sql, 46)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(46)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 47
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__158(conn)
CALL DB.Execute(sql, 47)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 48
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__159(conn)
CALL DB.Execute(sql, 48)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(48)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 49
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__160(conn)
CALL DB.Execute(sql, 49)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(49)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 50
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__161(conn)
CALL DB.Execute(sql, 50)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 51
'...........................................................................................
sql = Aggiornamento__Questionario__8(conn)
CALL DB.Execute(sql, 51)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 52
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__162(conn)
CALL DB.Execute(sql, 52)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__162(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 53
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__163(conn)
CALL DB.Execute(sql, 53)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 54
' Sergio 29/09/2010 - aggiunge colonne mancanti a 
' tb_contents_index 
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__164(conn)
CALL DB.Execute(sql, 54)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(54,"v_indice")
CALL DB.SqlServer_VIEWS_REBUILD_EX(54,"v_indice_visibile")
CALL DB.SqlServer_VIEWS_REBUILD(54)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 55
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__165(conn)
CALL DB.Execute(sql, 55)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 56
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__166(conn)
CALL DB.Execute(sql, 56)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 57
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__167(conn)
CALL DB.Execute(sql, 57)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 58
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__168(conn)
CALL DB.Execute(sql, 58)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 59
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__169(conn)
CALL DB.Execute(sql, 59)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(59)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 60
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__170(conn)
CALL DB.Execute(sql, 60)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(60)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 61
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__171(conn)
CALL DB.Execute(sql, 61)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(61)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 62
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__172(conn)
CALL DB.Execute(sql, 62)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(62)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 63
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__173(conn)
CALL DB.Execute(sql, 63)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(63)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 64
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__174(conn)
CALL DB.Execute(sql, 64)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(64)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 65
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__175(conn)
CALL DB.Execute(sql, 65)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__175(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 66
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__176(conn)
CALL DB.Execute(sql, 66)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(66)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 67
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__177(conn)
CALL DB.Execute(sql, 67)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(67)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 68
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__178(conn)
CALL DB.Execute(sql, 68)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(68)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 69
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__179(conn)
CALL DB.Execute(sql, 69)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 70
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__180(conn)
CALL DB.Execute(sql, 70)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 71
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__181(conn)
CALL DB.Execute(sql, 71)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 72
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__182(conn)
CALL DB.Execute(sql, 72)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 73
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__183(conn)
CALL DB.Execute(sql, 73)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 74
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__184(conn)
CALL DB.Execute(sql, 74)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 75
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__185(conn)
CALL DB.Execute(sql, 75)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 76
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__186(conn)
CALL DB.Execute(sql, 76)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 77
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__187(conn)
CALL DB.Execute(sql, 77)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 78
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__188(conn)
CALL DB.Execute(sql, 78)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 79
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__189(conn)
CALL DB.Execute(sql, 79)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 80
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__190(conn)
CALL DB.Execute(sql, 80)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 81
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__191(conn)
CALL DB.Execute(sql, 81)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(81)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 82
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__192(conn)
CALL DB.Execute(sql, 82)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(82)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 83
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__193(conn)
CALL DB.Execute(sql, 83)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(83)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 84
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__194(conn)
CALL DB.Execute(sql, 84)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__194(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 85
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__195(conn)
CALL DB.Execute(sql, 85)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(85)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 86
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__196(conn)
CALL DB.Execute(sql, 86)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(86)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 87
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__197(conn)
CALL DB.Execute(sql, 87)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 88
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__198(conn)
CALL DB.Execute(sql, 88)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 89
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__199(conn)
CALL DB.Execute(sql, 89)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 90
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__200(conn)
CALL DB.Execute(sql, 90)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 91
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__201(conn)
CALL DB.Execute(sql, 91)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 92
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "ru")
CALL DB.Execute(sql, 92)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 93
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "pt")
CALL DB.Execute(sql, 93)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 94
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "cn")
CALL DB.Execute(sql, 94)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 95
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__203(conn)
CALL DB.Execute(sql, 95)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__203(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 96
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__204(conn)
CALL DB.Execute(sql, 96)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__204(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 97
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__205(conn)
CALL DB.Execute(sql, 97)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 98
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__206(conn)
CALL DB.Execute(sql, 98)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(98)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 99
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__207(conn)
CALL DB.Execute(sql, 99)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(99)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 100
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__208(conn)
CALL DB.Execute(sql, 100)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 101
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__209(conn)
CALL DB.Execute(sql, 101)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__209(conn)
end if
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(101)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 102
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__210(conn)
CALL DB.Execute(sql, 102)
'*******************************************************************************************
'*******************************************************************************************
'AGGIORNAMENTO 103
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__211(conn)
CALL DB.Execute(sql, 103)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(103)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 104
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__212(conn)
CALL DB.Execute(sql, 104)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 105
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__213(conn)
CALL DB.Execute(sql, 105)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 106
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__214(conn)
CALL DB.ProtectedExecuteRebuild(sql, 106, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 107
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__215(conn)
CALL DB.ProtectedExecuteRebuild(sql, 107, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 108
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__216(conn)
CALL DB.ProtectedExecuteRebuild(sql, 108, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 109
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__217(conn)
CALL DB.Execute(sql, 109)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__217(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 110
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__218(conn)
CALL DB.ProtectedExecuteRebuild(sql, 110, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 111
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__219(conn)
CALL DB.ProtectedExecuteRebuild(sql, 111, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 112
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__220(conn)
CALL DB.ProtectedExecuteRebuild(sql, 112, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 113
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__221(conn)
CALL DB.ProtectedExecuteRebuild(sql, 113, false, true)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__221(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 114
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__222(conn)
CALL DB.Execute(sql, 114)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__222(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 115
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 115, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 116
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__224(conn)
CALL DB.Execute(sql, 116)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__224(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 117
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 117, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 118
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 118, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 119
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 119, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 120
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__228(conn)
CALL DB.ProtectedExecuteRebuild(sql, 120, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 121
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__229(conn)
CALL DB.ProtectedExecuteRebuild(sql, 121, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 122
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__230(conn)
CALL DB.Execute(sql, 122)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__230(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 123
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__231(conn)
CALL DB.ProtectedExecuteRebuild(sql, 123, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 124
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__232(conn)
CALL DB.ProtectedExecuteRebuild(sql, 124, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 125
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__233(conn)
CALL DB.ProtectedExecuteRebuild(sql, 125, false, false)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 126
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__234(conn)
CALL DB.ProtectedExecuteRebuild(sql, 126, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 127
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__235(conn)
CALL DB.ProtectedExecuteRebuild(sql, 127, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 127
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__236(conn)
CALL DB.ProtectedExecuteRebuild(sql, 127, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 128
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__237(conn)
CALL DB.ProtectedExecuteRebuild(sql, 128, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 129
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__238(conn)
CALL DB.ProtectedExecuteRebuild(sql, 129, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 130
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__239(conn)
CALL DB.ProtectedExecuteRebuild(sql, 130, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 131
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__240(conn)
CALL DB.ProtectedExecuteRebuild(sql, 131, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 132
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__241(conn)
CALL DB.ProtectedExecuteRebuild(sql, 132, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 133
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__242(conn)
CALL DB.ProtectedExecuteRebuild(sql, 133, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 134
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__243(conn)
CALL DB.ProtectedExecuteRebuild(sql, 134, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 135
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__244(conn)
CALL DB.ProtectedExecuteRebuild(sql, 135, false, true)
'*******************************************************************************************



%>
<% '........................................................................................... %>
<!--#INCLUDE FILE="Update__FileFooter.asp" -->
<% '........................................................................................... %>