<!--#INCLUDE FILE="Update__FileHeader.asp" -->
<% '........................................................................................... %>
<!--#INCLUDE FILE="../Tools.asp" -->
<!--#INCLUDE FILE="../Tools4Admin.asp" -->
<!--#INCLUDE FILE="../ToolsDescrittori.asp" -->
<!--#INCLUDE FILE="../Categorie/ClassCategorie.asp" -->
<!--#INCLUDE FILE="../IndexContent/Tools_IndexContent.asp" -->
<%
'...........................................................................................
set index.conn = conn
'...........................................................................................


'*******************************************************************************************
'AGGIORNAMENTI DAL N. 1 al 313 derivati direttamente da b2bmuranoathome
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 314
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__144(conn)
CALL DB.Execute(sql, 314)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(314)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 315
'...........................................................................................
sql = Aggiornamento__B2B__122(conn)
CALL DB.Execute(sql, 315)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(315)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 316
'...........................................................................................
sql = Aggiornamento__B2B__123(conn)
CALL DB.Execute(sql, 316)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 317
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__145(conn)
CALL DB.Execute(sql, 317)
'*******************************************************************************************




'*******************************************************************************************
'AGGIORNAMENTO 318
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "ru")
CALL DB.Execute(sql, 318)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "ru", "russo", "Русский")
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 319
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "cn")
CALL DB.Execute(sql, 319)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "cn", "Cinese", "中文")
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(319)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 320
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "pt")
CALL DB.Execute(sql, 320)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "pt", "Portoghese", "Português")
end if
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(320)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 321
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__148(conn)
CALL DB.Execute(sql, 321)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 322
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__149(conn)
CALL DB.Execute(sql, 322)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(322)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 323
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__150(conn)
CALL DB.Execute(sql, 323)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(323)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 324
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__151(conn)
CALL DB.Execute(sql, 324)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 325
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__152(conn)
CALL DB.Execute(sql, 325)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 326
'...........................................................................................
sql = Aggiornamento__B2B__124(conn)
CALL DB.Execute(sql, 326)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(326)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 327
'...........................................................................................
sql = Aggiornamento__B2B__125(conn)
CALL DB.Execute(sql, 327)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(327)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 328
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__153(conn)
CALL DB.Execute(sql, 328)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(328)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 329
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__154(conn)
CALL DB.Execute(sql, 329)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 330
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__155(conn)
CALL DB.Execute(sql, 330)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 331
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__156(conn)
CALL DB.Execute(sql, 331)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(331)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 332
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__157(conn)
CALL DB.Execute(sql, 332)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(332)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 333
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__158(conn)
CALL DB.Execute(sql, 333)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 334
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__159(conn)
CALL DB.Execute(sql, 334)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(334)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 335
'...........................................................................................
sql = Aggiornamento__B2B__126(conn)
CALL DB.Execute(sql, 335)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(335)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 336
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__160(conn)
CALL DB.Execute(sql, 336)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(336)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 337
'...........................................................................................
sql = Install__NEXTINFO(conn)
CALL DB.Execute(sql, 337)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 338
'...........................................................................................
sql = Activate_NEXTINFO(conn)
CALL DB.Execute(sql, 338)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 339-360 (aggiorna il next-info alla versione 21 in un colpo solo)
'...........................................................................................
dim i
for i = 339 to 359
	if i-338 = 4 then
		sql = Eval("AggiornamentoSpeciale__INFO__"&(i-338)&"(DB, rs, i)")
	else
		sql = Eval("Aggiornamento__INFO__"&(i-338)&"(conn)")
	end if
	CALL DB.Execute(sql, i)
	CALL DB.ReSyncTransaction()
next
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(359)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 360
'...........................................................................................
sql = Aggiornamento__B2B__127(conn)
CALL DB.Execute(sql, 360)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 361
'...........................................................................................
sql = Aggiornamento__B2B__128(conn)
CALL DB.Execute(sql, 361)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 362
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__161(conn)
CALL DB.Execute(sql, 362)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 363
'...........................................................................................
sql = Aggiornamento__B2B__129(conn)
CALL DB.Execute(sql, 363)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 364
'...........................................................................................
sql = Aggiornamento__B2B__130(conn)
CALL DB.Execute(sql, 364)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 365
'...........................................................................................
sql = Aggiornamento__B2B__131(conn)
CALL DB.Execute(sql, 365)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 366
'...........................................................................................
sql = Aggiornamento__B2B__132(conn)
CALL DB.Execute(sql, 366)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 367
'...........................................................................................
sql = Aggiornamento__B2B__133(conn)
CALL DB.Execute(sql, 367)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(367)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 368
'...........................................................................................
sql = Aggiornamento__B2B__134(conn)
CALL DB.Execute(sql, 368)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(368)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 369
'...........................................................................................
sql = Aggiornamento__B2B__135(conn)
CALL DB.Execute(sql, 369)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 370
'...........................................................................................
sql = Aggiornamento__B2B__136(conn)
CALL DB.Execute(sql, 370)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(370)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 371
'...........................................................................................
sql = Aggiornamento__B2B__137(conn)
CALL DB.Execute(sql, 371)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 372
'...........................................................................................
sql = Aggiornamento__B2B__138(conn)
CALL DB.Execute(sql, 372)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 373
'...........................................................................................
sql = Aggiornamento__B2B__139(conn)
CALL DB.Execute(sql, 373)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(373)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 374
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__162(conn)
CALL DB.Execute(sql, 374)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__162(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 375
'...........................................................................................
sql = Aggiornamento__B2B__140(conn)
CALL DB.Execute(sql, 375)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(375)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 376
'...........................................................................................
sql = Aggiornamento__B2B__141(conn)
CALL DB.Execute(sql, 376)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 377
'...........................................................................................
sql = Install__MEMO2(conn)
CALL DB.Execute(sql, 377)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 378
'...........................................................................................
sql = AggiornamentoSpeciale__MEMO2__1(DB, rs, 378)
CALL DB.Execute(sql, 378)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(378)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 379
'...........................................................................................
sql = Aggiornamento_B2B__142(conn)
CALL DB.Execute(sql, 379)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_B2B__142(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 380
'...........................................................................................
sql = Aggiornamento__B2B__143(conn)
CALL DB.Execute(sql, 380)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 381
'...........................................................................................
sql = Aggiornamento__B2B__144(conn)
CALL DB.Execute(sql, 381)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 382
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__163(conn)
CALL DB.Execute(sql, 382)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 383
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__165(conn)
CALL DB.Execute(sql, 383)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 384
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__164(conn)
CALL DB.Execute(sql, 384)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 385
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__166(conn)
CALL DB.Execute(sql, 385)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 386
'...........................................................................................
sql = Aggiornamento__B2B__145(conn)
CALL DB.Execute(sql, 386)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 387
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__167(conn)
CALL DB.Execute(sql, 387)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 388
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__168(conn)
CALL DB.Execute(sql, 388)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 389
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__169(conn)
CALL DB.Execute(sql, 389)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(389)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 390
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__170(conn)
CALL DB.Execute(sql, 390)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(390)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 391
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__171(conn)
CALL DB.Execute(sql, 391)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(391)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 392
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__172(conn)
CALL DB.Execute(sql, 392)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(392)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 393
'...........................................................................................
sql = Aggiornamento__B2B__146(conn)
CALL DB.Execute(sql, 393)
'*******************************************************************************************


'**********************************************************************************************************
'**********************************************************************************************************
'**********************************************************************************************************
'AGGIORNAMENTO 394
'Giacomo
'...........................................................................................
' serie di query per il "restauro" articoli di IDEAL-LUX
'...........................................................................................

'inserisco le famiglie (categorie del B2B) nelle marche
sql = " INSERT INTO gtb_marche(mar_nome_it,mar_logo,mar_codice) " + vbCrLf + _
	  " SELECT tip_nome_it, tip_logo, tip_codice " + vbCrLf + _
	  " FROM gtb_tipologie " + vbCrLf + _
	  " WHERE (tip_foglia = 1) "

'imposto la corrispondente marca (ex categoria) ad ogni articolo
sql = sql & _	  
	  " UPDATE gtb_articoli SET art_marca_id = mar_id " + vbCrLf + _
	  " FROM gtb_marche  " + vbCrLf + _
	  " WHERE gtb_marche.mar_nome_it = (SELECT tip_nome_it FROM gtb_tipologie WHERE tip_id = gtb_articoli.art_tipologia_id) "

'cancello la marca generica
sql = sql & _
	  " DELETE FROM gtb_marche WHERE mar_nome_it LIKE 'Generico' "

'inserisco le nuove categorie
sql = sql & _
	  " SET IDENTITY_INSERT dbo.gtb_tipologie ON " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1231,'Lampade a sospensione','Hanging lamps','Lampes suspendues','Pendelleuchten',1,0,10,'010-',1231,1,1,'1231') " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1232,'Lampade da terra','Floor lamps','Lampes de plancher','Stehlampen',1,0,20,'020-',1232,1,1,'1232') " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1233,'Lampade da tavolo','Table lamps','Lampes de table','Tischlampen',1,0,30,'030-',1233,1,1,'1233') " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1234,'Lampade da soffitto','Celing lamps','Lampes à plafond','Deckenlampen',1,0,40,'040-',1234,1,1,'1234') " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1235,'Lampade da parete','Wall lamps','Lampes murals','Wandlampen',1,0,50,'050-',1235,1,1,'1235') " + vbCrLf + _
	  " INSERT INTO gtb_tipologie(tip_id,tip_nome_it,tip_nome_en,tip_nome_fr,tip_nome_de,tip_foglia,tip_livello,tip_ordine,tip_ordine_assoluto,tip_tipologia_padre_base,tip_visibile,tip_albero_visibile,tip_tipologie_padre_lista)  " + vbCrLf + _
	  " 		VALUES (1236,'Lampade da esterno','Outdoor Lamps','Lampes extérieures','Außenlampen',1,0,60,'060-',1236,1,1,'1236') " + vbCrLf + _
	  " SET IDENTITY_INSERT dbo.gtb_tipologie OFF "
	  
'associo tutti i descrittori alle nuove categorie appena inserite
sql = sql & _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1231' AS TIPOLOGIA FROM gtb_carattech " + vbCrLf + _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1232' AS TIPOLOGIA FROM gtb_carattech " + vbCrLf + _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1233' AS TIPOLOGIA FROM gtb_carattech " + vbCrLf + _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1234' AS TIPOLOGIA FROM gtb_carattech " + vbCrLf + _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1235' AS TIPOLOGIA FROM gtb_carattech " + vbCrLf + _
	  " INSERT INTO gtb_tip_ctech(rct_ctech_id,rct_ordine,rct_tipologia_id) " + vbCrLf + _
	  " 	SELECT ct_id,(0) AS ORDINE, '1236' AS TIPOLOGIA FROM gtb_carattech "

'assegno agli articoli le nuove categorie  
sql = sql & _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1231 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id NOT IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984))) AND (gtb_carattech.ct_id IN (121)) " + vbCrLf + _
	  "  " + vbCrLf + _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1234 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id NOT IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984))) AND (gtb_carattech.ct_id IN (138)) " + vbCrLf + _
	  "  " + vbCrLf + _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1232 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id NOT IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984))) AND (gtb_carattech.ct_id IN (122)) " + vbCrLf + _
	  "  " + vbCrLf + _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1235 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id NOT IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984))) AND (gtb_carattech.ct_id IN (123)) " + vbCrLf + _
	  "  " + vbCrLf + _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1233 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id NOT IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984))) AND (gtb_carattech.ct_id IN (124)) " + vbCrLf + _
	  "  " + vbCrLf + _
	  " UPDATE gtb_articoli SET art_tipologia_id = 1236 " + vbCrLf + _
	  " FROM gtb_articoli INNER JOIN grel_art_ctech  " + vbCrLf + _
	  " ON gtb_articoli.art_id = grel_art_ctech.rel_art_id INNER JOIN " + vbCrLf + _
	  " gtb_carattech ON grel_art_ctech.rel_ctech_id = gtb_carattech.ct_id " + vbCrLf + _
	  " WHERE (gtb_articoli.art_tipologia_id IN " + vbCrLf + _
	  " (SELECT tip_id FROM gtb_tipologie WHERE (tip_tipologia_padre_base = 984)))"
CALL DB.Execute(sql, 394)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 395
' Aggiornamento dell'indice per rendere effetive le modifiche appena fatte
'...........................................................................................
sql = "SELECT * FROM AA_Versione "
CALL DB.Execute(sql, 395)
if DB.last_update_executed then
	sql = "SELECT tip_id FROM gtb_tipologie WHERE tip_id > 1230 "
	rs.open sql, conn, adOpenStatic, adLockReadOnly, adCmdText
	while not rs.eof 
		CALL Index_UpdateItem(index.conn, "gtb_tipologie", rs("tip_id"), true)
		rs.moveNext
	wend
	rs.close
	sql = "SELECT art_id FROM gtb_articoli "
	rs.open sql, conn, adOpenStatic, adLockReadOnly, adCmdText
	while not rs.eof 
		CALL Index_UpdateItem(index.conn, "gtb_articoli", rs("art_id"), true)
		rs.moveNext
	wend
	rs.close
end if
'*******************************************************************************************

'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 396
' cancellazione delle vecchie categorie (e ripulitura dell'indice)
'...........................................................................................
sql = " DELETE FROM gtb_tipologie WHERE (tip_id < 1231) ; " + vbCrLf + _
	  " DELETE FROM tb_contents WHERE (co_F_table_id = 6) AND (co_F_key_id < 1231) "
CALL DB.Execute(sql, 396)
'*******************************************************************************************

'**********************************************************************************************************
'**********************************************************************************************************
'**********************************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 397
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__173(conn)
CALL DB.Execute(sql, 397)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(397)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 398
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__174(conn)
CALL DB.Execute(sql, 398)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(398)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 399
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__175(conn)
CALL DB.Execute(sql, 399)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__175(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 400
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__176(conn)
CALL DB.Execute(sql, 400)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(400)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 401
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__177(conn)
CALL DB.Execute(sql, 401)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(401)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 402
'...........................................................................................
sql = Aggiornamento__B2B__147(conn)
CALL DB.Execute(sql, 402)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(402)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 403
'...........................................................................................
sql = Aggiornamento__B2B__148(conn)
CALL DB.Execute(sql, 403)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 404
' copia faq nelle gallery - IDEAL-LUX
'...........................................................................................
sql = " INSERT INTO ptb_gallery(gallery_no, gallery_name_it,gallery_name_en, gallery_name_fr, gallery_name_de, " + vbCrLf + _
	  "			gallery_idcategoria,  " + vbCrLf + _
	  "			gallery_ordine, gallery_visibile " + vbCrLf + _
	  "		) " + vbCrLf + _
	  "	SELECT tb_FAQ.faq_id, tb_FAQ.faq_domanda_IT, tb_FAQ.faq_domanda_EN, tb_FAQ.faq_domanda_FR, tb_FAQ.faq_domanda_DE, " + vbCrLf + _
	  "			CASE tb_FAQ.faq_cat_id WHEN 1 THEN 11  WHEN 2 THEN 12  WHEN 4 THEN 13  WHEN 5 THEN 14 END, " + vbCrLf + _
	  "			tb_FAQ.faq_ordine, tb_FAQ.faq_visibile " + vbCrLf + _
	  "	FROM tb_FAQ INNER JOIN " + vbCrLf + _
	  "	tb_FAQ_categorie ON tb_FAQ.faq_cat_id = tb_FAQ_categorie.cat_id "

sql = sql & _
	  "	INSERT INTO prel_descrittori_gallery(rdi_descrittore_id, rdi_gallery_id, rdi_memo_it, rdi_memo_en, rdi_memo_fr, rdi_memo_de) " + vbCrLf + _
	  "	SELECT 15 AS id_descrittore, ptb_gallery.gallery_id, tb_FAQ.faq_risposta_IT, tb_FAQ.faq_risposta_EN, tb_FAQ.faq_risposta_FR, tb_FAQ.faq_risposta_DE " + vbCrLf + _
	  "	FROM tb_FAQ INNER JOIN ptb_gallery ON tb_FAQ.faq_id = ptb_gallery.gallery_no "

CALL DB.Execute(sql, 404)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 405
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__178(conn)
CALL DB.Execute(sql, 405)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(405)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 406
'...........................................................................................
sql = Aggiornamento__B2B__149(conn)
CALL DB.Execute(sql, 406)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 407
'...........................................................................................
sql = Aggiornamento__B2B__150(conn)
CALL DB.Execute(sql, 407)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 408
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__179(conn)
CALL DB.Execute(sql, 408)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 409
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__180(conn)
CALL DB.Execute(sql, 409)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 410
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__181(conn)
CALL DB.Execute(sql, 410)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 411
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__182(conn)
CALL DB.Execute(sql, 411)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 412
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__183(conn)
CALL DB.Execute(sql, 412)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 413
'...........................................................................................
sql = Aggiornamento__MEMO2__1(conn)
CALL DB.Execute(sql, 413)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 414
'...........................................................................................
sql = Aggiornamento__MEMO2__2(conn)
CALL DB.Execute(sql, 414)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__2(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 415
'...........................................................................................
sql = Aggiornamento__MEMO2__3(conn)
CALL DB.Execute(sql, 415)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 416
'...........................................................................................
sql = Aggiornamento__MEMO2__4(conn)
CALL DB.Execute(sql, 416)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__4(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 417
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__184(conn)
CALL DB.Execute(sql, 417)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 418
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__185(conn)
CALL DB.Execute(sql, 418)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 419
'...........................................................................................
sql = Aggiornamento__B2B__151(conn)
CALL DB.Execute(sql, 419)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(419)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 420
'...........................................................................................
sql = Aggiornamento__B2B__152(conn)
CALL DB.Execute(sql, 420)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 421
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__186(conn)
CALL DB.Execute(sql, 421)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 422
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__187(conn)
CALL DB.Execute(sql, 422)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 423
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__188(conn)
CALL DB.Execute(sql, 423)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 424
'...........................................................................................
sql = Aggiornamento__MEMO2__5(conn)
CALL DB.Execute(sql, 424)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__5(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 425
'...........................................................................................
sql = Aggiornamento__B2B__153(conn)
CALL DB.Execute(sql, 425)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__153(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 426
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__189(conn)
CALL DB.Execute(sql, 426)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 427
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__190(conn)
CALL DB.Execute(sql, 427)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 428
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__191(conn)
CALL DB.Execute(sql, 428)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 429
'...........................................................................................
sql = Aggiornamento__B2B__154(conn)
CALL DB.Execute(sql, 429)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(429)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 430
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__192(conn)
CALL DB.Execute(sql, 430)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(430)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 431
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__193(conn)
CALL DB.Execute(sql, 431)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(431)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 432
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__194(conn)
CALL DB.Execute(sql, 432)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__194(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 433
'...........................................................................................
sql = Aggiornamento__B2B__155(conn)
CALL DB.Execute(sql, 433)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(433)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 434
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__195(conn)
CALL DB.Execute(sql, 434)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(434)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 435
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__196(conn)
CALL DB.Execute(sql, 435)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(435)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 436
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "ru")
CALL DB.Execute(sql, 436)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 437
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "pt")
CALL DB.Execute(sql, 437)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 438
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "cn")
CALL DB.Execute(sql, 438)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(438)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 439
'...........................................................................................
sql = Aggiornamento__B2B__157(conn)
CALL DB.Execute(sql, 439)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(439)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 440
'...........................................................................................
sql = Aggiornamento__B2B__158(conn)
CALL DB.Execute(sql, 440)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 441
'...........................................................................................
'aggiornamento fittizio per eseguire il rebuild della funzione fn_listino_vendita_articoli
'...........................................................................................
sql = "SELECT * FROM AA_versione"
CALL DB.Execute(sql, 441)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(441, "fn_listino_vendita_articoli")
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 442
'...........................................................................................
sql = Aggiornamento__MEMO2__6(conn)
CALL DB.Execute(sql, 442)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 443
'...........................................................................................
sql = Aggiornamento__MEMO2__7(conn)
CALL DB.Execute(sql, 443)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__7(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 444
'...........................................................................................
sql = Aggiornamento__MEMO2__8(conn)
CALL DB.Execute(sql, 444)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__MEMO2__8(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 445
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__197(conn)
CALL DB.Execute(sql, 445)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 446
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__198(conn)
CALL DB.Execute(sql, 446)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 447
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__199(conn)
CALL DB.Execute(sql, 447)
'*******************************************************************************************


'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 448
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__200(conn)
CALL DB.Execute(sql, 448)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 449
'...........................................................................................
sql = Aggiornamento__MEMO2__9(conn)
CALL DB.Execute(sql, 449)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 450
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__201(conn)
CALL DB.Execute(sql, 450)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 451
'...........................................................................................
sql = Aggiornamento__INFO__24(conn, "ru")
CALL DB.Execute(sql, 451)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 452
'...........................................................................................
sql = Aggiornamento__INFO__24(conn, "pt")
CALL DB.Execute(sql, 452)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 453
'...........................................................................................
sql = Aggiornamento__INFO__24(conn, "cn")
CALL DB.Execute(sql, 453)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 454
'...........................................................................................
sql = Aggiornamento__INFO__25(conn)
CALL DB.Execute(sql, 454)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 455
'...........................................................................................
sql = Aggiornamento__INFO__26(conn)
CALL DB.Execute(sql, 455)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(455)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 456
'...........................................................................................
sql = Aggiornamento__MEMO2__10(conn)
CALL DB.Execute(sql, 456)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 457
'...........................................................................................
sql = Aggiornamento__INFO__22(conn)
CALL DB.Execute(sql, 457)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__INFO__22(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 458
'...........................................................................................
sql = Aggiornamento__INFO__23(conn)
CALL DB.Execute(sql, 458)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__INFO__23(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 459
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "ru")
CALL DB.Execute(sql, 459)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 460
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "pt")
CALL DB.Execute(sql, 460)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 461
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "cn")
CALL DB.Execute(sql, 461)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 462
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__203(conn)
CALL DB.Execute(sql, 462)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__203(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 463
'...........................................................................................
sql = Aggiornamento__B2B__159(conn)
CALL DB.Execute(sql, 463)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(463)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 464
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__204(conn)
CALL DB.Execute(sql, 464)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__204(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 465
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__205(conn)
CALL DB.Execute(sql, 465)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 466
'...........................................................................................
sql = Aggiornamento__B2B__160(conn)
CALL DB.Execute(sql, 466)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(466)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 467
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__206(conn)
CALL DB.Execute(sql, 467)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 468
'...........................................................................................
sql = Aggiornamento__B2B__161(conn)
CALL DB.Execute(sql, 468)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(468)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 469
'...........................................................................................
sql = Aggiornamento__B2B__162(conn)
CALL DB.Execute(sql, 469)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(469)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 470
'...........................................................................................
sql = Aggiornamento__B2B__163(conn)
CALL DB.Execute(sql, 470)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__163(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 471
'...........................................................................................
sql = Aggiornamento__B2B__164(conn)
CALL DB.Execute(sql, 471)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(471)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 472
'...........................................................................................
sql = Aggiornamento__B2B__165(conn)
CALL DB.Execute(sql, 472)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(472)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 473
'...........................................................................................
sql = Aggiornamento__B2B__166(conn)
CALL DB.Execute(sql, 473)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(473)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 474
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__207(conn)
CALL DB.Execute(sql, 474)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(474)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 475
'...........................................................................................
sql = Aggiornamento__B2B__167(conn)
CALL DB.Execute(sql, 475)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(475)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 476
'...........................................................................................
sql = Aggiornamento__B2B__168(conn)
CALL DB.Execute(sql, 476)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(476)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 477
'...........................................................................................
sql = Aggiornamento__B2B__169(conn)
CALL DB.Execute(sql, 477)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__169(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 478
'...........................................................................................
sql = Aggiornamento__B2B__170(conn)
CALL DB.Execute(sql, 478)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(478)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 479
'...........................................................................................
sql = Aggiornamento__B2B__171(conn)
CALL DB.Execute(sql, 479)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(479)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 480
'...........................................................................................
sql = Aggiornamento__B2B__172(conn)
CALL DB.Execute(sql, 480)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 481
'...........................................................................................
sql = Aggiornamento__B2B__173(conn)
CALL DB.Execute(sql, 481)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(481)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 482
'...........................................................................................
sql = Aggiornamento__B2B__174(conn)
CALL DB.Execute(sql, 482)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 483
'...........................................................................................
sql = Aggiornamento__B2B__175(conn)
CALL DB.Execute(sql, 483)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 484
'...........................................................................................
sql = Aggiornamento__B2B__176(conn)
CALL DB.Execute(sql, 484)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 485
'...........................................................................................
sql = Aggiornamento__B2B__177(conn)
CALL DB.Execute(sql, 485)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(485)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 486
'...........................................................................................
sql = Aggiornamento__B2B__178(conn)
CALL DB.Execute(sql, 486)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(486)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 487
'...........................................................................................
sql = Aggiornamento__B2B__179(conn)
CALL DB.Execute(sql, 487)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 488
'...........................................................................................
sql = Aggiornamento__B2B__180(conn)
CALL DB.Execute(sql, 488)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__180(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(488)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 489
'...........................................................................................
sql = Aggiornamento__B2B__181(conn)
CALL DB.Execute(sql, 489)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__181(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 490
'...........................................................................................
sql = Aggiornamento__B2B__182(conn)
CALL DB.Execute(sql, 490)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(490)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 491
'...........................................................................................
sql = Aggiornamento__B2B__183(conn)
CALL DB.Execute(sql, 491)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(491)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 492
'...........................................................................................
sql = Aggiornamento__B2B__184(conn)
CALL DB.Execute(sql, 492)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__184(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 493
'...........................................................................................
sql = Aggiornamento__B2B__185(conn)
CALL DB.Execute(sql, 493)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 494
'...........................................................................................
sql = Aggiornamento__B2B__186(conn)
CALL DB.Execute(sql, 494)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(494)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 495
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__208(conn)
CALL DB.Execute(sql, 495)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 496
'...........................................................................................
sql = Aggiornamento__MEMO2__11(conn)
CALL DB.Execute(sql, 496)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 497
'...........................................................................................
sql = Aggiornamento__B2B__187(conn)
CALL DB.Execute(sql, 497)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 498
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__209(conn)
CALL DB.Execute(sql, 498)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__209(conn)
end if
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(498)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 499
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__210(conn)
CALL DB.Execute(sql, 499)
'*******************************************************************************************
'*******************************************************************************************
'AGGIORNAMENTO 500
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__211(conn)
CALL DB.Execute(sql, 500)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(500)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 501
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__212(conn)
CALL DB.Execute(sql, 501)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 502
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__213(conn)
CALL DB.Execute(sql, 502)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 503
'...........................................................................................
sql = Aggiornamento__B2B__188(conn)
CALL DB.Execute(sql, 503)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 504
'...........................................................................................
sql = Aggiornamento__B2B__189(conn)
CALL DB.Execute(sql, 504)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 505
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__214(conn)
CALL DB.ProtectedExecuteRebuild(sql, 505, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 506
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__215(conn)
CALL DB.ProtectedExecuteRebuild(sql, 506, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 507
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__216(conn)
CALL DB.ProtectedExecuteRebuild(sql, 507, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 508
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__217(conn)
CALL DB.Execute(sql, 508)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__217(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 509
'...........................................................................................
sql = Aggiornamento__B2B__190(conn)
CALL DB.Execute(sql, 509)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__190(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 510
'...........................................................................................
sql = Aggiornamento__B2B__191(conn)
CALL DB.Execute(sql, 510)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__191(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 511
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__218(conn)
CALL DB.ProtectedExecuteRebuild(sql, 511, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 512
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__219(conn)
CALL DB.ProtectedExecuteRebuild(sql, 512, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 513
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__220(conn)
CALL DB.ProtectedExecuteRebuild(sql, 513, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 514
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__221(conn)
CALL DB.ProtectedExecuteRebuild(sql, 514, false, true)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__221(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 515
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__222(conn)
CALL DB.Execute(sql, 515)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__222(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 516
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 516, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 517
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__224(conn)
CALL DB.Execute(sql, 517)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__224(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 518
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 518, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 519
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 519, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 520
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 520, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 521
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__228(conn)
CALL DB.ProtectedExecuteRebuild(sql, 521, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 522
'...........................................................................................
' Giacomo 23/01/2013
'...........................................................................................
' Aggiunta campi per gestione bonus rivenditori
'...........................................................................................
sql = " ALTER TABLE gtb_rivenditori ADD " & _
	  "	riv_anno_validita_bonus int NULL, " & _
	  "	riv_bilancio_netto_corrente money NULL, " & _
	  "	riv_fatturato_target_1 money NULL, " & _
	  "	riv_percentuale_bonus_1 real NULL, " & _
	  "	riv_fatturato_target_2 money NULL, " & _
	  "	riv_percentuale_bonus_2 real NULL, " & _
	  "	riv_fatturato_target_3 money NULL, " & _
	  "	riv_percentuale_bonus_3 real NULL; "
CALL DB.ProtectedExecuteRebuild(sql, 522, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 523
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__229(conn)
CALL DB.ProtectedExecuteRebuild(sql, 523, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 524
'...........................................................................................
sql = Aggiornamento__B2B__192(conn)
CALL DB.Execute(sql, 524)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 525
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__230(conn)
CALL DB.Execute(sql, 525)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__230(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 526
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__231(conn)
CALL DB.ProtectedExecuteRebuild(sql, 526, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 527
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__232(conn)
CALL DB.ProtectedExecuteRebuild(sql, 527, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 528
'...........................................................................................
sql = Aggiornamento__MEMO2__12(conn)
CALL DB.Execute(sql, 528)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 529
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__233(conn)
CALL DB.ProtectedExecuteRebuild(sql, 529, false, false)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 530
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__234(conn)
CALL DB.ProtectedExecuteRebuild(sql, 530, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 531
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__235(conn)
CALL DB.ProtectedExecuteRebuild(sql, 531, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 532
'...........................................................................................
sql = Install__NEXTGUESTBOOK(conn)
CALL DB.Execute(sql, 532)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 533
'...........................................................................................
sql = Aggiornamento__GUESTBOOK__2(conn)
CALL DB.Execute(sql, 533)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 534
'...........................................................................................
sql = Aggiornamento__GUESTBOOK__3(conn)
CALL DB.Execute(sql, 534)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__GUESTBOOK__3(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 535
'...........................................................................................
'	Giacomo, 02/01/2014
'...........................................................................................
'   tabelle per import ordini, fatture di vendita, note credito di vendita e inevasi
'...........................................................................................
sql = " CREATE TABLE " + SQL_Dbo(conn) + "imtb_sales_order(" + _
	  "  so_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  "	 so_num_documento_esterno " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  so_rivenditore_id int NULL, " + _
	  "  so_ordine_web bit NULL, " + _
	  "  so_quantita float NULL, " + _
	  "  so_stato int NULL, " + _
	  "  so_data_modifica datetime NULL, " + _
	  "  so_ora_modifica datetime NULL, " + _
	  "  so_data_creazione_documento_stampato datetime NULL, " + _
	  "  so_ora_creazione_documento_stampato datetime NULL, " + _
	  "  so_nome_documento_stampato " + SQL_CharField(Conn, 255) + " NULL," + _
	  "  so_pdf_path " + SQL_CharField(Conn, 500) + " NULL," + _
	  "  so_pdf_data_modifica smalldatetime NULL, " + _
	  "  so_ordine_data smalldatetime NULL " + _
	  " ) " + _
	  " CREATE TABLE " + SQL_Dbo(conn) + "imtb_sales_invoices(" + _
	  "  si_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  si_rivenditore_id int NULL, " + _
	  "  si_data_registrazione datetime NULL, " + _
	  "  si_quantita float NULL, " + _
	  "  si_data_creazione_documento_stampato datetime NULL, " + _
	  "  si_ora_creazione_documento_stampato datetime NULL, " + _
	  "  si_nome_documento_stampato " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  si_pdf_path " + SQL_CharField(Conn, 500) + " NULL," + _
	  "  si_pdf_data_modifica smalldatetime NULL " + _
	  " ) " + _
	  " CREATE TABLE " + SQL_Dbo(conn) + "imtb_sales_cr_memo(" + _
	  "  sc_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  sc_rivenditore_id int NULL, " + _
	  "  sc_data_registrazione datetime NULL, " + _
	  "  sc_quantita float NULL, " + _
	  "  sc_data_creazione_documento_stampato datetime NULL, " + _
	  "  sc_ora_creazione_documento_stampato datetime NULL, " + _
	  "  sc_nome_documento_stampato " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  sc_pdf_path " + SQL_CharField(Conn, 500) + " NULL," + _
	  "  sc_pdf_data_modifica smalldatetime NULL " + _
	  " ) " + _
	  " CREATE TABLE " + SQL_Dbo(conn) + "imtb_outstanding_management(" + _
	  "  om_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  om_riga_documento int NULL, " + _
	  "  om_codice_articolo " + SQL_CharField(Conn, 50) + " NULL, " + _
	  "  om_rivenditore_id int NULL, " + _
	  "  om_descrizione " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  om_descrizione_2 " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  om_quantita float NULL, " + _
	  "  om_num_ordine_inevaso " + SQL_CharField(Conn, 50) + " NULL, " + _
	  "  om_num_riga_ordine_inevaso int NULL, " + _
	  "  om_data_ordine_inevaso_originale datetime NULL " + _
	  " ) "
CALL DB.Execute(sql, 535)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 536
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__236(conn)
CALL DB.ProtectedExecuteRebuild(sql, 536, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 537
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__237(conn)
CALL DB.ProtectedExecuteRebuild(sql, 537, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 538
'...........................................................................................
sql = Aggiornamento__MEMO2__13(conn)
CALL DB.Execute(sql, 538)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 539
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__238(conn)
CALL DB.ProtectedExecuteRebuild(sql, 539, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 540
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__239(conn)
CALL DB.ProtectedExecuteRebuild(sql, 540, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 541
'...........................................................................................
sql = Aggiornamento__B2B__193(conn)
CALL DB.Execute(sql, 541)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__193(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 542
'...........................................................................................
sql = Aggiornamento__B2B__194(conn)
CALL DB.Execute(sql, 542)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 543
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__240(conn)
CALL DB.ProtectedExecuteRebuild(sql, 543, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 544
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__241(conn)
CALL DB.ProtectedExecuteRebuild(sql, 544, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 545
'...........................................................................................
'	Giacomo, 14/07/2014
'...........................................................................................
'   tabelle per inevasi di acquisto
'...........................................................................................
sql = " CREATE TABLE " + SQL_Dbo(conn) + "imtb_purchase_outstanding_management (" + _
	  "  pom_num " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  pom_num_riga int NULL, " + _
	  "  pom_codice_articolo " + SQL_CharField(Conn, 50) + " NULL, " + _
	  "  pom_fornitore_id int NULL, " + _
	  "  pom_descrizione " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  pom_descrizione_2 " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  pom_quantita float NULL, " + _
	  "  pom_quantita_inevasa float NULL, " + _
	  "  pom_codice_valuta " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  pom_costo_unitario_diretto money NULL, " + _
	  "  pom_perc_sconto_riga float NULL, " + _
	  "  pom_totale_riga money NULL " + _
	  " ); "
	  '" CREATE TABLE " + SQL_Dbo(conn) + "imtb_purchase_line_web (" + _
	  '"	 plw_timestamp smalldatetime NULL, " + _
	  '"  plw_tipo_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_num_riga int NULL, " + _
	  '"  plw_fornitore_id int NULL, " + _
	  '"  plw_num " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_produttore_id int NULL, " + _
	  '"  plw_quantita_confermata_fornitore int NULL, " + _
	  '"  plw_codice_valuta " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_prezzo_listino_acquisto money NULL, " + _
	  '"  plw_prezzo_listino_acquisto_valuta " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_costo_unitario money NULL, " + _
	  '"  plw_perc_sconto_riga float NULL, " + _
	  '"  plw_data_prevista_ricezione smalldatetime NULL, " + _
	  '"  plw_num_fattura_fornitore " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_num_documento_trans_fornitore " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_costi_aggiuntivi_totale_1 money NULL, " + _
	  '"  plw_costi_aggiuntivi_totale_2 money NULL, " + _
	  '"  plw_costi_aggiuntivi_totale_3 money NULL, " + _
	  '"  plw_costi_aggiuntivi_totale_4 money NULL, " + _
	  '"  plw_contenitore " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_quantita_in_arrivo int NULL, " + _
	  '"  plw_quantita_ricevuta int NULL, " + _
	  '"  plw_costo_unitario_diretto money NULL, " + _
	  '"  plw_nuova_riga bit NULL, " + _
	  '"  plw_costi_aggiuntivi money NULL, " + _
	  '"  plw_stato_riga " + SQL_CharField(Conn, 50) + " NULL," + _
	  '"  plw_peso_netto float NULL, " + _
	  '"  plw_peso_lordo float NULL, " + _
	  '"  plw_quantita_ordine int NULL " + _
	  '" ); "
CALL DB.Execute(sql, 545)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 546
'...........................................................................................
sql = Aggiornamento__MEMO2__14(conn)
CALL DB.Execute(sql, 546)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 547
'...........................................................................................
sql = Aggiornamento__B2B__195(conn)
CALL DB.Execute(sql, 547)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 548
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__242(conn)
CALL DB.ProtectedExecuteRebuild(sql, 548, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 549
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__243(conn)
CALL DB.ProtectedExecuteRebuild(sql, 549, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 550
'...........................................................................................
sql = Aggiornamento__B2B__196(conn)
CALL DB.ProtectedExecuteRebuild(sql, 550, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 551
'...........................................................................................
sql = Aggiornamento__B2B__197(conn)
CALL DB.Execute(sql, 551)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__197(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 552
'...........................................................................................
sql = Aggiornamento__B2B__198(conn)
CALL DB.ProtectedExecuteRebuild(sql, 552, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 553
'...........................................................................................
sql = Aggiornamento__B2B__199(conn)
CALL DB.ProtectedExecuteRebuild(sql, 553, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 554
'...........................................................................................
sql = Aggiornamento__B2B__200(conn)
CALL DB.ProtectedExecuteRebuild(sql, 554, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 555
'...........................................................................................
sql = Aggiornamento__B2B__201(conn)
CALL DB.Execute(sql, 555)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__201(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 556
'...........................................................................................
sql = Aggiornamento__B2B__202(conn)
CALL DB.Execute(sql, 556)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 557
'...........................................................................................
sql = Aggiornamento__B2B__203(conn)
CALL DB.Execute(sql, 557)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__203(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 558
'...........................................................................................
sql = Aggiornamento__B2B__204(conn)
CALL DB.Execute(sql, 558)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__204(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 559
'...........................................................................................
sql = Aggiornamento__B2B__205(conn)
CALL DB.Execute(sql, 559)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 560
'...........................................................................................
sql = Aggiornamento__B2B__206(conn)
CALL DB.Execute(sql, 560)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 561
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__244(conn)
CALL DB.ProtectedExecuteRebuild(sql, 561, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 562
'...........................................................................................
sql = Aggiornamento__B2B__207(conn)
CALL DB.Execute(sql, 562)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__207(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 563
'...........................................................................................
sql = Aggiornamento__B2B__208(conn)
CALL DB.Execute(sql, 563)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 564
'...........................................................................................
sql = Aggiornamento__B2B__209(conn)
CALL DB.Execute(sql, 564)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 565
'...........................................................................................
sql = Aggiornamento__B2B__210(conn)
CALL DB.Execute(sql, 565)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 566
'...........................................................................................
'	Luca 13/05/2015 
'...........................................................................................
' 	allinea i codici articolo
'...........................................................................................
sql = ReadFileContent(Server.MapPath("subscripts/Allineamento_Codici_Articolo.sql"))
CALL DB.Execute(sql, 566)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 567
'...........................................................................................
sql = Aggiornamento__B2B__211(conn)
CALL DB.Execute(sql, 567)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 568
'...........................................................................................
sql = Aggiornamento__B2B__212(conn)
CALL DB.ProtectedExecuteRebuild(sql, 568, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 569
'...........................................................................................
sql = Aggiornamento__Paypal__1(conn)
CALL DB.Execute(sql, 569)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__Paypal__1(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 570
'...........................................................................................
sql = Aggiornamento__B2B__213(conn)
CALL DB.Execute(sql, 570)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__213(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 571
'...........................................................................................
sql = Aggiornamento__B2B__214(conn)
CALL DB.Execute(sql, 571)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 572
'...........................................................................................
sql = Aggiornamento__B2B__215(conn)
CALL DB.Execute(sql, 572)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 573
'...........................................................................................
sql = Aggiornamento__B2B__216(conn)
CALL DB.Execute(sql, 573)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__216(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 574
'...........................................................................................
sql = Aggiornamento__B2B__217(conn)
CALL DB.ProtectedExecuteRebuild(sql, 574, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 575
'...........................................................................................
sql = Aggiornamento__B2B__218(conn)
CALL DB.Execute(sql, 575)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__218(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 576
'...........................................................................................
sql = Aggiornamento__B2B__219(conn)
CALL DB.Execute(sql, 576)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 577
'...........................................................................................
sql = Aggiornamento__VirtualPay__1(conn)
CALL DB.Execute(sql, 577)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__VirtualPay__1(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 578
'...........................................................................................
sql = Aggiornamento__B2B__220(conn)
CALL DB.Execute(sql, 578)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__220(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 579
'...........................................................................................
sql = Aggiornamento__B2B__221(conn)
CALL DB.Execute(sql, 579)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 580
'...........................................................................................
sql = Aggiornamento__B2B__222(conn)
CALL DB.ProtectedExecuteRebuild(sql, 580, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 581
'...........................................................................................
' Luca 07/12/2015
'...........................................................................................
' Aggiunto campo per accettazione bonus
'...........................................................................................
sql = " ALTER TABLE gtb_rivenditori ADD " & _
	  "	riv_anno_accettazione_bonus int NULL; "
CALL DB.ProtectedExecuteRebuild(sql, 581, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 582
'...........................................................................................
sql = Aggiornamento__B2B__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 582, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 583
'...........................................................................................
sql = Aggiornamento__B2B__224(conn)
CALL DB.ProtectedExecuteRebuild(sql, 583, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 584
'...........................................................................................
' Luca 10/01/2016
'...........................................................................................
' Aggiunta tabella per l'import dei ddt
'...........................................................................................
sql = " CREATE TABLE " + SQL_Dbo(conn) + "imtb_sales_ddt(" + _
	  "  sd_num_documento " + SQL_CharField(Conn, 50) + " NULL," + _
	  "  sd_rivenditore_id int NULL, " + _
	  "  sd_data_registrazione datetime NULL, " + _
	  "  sd_quantita float NULL, " + _
	  "  sd_data_creazione_documento_stampato datetime NULL, " + _
	  "  sd_ora_creazione_documento_stampato datetime NULL, " + _
	  "  sd_nome_documento_stampato " + SQL_CharField(Conn, 255) + " NULL, " + _
	  "  sd_pdf_path " + SQL_CharField(Conn, 500) + " NULL," + _
	  "  sd_pdf_data_modifica smalldatetime NULL " + _
	  " ); "
CALL DB.ProtectedExecuteRebuild(sql, 584, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 585
'...........................................................................................
' Luca 10/01/2016
'...........................................................................................
' Aggiunte chiavi primarie alle tabelle utilizzate per gli import
'...........................................................................................
sql = " ALTER TABLE dbo.imtb_sales_cr_memo " + _
	  "	 ADD sc_id int IDENTITY(1,1) NOT NULL; " + _
	  " ALTER TABLE dbo.imtb_sales_cr_memo " + _
	  "  ADD CONSTRAINT PK_imtb_sales_cr_memo PRIMARY KEY (sc_id); " + _
	  " ALTER TABLE dbo.imtb_sales_ddt " + _
	  "	 ADD sd_id int IDENTITY(1,1) NOT NULL; " + _
	  " ALTER TABLE dbo.imtb_sales_ddt " + _
	  "  ADD CONSTRAINT PK_imtb_sales_ddt PRIMARY KEY (sd_id); " + _
	  " ALTER TABLE dbo.imtb_sales_invoices " + _
	  "	 ADD si_id int IDENTITY(1,1) NOT NULL; " + _
	  " ALTER TABLE dbo.imtb_sales_invoices " + _
	  "  ADD CONSTRAINT PK_imtb_sales_invoices PRIMARY KEY (si_id); " + _
	  " ALTER TABLE dbo.imtb_sales_order " + _
	  "	 ADD so_id int IDENTITY(1,1) NOT NULL; " + _
	  " ALTER TABLE dbo.imtb_sales_order " + _
	  "  ADD CONSTRAINT PK_imtb_sales_order PRIMARY KEY (so_id); "
CALL DB.ProtectedExecuteRebuild(sql, 585, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 586
'...........................................................................................
sql = Aggiornamento__B2B__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 586, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 587
'...........................................................................................
sql = Aggiornamento__B2B__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 587, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 588
'...........................................................................................
sql = Aggiornamento__B2B__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 588, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 589
'...........................................................................................
' Nicola 25/07/2016
'...........................................................................................
' Modifica tabella di gestione inevasi: aggiunge colonne per gestione kit
'...........................................................................................
sql = " ALTER TABLE " + SQL_Dbo(conn) + "imtb_outstanding_management ADD " + _
	  "  om_riga_documento_kit int NULL, " + _
	  "  om_codice_articolo_kit " + SQL_CharField(Conn, 50) + " NULL "
CALL DB.ProtectedExecuteRebuild(sql, 589, false, true)
'*******************************************************************************************

%>
<% '........................................................................................... %>
<!--#INCLUDE FILE="Update__FileFooter.asp" -->
<% '........................................................................................... %>