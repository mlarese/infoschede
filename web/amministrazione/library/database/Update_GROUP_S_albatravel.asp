<!--#INCLUDE FILE="Update__FileHeader.asp" -->
<% '........................................................................................... %>
<!--#INCLUDE FILE="../Tools.asp" -->
<!--#INCLUDE FILE="../Tools4Admin.asp" -->
<!--#INCLUDE FILE="../ToolsDescrittori.asp" -->
<!--#INCLUDE FILE="../Categorie/ClassCategorie.asp" -->
<!--#INCLUDE FILE="../IndexContent/Tools_IndexContent.asp" -->
<!--#INCLUDE FILE="../../nextTour/Tools_Tour.asp" -->
<!--#INCLUDE FILE="../ClassPhotoGallery.asp" -->
<%
'...........................................................................................
set index.conn = conn
'...........................................................................................

'unificato database  ( Nicola - 13/02/2014)

'*******************************************************************************************
'AGGIORNAMENTO PER ALLINEARE VENEZIANAMOTOSCAFI ( Nicola - 13/02/2014)
'...........................................................................................
if lCase(GetDatabaseName(conn)) = "venezianamotoscafi" then
	sql = "UPDATE AA_versione SET versione=293"
	CALL DB.Execute(sql, 290)
end if


'*******************************************************************************************
'AGGIORNAMENTO 1
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__127(conn)
CALL DB.Execute(sql, 1)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 2
'...........................................................................................
sql = Install__TRAVEL2(conn)
CALL DB.Execute(sql, 2)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 3
'...........................................................................................
sql = Aggiornamento__TRAVEL2__1(conn)
CALL DB.Execute(sql, 3)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 4
'...........................................................................................
sql = Aggiornamento__TRAVEL2__2(conn)
CALL DB.Execute(sql, 4)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 5 (installo il b2b)
'...........................................................................................
sql = Install_B2B__version_79()
CALL DB.Execute(sql, 5)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 6-31 (aggiorna il b2b alla versione 105 in un colpo solo)
'...........................................................................................
dim i
for i = 80 to 96
	sql = Eval("Aggiornamento__B2B__"&i&"(conn)")
	CALL DB.Execute(sql, -74+i)
	CALL DB.ReSyncTransaction()
next

'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 23
'...........................................................................................
CALL AggiornamentoSpeciale__B2B__97(DB, rs, 23)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 6-31 (aggiorna il b2b alla versione 105 in un colpo solo)
'...........................................................................................
'dim i
for i = 98 to 105
	sql = Eval("Aggiornamento__B2B__"&i&"(conn)")
	CALL DB.Execute(sql, -74+i)
	CALL DB.ReSyncTransaction()
next

'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(31)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 111-135 (aggiorna il b2b-tour alla versione 25 in un colpo solo)
'...........................................................................................
'dim i
for i = 1 to 25
	sql = Eval("Aggiornamento_TOUR__"&i&"(conn)")
	CALL DB.Execute(sql, 31+i)
	CALL DB.ReSyncTransaction()
next

'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(56)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 57
'...........................................................................................
sql = Aggiornamento__B2B__106(conn)
CALL DB.Execute(sql, 57)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 58
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__128(conn)
CALL DB.Execute(sql, 58)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 59
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__129(conn)
CALL DB.Execute(sql, 59)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 60
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__130(conn)
CALL DB.Execute(sql, 60)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(60)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 61
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__131(conn)
CALL DB.Execute(sql, 61)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 62
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__132(conn)
CALL DB.Execute(sql, 62)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 63
'...........................................................................................
sql = Aggiornamento__B2B__107(conn)
CALL DB.Execute(sql, 63)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 64
'...........................................................................................
sql = Aggiornamento__B2B__108(conn)
CALL DB.Execute(sql, 64)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(64)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 65
'...........................................................................................
sql = Aggiornamento__B2B__109(conn)
CALL DB.Execute(sql, 65)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 66
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__133(conn)
CALL DB.Execute(sql, 66)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(66)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 67
'...........................................................................................
'aggiunge parametri standard al nexttour
'...........................................................................................
sql = " DELETE FROM tb_siti_parametri WHERE par_sito_id=" & NEXTTOUR 
CALL DB.Execute(sql, 67)
if DB.last_update_executed then
	CALL AddParametroSito(conn, "ATTIVA_GUIDE", _
								null, _
								"Attiva gesione guide e relativa disponibilità", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								0, null, null, null, null)
	CALL AddParametroSito(conn, "ATTIVA_LISTINI", _
								null, _
								"Attiva gesione listini", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								1, null, null, null, null)
	CALL AddParametroSito(conn, "CODICE_CATEGORIE_B2B_BASE_PACCHETTI", _
								null, _
								"Categoria di partenza gestione dei pacchetti", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								"TOUR", null, null, null, null)
	CALL AddParametroSito(conn, "VARIANTE_DATA", _
								null, _
								"Id della variante che rappresenta la data", _
								"", _
								adNumeric, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								1, null, null, null, null)
	CALL AddParametroSito(conn, "VARIANTE_ORARIO", _
								null, _
								"Id della variante che rappresenta l'orario", _
								"", _
								adNumeric, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								2, null, null, null, null)
	
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 68
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__134(conn)
CALL DB.Execute(sql, 68)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 69
'...........................................................................................
sql = Aggiornamento__B2B__110(conn)
CALL DB.Execute(sql, 69)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 70
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__135(conn)
CALL DB.Execute(sql, 70)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 71
'...........................................................................................
sql = Aggiornamento__B2B__111(conn)
CALL DB.Execute(sql, 71)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 72
'...........................................................................................
sql = Aggiornamento__B2B__112(conn)
CALL DB.Execute(sql, 72)
if DB.last_update_executed then
	CALL AddParametroSito(conn, "ATTIVA_FAQ_ARTICOLI", _
								null, _
								"Attiva collegamento tra articoli e FAQ", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								NEXTB2B, _
								0, null, null, null, null)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 73
'...........................................................................................
sql = "SELECT * FROM AA_versione"
CALL DB.Execute(sql, 73)
if DB.last_update_executed then
	CALL AddParametroSito(conn, "ATTIVA_PREZZO_GIORNALIERO", _
								null, _
								"Attiva gestione prezzo giornaliero tour", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								NEXTTOUR, _
								0, null, null, null, null)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 74
'...........................................................................................
sql = Aggiornamento__B2B__113(conn)
CALL DB.Execute(sql, 74)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 75
'...........................................................................................
sql = Aggiornamento__B2B__114(conn)
CALL DB.Execute(sql, 75)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(75)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 76
'...........................................................................................
sql = Aggiornamento__B2B__115(conn)
CALL DB.Execute(sql, 76)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(76)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 77
'...........................................................................................
sql = Aggiornamento__B2B__116(conn)
CALL DB.Execute(sql, 77)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 78
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__136(conn)
CALL DB.Execute(sql, 78)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 79
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__137(conn)
CALL DB.Execute(sql, 79)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(79)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 80
'...........................................................................................
sql = Aggiornamento__B2B__117(conn)
CALL DB.Execute(sql, 80)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 81
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__138(conn)
CALL DB.Execute(sql, 81)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 82
'...........................................................................................
sql = Aggiornamento_TOUR__27(conn)
CALL DB.Execute(sql, 82)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(82)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 83
'...........................................................................................
sql = Aggiornamento__B2B__118(conn)
CALL DB.Execute(sql, 83)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 84
'...........................................................................................
sql = Aggiornamento__B2B__119(conn)
CALL DB.Execute(sql, 84)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(84)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 85
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__139(conn)
CALL DB.Execute(sql, 85)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 86
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__140(conn)
CALL DB.Execute(sql, 86)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 87
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__141(conn)
CALL DB.Execute(sql, 87)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(87)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 88
'...........................................................................................
sql = Aggiornamento__TRAVEL2__3(conn)
CALL DB.Execute(sql, 88)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 89
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__142(conn)
CALL DB.Execute(sql, 89)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(89)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 90
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__143(conn)
CALL DB.Execute(sql, 90)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(90)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 91
'...........................................................................................
sql = Aggiornamento__B2B__120(conn)
CALL DB.Execute(sql, 91)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(91)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 92
'...........................................................................................
sql = Aggiornamento__B2B__121(conn)
CALL DB.Execute(sql, 92)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 93
'...........................................................................................
sql = Aggiornamento__B2B__122(conn)
CALL DB.Execute(sql, 93)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(93)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 94
'...........................................................................................
sql = Aggiornamento__B2B__123(conn)
CALL DB.Execute(sql, 94)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 95
'...........................................................................................
sql = Aggiornamento_TOUR__28(conn)
CALL DB.Execute(sql, 95)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(95)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 96
'...........................................................................................
sql = Aggiornamento_TOUR__29(conn)
CALL DB.Execute(sql, 96)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 97
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__145(conn)
CALL DB.Execute(sql, 97)
'*******************************************************************************************




'*******************************************************************************************
'AGGIORNAMENTO 98
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "ru")
CALL DB.Execute(sql, 98)
if DB.last_update_executed then
	 CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "ru", "russo", "Русский")
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 99
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "cn")
CALL DB.Execute(sql, 99)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "cn", "Cinese", "中文")
end if
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(99,"v_indice")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(99,"v_indice_visibile")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(99)
'*******************************************************************************************



'*******************************************************************************************
'AGGIORNAMENTO 100
'...........................................................................................
'inserisce tutti i campi per l'aggiunta di una nuova lingua
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__146(conn, "pt")
CALL DB.Execute(sql, 100)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__146(conn, "pt", "Portoghese", "Português")
end if
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(100,"v_indice")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(100,"v_indice_visibile")
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(100)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 101
'...........................................................................................
sql = Aggiornamento_TOUR__30(conn)
CALL DB.Execute(sql, 101)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(101)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 102
'...........................................................................................
sql = Aggiornamento_TOUR__31(conn)
CALL DB.Execute(sql, 102)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_TOUR__31(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(102)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 103
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__148(conn)
CALL DB.Execute(sql, 103)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 104
'...........................................................................................
sql = Aggiornamento_TOUR__32(conn)
CALL DB.Execute(sql, 104)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_TOUR__32(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 105
'...........................................................................................
sql = Aggiornamento_TOUR__33(conn)
CALL DB.Execute(sql, 105)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_TOUR__33(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 106
'...........................................................................................
sql = Aggiornamento_TOUR__34(conn)
CALL DB.Execute(sql, 106)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(106)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 107
'...........................................................................................
sql = Aggiornamento_TOUR__35(conn)
CALL DB.Execute(sql, 107)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(107)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 108
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__149(conn)
CALL DB.Execute(sql, 108)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(108)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 109
'...........................................................................................
sql = Aggiornamento_TOUR__36(conn)
CALL DB.Execute(sql, 109)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_TOUR__36(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 110
'...........................................................................................
sql = "UPDATE rel_siti_descrittori SET rsd_valore_it = 3 WHERE rsd_descrittore_id IN (SELECT sid_id FROM tb_siti_descrittori WHERE sid_codice LIKE 'CATEGORIA_TRANSFER') "
CALL DB.Execute(sql, 110)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(110)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 111
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__144(conn) + _
      Aggiornamento__FRAMEWORK_CORE__150(conn)
CALL DB.Execute(sql, 111)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(111)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 112
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__151(conn)
CALL DB.Execute(sql, 112)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 113
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__152(conn)
CALL DB.Execute(sql, 113)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 114
'...........................................................................................
sql = Aggiornamento__B2B__124(conn)
CALL DB.Execute(sql, 114)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(114)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 115
'...........................................................................................
sql = Aggiornamento__B2B__125(conn) + ";" + _
	  " UPDATE gtb_dettagli_ord_des SET dod_qta_in_detrazione=0, dod_percentuale_detrazione=0 ; " + _
	  " UPDATE gtb_dettagli_ord_des SET dod_qta_in_detrazione=1, dod_percentuale_detrazione=100 WHERE dod_id=3; " + _
	  " UPDATE gtb_dettagli_ord_des SET dod_qta_in_detrazione=1, dod_percentuale_detrazione=50 WHERE dod_id=2; "
CALL DB.Execute(sql, 115)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(115)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 116
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__153(conn)
CALL DB.Execute(sql, 116)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(116)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 117
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__154(conn)
CALL DB.Execute(sql, 117)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 118
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__155(conn)
CALL DB.Execute(sql, 118)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 119
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__156(conn)
CALL DB.Execute(sql, 119)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(119)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 120
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__157(conn)
CALL DB.Execute(sql, 120)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(120)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 121
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__158(conn)
CALL DB.Execute(sql, 121)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 122
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__159(conn)
CALL DB.Execute(sql, 122)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(122)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 123
'...........................................................................................
sql = Aggiornamento_TOUR__37(conn)
CALL DB.Execute(sql, 123)
if DB.last_update_executed then
	CALL Aggiornamento_TOUR__37(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(123)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 124
'...........................................................................................
sql = Aggiornamento_TOUR__38(conn)
CALL DB.Execute(sql, 124)
if DB.last_update_executed then
	CALL Aggiornamento_TOUR__38(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(124)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 125
'...........................................................................................
sql = Aggiornamento_TOUR__39(conn)
CALL DB.Execute(sql, 125)
if DB.last_update_executed then
	CALL Aggiornamento_TOUR__39(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(125)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 126
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__160(conn)
CALL DB.Execute(sql, 126)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(126)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 127
'...........................................................................................
sql = Aggiornamento__B2B__126(conn)
CALL DB.Execute(sql, 127)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(127)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 128
'...........................................................................................
sql = Aggiornamento__B2B__127(conn)
CALL DB.Execute(sql, 128)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(128)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 129
'...........................................................................................
sql = Aggiornamento__B2B__128(conn)
CALL DB.Execute(sql, 129)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(129)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 130
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__161(conn)
CALL DB.Execute(sql, 130)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 131
'...........................................................................................
sql = Aggiornamento__B2B__129(conn)
CALL DB.Execute(sql, 131)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 132
'...........................................................................................
sql = Aggiornamento__B2B__130(conn)
CALL DB.Execute(sql, 132)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 133
'...........................................................................................
sql = Aggiornamento__B2B__131(conn)
CALL DB.Execute(sql, 133)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 134
'...........................................................................................
sql = Aggiornamento__B2B__132(conn)
CALL DB.Execute(sql, 134)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 135
'...........................................................................................
sql = Aggiornamento__B2B__133(conn)
CALL DB.Execute(sql, 135)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(135)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 136
'...........................................................................................
sql = Aggiornamento_TOUR__40(conn)
CALL DB.Execute(sql, 136)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 137
'...........................................................................................
sql = Aggiornamento_TOUR__41(conn)
CALL DB.Execute(sql, 137)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(137)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 138
'...........................................................................................
sql = Aggiornamento__B2B__134(conn)
CALL DB.Execute(sql, 138)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(138)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 139
'...........................................................................................
sql = Aggiornamento__B2B__135(conn)
CALL DB.Execute(sql, 139)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 140
'...........................................................................................
sql = Aggiornamento__B2B__136(conn)
CALL DB.Execute(sql, 140)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(140)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 141
'...........................................................................................
sql = Aggiornamento_TOUR__42(conn)
CALL DB.Execute(sql, 141)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(141)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 142
'...........................................................................................
sql = Aggiornamento__B2B__137(conn)
CALL DB.Execute(sql, 142)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 143
'...........................................................................................
sql = Aggiornamento__B2B__138(conn)
CALL DB.Execute(sql, 143)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 144
'...........................................................................................
sql = Aggiornamento__B2B__139(conn)
CALL DB.Execute(sql, 144)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(144)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 145
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__162(conn)
CALL DB.Execute(sql, 145)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__162(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 146
'...........................................................................................
sql = Aggiornamento__B2B__140(conn)
CALL DB.Execute(sql, 146)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(146)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 147
'...........................................................................................
sql = Aggiornamento__B2B__141(conn)
CALL DB.Execute(sql, 147)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 148
'...........................................................................................
sql = Aggiornamento_TOUR__43(conn)
CALL DB.Execute(sql, 148)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 149
'...........................................................................................
sql = Aggiornamento_TOUR__44(conn)
CALL DB.Execute(sql, 149)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(149)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 150
'...........................................................................................
sql = Aggiornamento_B2B__142(conn)
CALL DB.Execute(sql, 150)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_B2B__142(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 151
'...........................................................................................
sql = Aggiornamento__B2B__143(conn)
CALL DB.Execute(sql, 151)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 152
'...........................................................................................
sql = Aggiornamento__B2B__144(conn)
CALL DB.Execute(sql, 152)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 153
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__163(conn)
CALL DB.Execute(sql, 153)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 154
' Sergio 29/09/2010 - aggiunge colonne mancanti a 
' tb_contents_index 
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__164(conn)
CALL DB.Execute(sql, 154)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(154,"v_indice")
CALL DB.SqlServer_VIEWS_REBUILD_EX(154,"v_indice_visibile")
CALL DB.SqlServer_VIEWS_REBUILD(154)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 155
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__165(conn)
CALL DB.Execute(sql, 155)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 156
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__166(conn)
CALL DB.Execute(sql, 156)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 157
'...........................................................................................
sql = Aggiornamento_TOUR__45(conn)
CALL DB.Execute(sql, 157)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(157)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 158
'...........................................................................................
sql = Aggiornamento_TOUR__46(conn)
CALL DB.Execute(sql, 158)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 159
'...........................................................................................
sql = Aggiornamento_TOUR__47(conn)
CALL DB.Execute(sql, 159)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale_TOUR__47(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 160
'...........................................................................................
sql = Aggiornamento__B2B__145(conn)
CALL DB.Execute(sql, 160)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 161
'...........................................................................................
sql = Aggiornamento_TOUR__48(conn)
CALL DB.Execute(sql, 161)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 162
'...........................................................................................
sql = Aggiornamento_TOUR__49(conn)
CALL DB.Execute(sql, 162)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 163
'...........................................................................................
sql = Aggiornamento_TOUR__50(conn)
CALL DB.Execute(sql, 163)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 164
'...........................................................................................
sql = Aggiornamento_TOUR__51(conn)
CALL DB.Execute(sql, 164)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 165
'..........................................................................................
sql = Aggiornamento_TOUR__52(conn)
CALL DB.Execute(sql, 165)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 166
'..........................................................................................
sql = Aggiornamento_TOUR__53(conn)
CALL DB.Execute(sql, 166)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 167
'..........................................................................................
sql = Aggiornamento_TOUR__54(conn)
CALL DB.Execute(sql, 167)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 167
'...........................................................................................
'sql = Aggiornamento__B2B__145(conn)
'CALL DB.Execute(sql, 167)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(167,"v_indice")
CALL DB.SqlServer_VIEWS_REBUILD_EX(167,"v_indice_visibile")
CALL DB.SqlServer_VIEWS_REBUILD(167)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 168
'...........................................................................................
sql = Aggiornamento_TOUR__55(conn)
CALL DB.Execute(sql, 168)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(168)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 169
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__167(conn)
CALL DB.Execute(sql, 169)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 170
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__168(conn)
CALL DB.Execute(sql, 170)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 171
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__169(conn)
CALL DB.Execute(sql, 171)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(171)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 172
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__170(conn)
CALL DB.Execute(sql, 172)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(172)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 173
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__171(conn)
CALL DB.Execute(sql, 173)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(173)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 174
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__172(conn)
CALL DB.Execute(sql, 174)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(174)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 175
'...........................................................................................
sql = Aggiornamento__B2B__146(conn)
CALL DB.Execute(sql, 175)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 176
'...........................................................................................
sql = Aggiornamento_TOUR__56(conn)
CALL DB.Execute(sql, 176)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(176)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 177
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__173(conn)
CALL DB.Execute(sql, 177)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(177)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 178
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__174(conn)
CALL DB.Execute(sql, 178)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(178)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 179
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__175(conn)
CALL DB.Execute(sql, 179)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__175(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 180
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__176(conn)
CALL DB.Execute(sql, 180)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(180)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 181
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__177(conn)
CALL DB.Execute(sql, 181)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(181)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 182
'...........................................................................................
sql = Aggiornamento__B2B__147(conn)
CALL DB.Execute(sql, 182)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(182)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 183
'...........................................................................................
sql = Aggiornamento__B2B__148(conn)
CALL DB.Execute(sql, 183)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 184
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__178(conn)
CALL DB.Execute(sql, 184)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(184)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 185
'...........................................................................................
sql = Aggiornamento_TOUR__57(conn)
CALL DB.Execute(sql, 185)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(185)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 186
'...........................................................................................
sql = Aggiornamento__B2B__149(conn)
CALL DB.Execute(sql, 186)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 187
'...........................................................................................
sql = Aggiornamento__B2B__150(conn)
CALL DB.Execute(sql, 187)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 188
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__179(conn)
CALL DB.Execute(sql, 188)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 189
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__180(conn)
CALL DB.Execute(sql, 189)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 190
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__181(conn)
CALL DB.Execute(sql, 190)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 191
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__182(conn)
CALL DB.Execute(sql, 191)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 192
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__183(conn)
CALL DB.Execute(sql, 192)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 193
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__184(conn)
CALL DB.Execute(sql, 193)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 194
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__185(conn)
CALL DB.Execute(sql, 194)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 195
'...........................................................................................
sql = Aggiornamento__B2B__151(conn)
CALL DB.Execute(sql, 195)
'*******************************************************************************************


'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(195)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 196
'...........................................................................................
sql = Aggiornamento_TOUR__58(conn)
CALL DB.Execute(sql, 196)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 197
'...........................................................................................
sql = Aggiornamento__B2B__152(conn)
CALL DB.Execute(sql, 197)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 198
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__186(conn)
CALL DB.Execute(sql, 198)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 199
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__187(conn)
CALL DB.Execute(sql, 199)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 200
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__188(conn)
CALL DB.Execute(sql, 200)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 201
'...........................................................................................
sql = Aggiornamento__B2B__153(conn)
CALL DB.Execute(sql, 201)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__153(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 202
'Matteo, 21/04/2011
'aggiunge applicativo per pagamento attraverso banca keyclient e relativi parametri di configurazione
'...........................................................................................
sql = " INSERT INTO tb_rubriche (nome_rubrica, locked_rubrica, rubrica_esterna) " + _
	  " VALUES ('Utenti - KeyClient', 1, 1) " + _
	  " INSERT INTO tb_siti (id_sito, sito_nome, sito_p1, sito_amministrazione, sito_rubrica_area_riservata) " + _
	  "	SELECT TOP 1 " & BANCA_KEYCLIENT & ", 'Key Client', 'User', 0, id_rubrica FROM tb_rubriche WHERE nome_rubrica = 'Utenti - KeyClient'; " + _
	  " UPDATE tb_webs SET webs_modData_parametri = GETDATE() "
CALL DB.Execute(sql, 202)
if DB.last_update_executed then
	CALL AddParametroSito(conn, "KEYCLIENT_URL", _
								null, _
								"KeyClient: url di configurazione pagamento", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"https://ecommerce.cim-italia.it/ecomm/DispatcherServlet", null, null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_ALIAS", _
								null, _
								"KeyClient: alias", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"payment_testm_urlmac", null, null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_DIVISA", _
								null, _
								"KeyClient: codice valuta", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"EUR", null, null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_MAC_KEY", _
								null, _
								"KeyClient: stringa aggiuntiva di codifica per la generazione del codice MAC.", _
								"", _
								adLongVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"esempiodicalcolomac", null, null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_BUTTON_IMAGE", _
								null, _
								"KeyClient: immagine utilizzata come pulsante di invio al pagamento.", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"", null, null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_BUTTON_TEXT", _
								null, _
								"KeyClient: testo utilizzato come pulsante di invio al pagamento.", _
								"", _
								adVarChar, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"Esegui il pagamento", "Pay your reservation", null, null, null)
	CALL AddParametroSito(conn, "KEYCLIENT_TEST", _
								null, _
								"KeyClient: attiva impostazioni di test: importo e codice mac.", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								"1", null, null, null, null)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 203
'...........................................................................................
'Matteo, 21/04/2011
'...........................................................................................
' rimuove vecchie configurazioni per gestione voucher e prenotazioni da area amministrativa
' ed aggiunge nuove configurazioni su vincoli dei pacchetti
' categorie di suddivisione dei vincoli:
'	2: tour
'	3: transfer
'...........................................................................................
sql = " DELETE FROM tb_siti_descrittori " + _
		" WHERE sid_codice LIKE 'PDF_VOUCHER_FATTURA_PAGE' " + _
			"OR sid_codice LIKE 'VOUCHER_PAGE' ; " + _
	  " UPDATE trel_vincoli_profili_tipologie SET rpt_pagina_comandi_prenotazione = 314 FROM trel_vincoli_profili_tipologie WHERE rpt_tip_id = 2; " + _
	  " UPDATE trel_vincoli_profili_tipologie SET rpt_pagina_comandi_prenotazione = 328 FROM trel_vincoli_profili_tipologie WHERE rpt_tip_id = 3; "
CALL DB.Execute(sql, 203)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 204
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__189(conn)
CALL DB.Execute(sql, 204)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 205
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__190(conn)
CALL DB.Execute(sql, 205)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 206
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__191(conn)
CALL DB.Execute(sql, 206)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 207
'...........................................................................................
sql = Aggiornamento__B2B__154(conn)
CALL DB.Execute(sql, 207)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(207)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 208
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__192(conn)
CALL DB.Execute(sql, 208)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(208)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 209
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__193(conn)
CALL DB.Execute(sql, 209)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(209)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 210
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__194(conn)
CALL DB.Execute(sql, 210)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__194(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 211
'...........................................................................................
sql = Aggiornamento__B2B__155(conn)
CALL DB.Execute(sql, 211)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(211)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 212
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__195(conn)
CALL DB.Execute(sql, 212)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(212)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 213
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__196(conn)
CALL DB.Execute(sql, 213)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(213)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 214
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "ru")
CALL DB.Execute(sql, 214)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 215
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "pt")
CALL DB.Execute(sql, 215)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 216
'...........................................................................................
sql = Aggiornamento__B2B__156(conn, "cn")
CALL DB.Execute(sql, 216)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(216)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 217
'...........................................................................................
sql = Aggiornamento__B2B__157(conn)
CALL DB.Execute(sql, 217)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(217)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 218
'...........................................................................................
sql = Aggiornamento_TOUR__59(conn, "ru")
CALL DB.Execute(sql, 218)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 219
'...........................................................................................
sql = Aggiornamento_TOUR__59(conn, "pt")
CALL DB.Execute(sql, 219)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 220
'...........................................................................................
sql = Aggiornamento_TOUR__59(conn, "cn")
CALL DB.Execute(sql, 220)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(220)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 221
'...........................................................................................
sql = Aggiornamento_TOUR__60(conn)
CALL DB.Execute(sql, 221)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(221)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 222
'...........................................................................................
sql = Aggiornamento__B2B__158(conn)
CALL DB.Execute(sql, 222)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 223
'...........................................................................................
'aggiornamento fittizio per eseguire il rebuild della funzione fn_listino_vendita_articoli
'...........................................................................................
sql = "SELECT * FROM AA_versione"
CALL DB.Execute(sql, 223)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD_EX(223, "fn_listino_vendita_articoli")
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 224
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__197(conn)
CALL DB.Execute(sql, 224)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 225
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__198(conn)
CALL DB.Execute(sql, 225)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 226
'...........................................................................................
sql = Aggiornamento__TRAVEL2__4(conn)
CALL DB.Execute(sql, 226)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 227
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__199(conn)
CALL DB.Execute(sql, 227)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 228
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__200(conn)
CALL DB.Execute(sql, 228)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 229
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__201(conn)
CALL DB.Execute(sql, 229)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 230
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "ru")
CALL DB.Execute(sql, 230)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 231
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "pt")
CALL DB.Execute(sql, 231)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 232
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__202(conn, "cn")
CALL DB.Execute(sql, 232)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 233
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__203(conn)
CALL DB.Execute(sql, 233)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__203(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'chiusura transazione per liberare risorse bloccate
'...........................................................................................
CALL DB.ReSyncTransaction()
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 234
'...........................................................................................
sql = Aggiornamento__B2B__159(conn)
CALL DB.Execute(sql, 234)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD_EX(234, "fn_listino_vendita_varianti")
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(234)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 235
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__204(conn)
CALL DB.Execute(sql, 235)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__204(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 236
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__205(conn)
CALL DB.Execute(sql, 236)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 237
'...........................................................................................
sql = Aggiornamento__B2B__160(conn)
CALL DB.Execute(sql, 237)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(237)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 238
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__206(conn)
CALL DB.Execute(sql, 238)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 239
'...........................................................................................
sql = Aggiornamento__B2B__161(conn)
CALL DB.Execute(sql, 239)
'*******************************************************************************************


'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(239)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 240
'...........................................................................................
sql = Aggiornamento__B2B__162(conn)
CALL DB.Execute(sql, 240)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(240)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 241
'...........................................................................................
sql = Aggiornamento__B2B__163(conn)
CALL DB.Execute(sql, 241)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__163(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 242
'...........................................................................................
sql = Aggiornamento__B2B__164(conn)
CALL DB.Execute(sql, 242)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(242)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 243
'...........................................................................................
sql = Aggiornamento__B2B__165(conn)
CALL DB.Execute(sql, 243)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(243)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 244
'...........................................................................................
sql = Aggiornamento__B2B__166(conn)
CALL DB.Execute(sql, 244)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(244)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 245
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__207(conn)
CALL DB.Execute(sql, 245)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(245)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 246
'...........................................................................................
sql = Aggiornamento__B2B__167(conn)
CALL DB.Execute(sql, 246)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(246)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 247
'...........................................................................................
sql = Aggiornamento__B2B__168(conn)
CALL DB.Execute(sql, 247)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(247)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 248
'...........................................................................................
sql = Aggiornamento__B2B__169(conn)
CALL DB.Execute(sql, 248)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__169(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 249
'...........................................................................................
sql = Aggiornamento__B2B__170(conn)
CALL DB.Execute(sql, 249)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(249)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 250
'...........................................................................................
sql = Aggiornamento__B2B__171(conn)
CALL DB.Execute(sql, 250)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(250)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 251
'...........................................................................................
sql = Aggiornamento__B2B__172(conn)
CALL DB.Execute(sql, 251)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 252
'...........................................................................................
sql = Aggiornamento__B2B__173(conn)
CALL DB.Execute(sql, 252)
'*******************************************************************************************

'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(252)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 253
'...........................................................................................
sql = Aggiornamento__B2B__174(conn)
CALL DB.Execute(sql, 253)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 254
'...........................................................................................
sql = Aggiornamento__B2B__175(conn)
CALL DB.Execute(sql, 254)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 255
'...........................................................................................
sql = Aggiornamento__B2B__176(conn)
CALL DB.Execute(sql, 255)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 256
'...........................................................................................
sql = Aggiornamento__B2B__177(conn)
CALL DB.Execute(sql, 256)
'*******************************************************************************************
'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(256)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 257
'...........................................................................................
sql = Aggiornamento__B2B__178(conn)
CALL DB.Execute(sql, 257)
'*******************************************************************************************
'*******************************************************************************************
'CALL DB.SqlServer_VIEWS_REBUILD(257)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 258
'...........................................................................................
sql = Aggiornamento__B2B__179(conn)
CALL DB.Execute(sql, 258)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 259
'...........................................................................................
sql = Aggiornamento__B2B__180(conn)
CALL DB.Execute(sql, 259)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__180(conn)
end if
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(259)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 260
'...........................................................................................
sql = Aggiornamento__B2B__181(conn)
CALL DB.Execute(sql, 260)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__181(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 261
'...........................................................................................
sql = Aggiornamento__B2B__182(conn)
CALL DB.Execute(sql, 261)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(261)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 262
'...........................................................................................
sql = Aggiornamento__B2B__183(conn)
CALL DB.Execute(sql, 262)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(262)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 263
'...........................................................................................
sql = Aggiornamento__B2B__184(conn)
CALL DB.Execute(sql, 263)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__184(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 264
'...........................................................................................
sql = Aggiornamento__B2B__185(conn)
CALL DB.Execute(sql, 264)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 265
'...........................................................................................
sql = Aggiornamento__B2B__186(conn)
CALL DB.Execute(sql, 265)
'*******************************************************************************************

'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(265)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 266
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__208(conn)
CALL DB.Execute(sql, 266)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 267
'...........................................................................................
sql = Aggiornamento__B2B__187(conn)
CALL DB.Execute(sql, 267)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 268
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__209(conn)
CALL DB.Execute(sql, 268)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__209(conn)
end if
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(268)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 269
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__210(conn)
CALL DB.Execute(sql, 269)
'*******************************************************************************************
'*******************************************************************************************
'AGGIORNAMENTO 270
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__211(conn)
CALL DB.Execute(sql, 270)
'*******************************************************************************************
'*******************************************************************************************
CALL DB.SqlServer_VIEWS_REBUILD(270)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 271
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__212(conn)
CALL DB.Execute(sql, 271)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 272
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__213(conn)
CALL DB.Execute(sql, 272)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 273
'...........................................................................................
sql = Aggiornamento__B2B__188(conn)
CALL DB.Execute(sql, 273)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 274
'...........................................................................................
sql = Aggiornamento__B2B__189(conn)
CALL DB.Execute(sql, 274)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 275
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__214(conn)
CALL DB.ProtectedExecuteRebuild(sql, 275, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 276
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__215(conn)
CALL DB.ProtectedExecuteRebuild(sql, 276, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 277
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__216(conn)
CALL DB.ProtectedExecuteRebuild(sql, 277, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 278
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__217(conn)
CALL DB.Execute(sql, 278)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__217(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 279
'...........................................................................................
sql = Aggiornamento__B2B__190(conn)
CALL DB.Execute(sql, 279)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__190(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 280
'...........................................................................................
sql = Aggiornamento__B2B__191(conn)
CALL DB.Execute(sql, 280)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__191(conn)
end if
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 281
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__218(conn)
CALL DB.ProtectedExecuteRebuild(sql, 281, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 282
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__219(conn)
CALL DB.ProtectedExecuteRebuild(sql, 282, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 283
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__220(conn)
CALL DB.ProtectedExecuteRebuild(sql, 283, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 284
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__221(conn)
CALL DB.ProtectedExecuteRebuild(sql, 284, false, true)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__221(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 285
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__222(conn)
CALL DB.Execute(sql, 285)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__222(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 286
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 286, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 287
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__224(conn)
CALL DB.Execute(sql, 287)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__224(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 288
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 288, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 289
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 289, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 290
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 290, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 291
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__228(conn)
CALL DB.ProtectedExecuteRebuild(sql, 291, false, true)
'*******************************************************************************************


'*******************************************************************************************
'AGGIORNAMENTO 292
'Nicola, 30/01/2013
'aggiunge parametri per gestione pagamento keyclient
'...........................................................................................
sql = " SELECT * FROM AA_versione "
CALL DB.Execute(sql, 292)
if DB.last_update_executed then
	CALL AddParametroSito(conn, "KEYCLIENT_USESHA1", _
								null, _
								"KeyClient: attiva calcolo mac con codifica SHA1", _
								"", _
								adBoolean, _
								0, _
								"", _
								1, _
								1, _
								BANCA_KEYCLIENT, _
								null, null, null, null, null)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 293
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__229(conn)
CALL DB.ProtectedExecuteRebuild(sql, 293, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 294
'...........................................................................................
sql = Aggiornamento__B2B__192(conn)
CALL DB.Execute(sql, 294)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 295
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__230(conn)
CALL DB.Execute(sql, 295)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__FRAMEWORK_CORE__230(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 296
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__231(conn)
CALL DB.ProtectedExecuteRebuild(sql, 296, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 297
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__232(conn)
CALL DB.ProtectedExecuteRebuild(sql, 297, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 298
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__233(conn)
CALL DB.ProtectedExecuteRebuild(sql, 298, false, false)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 299
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__234(conn)
CALL DB.ProtectedExecuteRebuild(sql, 299, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 300
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__235(conn)
CALL DB.ProtectedExecuteRebuild(sql, 300, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 301
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__236(conn)
CALL DB.ProtectedExecuteRebuild(sql, 301, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 302
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__237(conn)
CALL DB.ProtectedExecuteRebuild(sql, 302, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 303
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__238(conn)
CALL DB.ProtectedExecuteRebuild(sql, 303, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 304
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__239(conn)
CALL DB.ProtectedExecuteRebuild(sql, 304, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 305
'...........................................................................................
sql = Aggiornamento__B2B__193(conn)
CALL DB.Execute(sql, 305)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__193(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 307
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__240(conn)
CALL DB.ProtectedExecuteRebuild(sql, 307, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 308
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__241(conn)
CALL DB.ProtectedExecuteRebuild(sql, 308, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 309
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__242(conn)
CALL DB.ProtectedExecuteRebuild(sql, 309, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 310
'...........................................................................................
sql = Aggiornamento__B2B__195(conn)
CALL DB.Execute(sql, 310)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 311
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__243(conn)
CALL DB.ProtectedExecuteRebuild(sql, 311, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 312
'...........................................................................................
sql = Aggiornamento__B2B__196(conn)
CALL DB.ProtectedExecuteRebuild(sql, 312, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 313
'...........................................................................................
sql = Aggiornamento__B2B__197(conn)
CALL DB.Execute(sql, 313)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__197(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 314
'...........................................................................................
sql = Aggiornamento_TOUR__61(conn)
CALL DB.Execute(sql, 314)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 315
'...........................................................................................
sql = Aggiornamento__B2B__198(conn)
CALL DB.ProtectedExecuteRebuild(sql, 315, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 316
'...........................................................................................
sql = Aggiornamento__B2B__199(conn)
CALL DB.ProtectedExecuteRebuild(sql, 316, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 317
'...........................................................................................
sql = Aggiornamento__B2B__200(conn)
CALL DB.ProtectedExecuteRebuild(sql, 317, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 318
'...........................................................................................
sql = Aggiornamento__B2B__201(conn)
CALL DB.Execute(sql, 318)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__201(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 319
'...........................................................................................
sql = Aggiornamento__B2B__202(conn)
CALL DB.Execute(sql, 319)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 320
'...........................................................................................
sql = Aggiornamento__B2B__203(conn)
CALL DB.Execute(sql, 320)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__203(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 321
'...........................................................................................
sql = Aggiornamento__B2B__204(conn)
CALL DB.Execute(sql, 321)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__204(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 322
'...........................................................................................
sql = Aggiornamento__B2B__205(conn)
CALL DB.Execute(sql, 322)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 323
'...........................................................................................
sql = Aggiornamento__B2B__206(conn)
CALL DB.Execute(sql, 323)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 324
'...........................................................................................
sql = Aggiornamento__FRAMEWORK_CORE__244(conn)
CALL DB.ProtectedExecuteRebuild(sql, 324, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 325
'...........................................................................................
sql = Aggiornamento__B2B__207(conn)
CALL DB.Execute(sql, 325)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__207(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 326
'...........................................................................................
sql = Aggiornamento__B2B__208(conn)
CALL DB.Execute(sql, 326)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 327
'...........................................................................................
sql = Aggiornamento__B2B__209(conn)
CALL DB.Execute(sql, 327)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 328
'...........................................................................................
sql = Aggiornamento__B2B__210(conn)
CALL DB.Execute(sql, 328)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 329
'...........................................................................................
sql = Aggiornamento__B2B__211(conn)
CALL DB.Execute(sql, 329)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 330
'...........................................................................................
sql = Aggiornamento__B2B__212(conn)
CALL DB.ProtectedExecuteRebuild(sql, 330, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 331
'...........................................................................................
sql = Aggiornamento__B2B__213(conn)
CALL DB.Execute(sql, 331)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__213(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 332
'...........................................................................................
sql = Aggiornamento__B2B__214(conn)
CALL DB.Execute(sql, 332)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 333
'...........................................................................................
sql = Aggiornamento__B2B__215(conn)
CALL DB.Execute(sql, 333)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 334
'...........................................................................................
sql = Aggiornamento__B2B__216(conn)
CALL DB.Execute(sql, 334)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__216(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 335
'...........................................................................................
sql = Aggiornamento__B2B__217(conn)
CALL DB.ProtectedExecuteRebuild(sql, 335, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 336
'...........................................................................................
sql = Aggiornamento__B2B__218(conn)
CALL DB.Execute(sql, 336)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__218(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 337
'...........................................................................................
sql = Aggiornamento__B2B__219(conn)
CALL DB.Execute(sql, 337)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 338
'...........................................................................................
sql = Aggiornamento__B2B__220(conn)
CALL DB.Execute(sql, 338)
if DB.last_update_executed then
	CALL AggiornamentoSpeciale__B2B__220(conn)
end if
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 339
'...........................................................................................
sql = Aggiornamento__B2B__221(conn)
CALL DB.Execute(sql, 339)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 340
'...........................................................................................
sql = Aggiornamento__B2B__222(conn)
CALL DB.ProtectedExecuteRebuild(sql, 340, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 341
'...........................................................................................
sql = Aggiornamento__B2B__223(conn)
CALL DB.ProtectedExecuteRebuild(sql, 341, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 342
'...........................................................................................
sql = Aggiornamento__B2B__224(conn)
CALL DB.ProtectedExecuteRebuild(sql, 342, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 343
'...........................................................................................
sql = Aggiornamento__B2B__225(conn)
CALL DB.ProtectedExecuteRebuild(sql, 343, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 344
'...........................................................................................
sql = Aggiornamento__B2B__226(conn)
CALL DB.ProtectedExecuteRebuild(sql, 344, false, true)
'*******************************************************************************************

'*******************************************************************************************
'AGGIORNAMENTO 345
'...........................................................................................
sql = Aggiornamento__B2B__227(conn)
CALL DB.ProtectedExecuteRebuild(sql, 345, false, true)
'*******************************************************************************************

%>
<% '........................................................................................... %>
<!--#INCLUDE FILE="Update__FileFooter.asp" -->
<% '........................................................................................... %>